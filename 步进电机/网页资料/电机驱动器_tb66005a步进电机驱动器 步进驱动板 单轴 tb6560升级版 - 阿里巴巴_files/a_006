define(["jQuery"],function(r){function e(r){return!r||r.length<1}function i(){return!0}function t(r){if(e(r))return void 0;var i=r.find(".model-3d-iframe-wapper");return i.find(".model-3d-iframe-close-icon").click(function(){i.hide()}),i}function n(){if(!i())return!1;var n=r(".mod-detail-model-3d .model-3d");if(e(n))return!1;var d=n.attr("data-origin-data");try{d=JSON.parse(d)}catch(a){}var f=d["3DSize"];if(d.is3DOffer!==!0||!d["3DImageUrl"]||!d["3DViewUrl"]||!f)return!1;if(f>15360)return!1;n.find(".model-3d-thumb-wapper .model-3d-thumb").attr("src",d["3DImageUrl"]);var o=t(n);return e(o)?!1:(n.find(".model-3d-detail-button").click(function(){var e=o.find("iframe").attr("src");e!==d["3DViewUrl"]&&o.find("iframe").attr("src",d["3DViewUrl"]);var i=r(window).height(),t=i-100>700?700:i-100;t=300>t?300:t,o.find(".model-3d-iframe-content").css("height",t),o.show()}),void n.css("display","block"))}r().ready(n)});;define("widget.common.plugin.Alitalk",["jQuery","lofty/alicn/alitalk/1.0/alitalk"],function(i,t){function n(i){this.init(i)}return n.prototype={init:function(t){this.div=t;{var n=i("a.de-alitalk-btn",this.div);i("input[name=inquirybywwtracelogurl]",this.div),i("input[name=inquirybywwtracelogfromid]",this.div),i("input[name=inquirybywwtracelogparam]",this.div)}n.length&&(n.click(function(i){i.preventDefault()}),this._initAliWW(n))},_initAliWW:function(n){t.init({trigger:n,onRemote:function(t){var n=i(this);switch(t.online){case 0:case 2:case 6:n.addClass(t.cls.off);break;case 1:n.addClass(t.cls.on);break;case 4:case 5:n.addClass(t.cls.mb);break;default:n.addClass(t.cls.off)}}})},_aliwwTraceLogClick:function(i,t,n){"notmember"!==t&&document.images&&((new Image).src=i+"&time="+(new Date).getTime())}},n});;define(["jQuery","ModContext","Util","widget.common.plugin.Logist","widget.common.plugin.Alitalk","global.util.everlog"],function(i,t,e,a,o,n){var c={detailWidth:750,descLock:!1,init:function(t,e,a,o){if(this.div=t,this.div.length){this.config=e,this.detailConfig="undefined"!=typeof window.iDetailConfig?window.iDetailConfig:0,this.authLogin=i("a.auth-login",this.div),this.authApply=i("a.auth-apply",this.div);var n=i("#desc-lazyload-container",this.div),c=100,l=this;i(window).bind("loadDesc scroll.desc resize.desc",function(t,e){var a=i(document).scrollTop()+i(window).height()+c;l.descLock||(n.length&&n.data("enable")===!0?(e||i(n).offset().top<a)&&(n.data("tfsUrl")?l._initLazyLoadDescriptionTFS(n):l._initLazyLoadDescription(n),l.descLock=!0):(l._initDescription(),l.descLock=!0))}),i(window).trigger("loadDesc"),this._initPrivate(),this._initEasyOffer(),this._initSubCatalog(),this.detailWidth=this.div.width()>751?this.div.width():750}},_initPrivate:function(){var i,t;this.authLogin.click(function(t){t.preventDefault(),i=new a({source:"offerDetail_private3"})}),t=new o(this.div)},_initDescription:function(){for(var t=i("img",this.div),e=i("img",this.div),a=e.length,o=0,n=t.length;n>o;o++){t.eq(o).css("visibility","visible");try{t[o].style.maxWidth||t.eq(o).css("max-width",this.detailWidth)}catch(c){}}setTimeout(function(){t.length>=18&&(a=18),aliclick(this,"?tracelog=offer_detail_desc_img_count_"+a)},5e3),t.bind("contextmenu",function(i){i.preventDefault()})},_initSubCatalog:function(){var t,e=this.config.catalog,a="";if(e&&e.length>1){for(var o=0;o<e.length;o++)a+='<span class="catalog-pure-item"><a href="#offer-template-'+e[o].id+'">'+e[o].title+"</a><i>\u25cf</i></span>";i("#mod-detail-otabs").append('<div class="catalog-pure"><div class="catalog-pure-inner fd-clr">'+a+"</div></div>"),t=i("#mod-detail-otabs .catalog-pure"),t.on("click","a",function(e){var a=i(this).attr("href"),o=i(a).offset().top;e.preventDefault(),i("span",t).removeClass("current"),i(this).parent().addClass("current"),o&&i(document).scrollTop(o-50-35);try{n.info("Catalogclick")}catch(e){i.log("Everlog error")}})}else i("#de-description-detail").addClass("nocatalog")},_initCatalog:function(){var t=this.config.catalog,e=i("div.de-desc-catalog ul"),a="";if(t&&t.length>1){for(var o=0;o<t.length;o++)a+='<li><a href="#offer-template-'+t[o].id+'">'+t[o].title+"</a></li>";e.append(a),this.handlePosition(e)}else i("#de-description-detail").addClass("nocatalog");e.on("click","a",function(t){var a=i(this).attr("href"),o=i(a).offset().top;t.preventDefault(),i("li",e).removeClass("curr"),i(this).parent().addClass("curr"),o&&i(document).scrollTop(o-50);try{n.info("Catalogclick")}catch(t){i.log("Everlog error")}})},handlePosition:function(t){var e,a=(document.documentElement.clientWidth,i("#mod-detail-description"));i(window).on("scroll.catalog resize.catalog",function(){var o=i(document).scrollTop();e=a.offset().top,t.css(o>=e?{top:o-e}:{top:0})})},_initLazyLoadDescription:function(t){var e=this,a=t.data("url"),o=this.detailConfig.offerid,n=this.detailConfig.memberid,c={offerId:o,memberId:n};i.ajax({url:a+"?"+i.paramSpecial(c),dataType:"jsonp",success:function(i){i.success===!0?e._descriptionSuccessCallback(i.offerDesc,t):t.html("\u8be6\u60c5\u52a0\u8f7d\u5931\u8d25")},error:function(){t.html("\u8be6\u60c5\u52a0\u8f7d\u5931\u8d25")}})},_initLazyLoadDescriptionTFS:function(t){var e=this,a=t.data("tfsUrl");"string"==typeof a&&a.indexOf("/tfscom/")>=0&&a.indexOf("?t=")<0&&(a=a+"?t="+(new Date).getTime()),i.ajax({url:a,dataType:"script",timeout:3e3,success:function(i){a.indexOf("/tfscom/")>=0?window.offer_details&&window.offer_details.content?e._descriptionSuccessCallback(window.offer_details.content,t):e._initLazyLoadDescription(t):window.desc?e._descriptionSuccessCallback(window.desc,t):e._initLazyLoadDescription(t)},error:function(){e._initLazyLoadDescription(t)}})},_descriptionSuccessCallback:function(t,e){var a,o,n=this,c="",l="",s=/(<img[^>]*)(src *= *("[^"]*"|'[^']*'|[^ >]*))/g,d=/(height*=*("[^"]*"|'[^']*'|[^ >]*))/g,r=/(width*=*("[^"]*"|'[^']*'|[^ >]*))/g,f=/(<object[^>]*data=("[^"]*"|'[^']*'|[^ >]*).*<\/object>)/g,h=/img\.china\.alibaba\.com|i0[0-9]\.cd\.aliimg|i0[0-9]\.c\.aliimg\.com|bimg\.c\.aliimg\.com|img\.c\.aliimg\.com/,u=/img0[0-9]\.taobaocdn\.com|img\.im\.alisoft\.com/,g="",m=0,p="//cbu01.alicdn.com/cms/upload/2011/821/721/127128_1301427272.png",v=/(http[s]?:)(\/\/\S+\.(png|jpg|bmp|gif))/g;g=t||"",g=g.replace(f,function(i){return-1!==i.indexOf("service.aodong.mobi")?"":i}).replace(v,function(i,t,e,a){return e}),g.match(),a=g.match(s)?g.match(s).length:0,g=g.replace(s,function(i,t,e,a){return m++,l=-1!==i.indexOf("width")?i.match(r):"",c=-1!==i.indexOf("height")?i.match(d):"",a=a.replace(h,function(i){return"cbu01.alicdn.com"}).replace(u,function(i){return"img.alicdn.com"}),[t,'src="'+p+'" data-lazyload-src=',a," ",l," ",c].join("")}),e.html(g);for(var o=i("img",e),w=0,_=o.length;_>w;w++){o.eq(w).css("visibility","visible");try{o[w].style.maxWidth||o.eq(w).css("max-width",this.detailWidth)}catch(b){}}setTimeout(function(){aliclick(this,"?tracelog=offer_detail_desc_lazy_img_count_"+a)},5e3),o.bind("contextmenu",function(i){i.preventDefault()}),o.attr("max-width",n.detailWidth),o.bind("load",function(){i(this).css("visibility","visible")}),i.use("web-datalazyload",function(){FE.util.datalazyload.register({threshold:0,webp:!1,containers:e})})},_initEasyOffer:function(){var t,a=this,o=i("#mod-detail-easyoffer-dsc");if(o.length>0){t=o.find("img"),t.load(function(){i(this).width()>a.detailWidth&&e.resizeImage(i(this).context,a.detailWidth)});for(var n=0;n<t.length;n++)t.eq(n).width()>a.detailWidth&&e.resizeImage(t[n],a.detailWidth)}}};return t.add("mod-detail-description","area-detail-feature",c),c});;define("widget.common.plugin.Paging",["jQuery"],function(a){var e=function(e,t){this.pagination=a("li.pagination",e),this.pagem=a("em.pagenum",e),this.pagenum=a("input.pnum",e),this.pagesubmit=a("a.btn-b",e),this.configs=t||{}};return e.prototype={init:function(e,t,s){function i(){a(this).val()?n.test(a(this).val())?r=a(this).val():a(this).val(r):r=""}var n=/^[1-9]\d*$/,r="",p=this,s=s||5;this.pagenum.bind("focus",function(){this.select()}),this.pagenum.bind("keydown",function(a){a.keyCode&&13==a.keyCode&&(p.pagesubmit.click(),this.select())}),this.pagenum.bind("keyup",i),this.pagenum.bind("blur",i),this.pagesubmit.bind("click",function(a){if(a.preventDefault(),p.pagenum.val()){var e=1*(p.pagenum.val()||0),t=1*p.pagenum.max;e>t&&(e=t),p.render.call(p,e,t,s),1>=t||p.customClick(e)}}),this.render(e,t,s)},render:function(e,t,s){1>e&&(e=1),1>t&&(t=1),e>t&&(e=t);var i,n,r=[],p=this;if(this.pagem.html(t),this.pagenum.max=t,1==e?(r.push('<a target="_self" class="pre-disabled" href="javascript:;"> </a>'),r.push('<a target="_self" class="current" href="javascript:;">1</a>')):(r.push('<a target="_self" class="pre" href="javascript:;" page="'+(e-1)+'"> </a>'),r.push('<a target="_self" href="javascript:;" page="1">1</a>')),t>1){e>=4&&t>=6&&r.push('<a target="_self" class="omit" href="javascript:;">...</a>'),3>e?(i=0,n=1==e?s:s-1,e+n>t&&(n=t-e)):3==e?(i=1,n=s-2,e+n>t&&(n=t-e)):(i=0,n=s-2,e+n>t&&(n=t-e),i=2-n,e+1>=t&&i++,0>e-i&&(i=e-0));for(var h=i;h>0;h--)e-h!==1&&r.push('<a target="_self" href="#" page="'+(e-h)+'">'+(e-h)+"</a>");e>1&&r.push('<a target="_self" class="current" href="javascript:;">'+e+"</a>");for(var h=1;n+1>h;h++)r.push('<a target="_self" href="#" page="'+(e+h)+'">'+(e+h)+"</a>");t-1>e+n&&(r.push('<a target="_self" class="omit" href="javascript:;">...</a>'),r.push('<a target="_self" href="#" page="'+t+'">'+t+"</a>")),e+n==t-1&&r.push('<a target="_self" href="#" page="'+t+'">'+t+"</a>")}r.push(e==t?'<a target="_self" class="next-disabled" href="javascript:;">\u4e0b\u4e00\u9875</a>':'<a target="_self" class="next" href="#" page="'+(e+1)+'">\u4e0b\u4e00\u9875</a>'),this.pagination.html(r.join("")),this.configs.onRender&&this.configs.onRender.call(this),this.pagenum.val()&&1*this.pagenum.val()>t&&this.pagenum.val(e),a("a[page]",this.pagination).bind("click",function(e){e.preventDefault();var i=1*a(this).attr("page");p.render(i,t,s),p.customClick(i)})},customClick:function(a){}},e});;define(["jQuery","ModContext","widget.common.plugin.Paging","Util"],function(t,i,a,s){var n={currentPage:1,noCommentFlag:!1,init:function(i,a,n,e,r){if(this.div=i,this.faceConfig=r,this.div.length){this.config=this.div.data("modConfig"),this.memberLevel=window.iDetailConfig.isTP,this.selectStar=t("#select-star",this.div),this.topLoading=t("#loading1",this.div),this.totalPanel=t("div.comment-total",this.div),this.contentWrapper=t("#correct-wrapper",this.div),this.contentTable=t("table",this.div),this.headContent=t("thead",this.contentWrapper),this.topStar=t("#topStar",this.div),this.topScore=t("#topScore",this.div),this.dynamicBlock=t("#dynamicBlock",this.div),this.paging=t("div.de-comment-paging",this.div),this.pageCount=t("em.pagecount",this.paging),this.commentSatisfaction=t("div.comment-satisfaction",this.div),this.commentLock=!1;var l=this,d=0;this.app={getBizType:function(t){return"yp"===t||"yf"===t?'<span class="tag" title="\u62ff\u6837\u4ef7">[\u6837]</span>':""},isMix:function(t){return t?'<span class="tag" title="\u6df7\u6279">[\u6df7\u6279]</span>':""},isSkuOffer:function(){return l.faceConfig.isSKUOffer},isTgcSKUOffer:function(){return"true"===l.config.isTgcSKUOffer},isYP:function(t){return"yp"===t||"yf"===t},getUnit:function(){return l.faceConfig.unit},getTradeUnit:function(t){return t?t:l.faceConfig.unit},getHalfYearTotal:function(){return l.config.halfYearTotal},getTotal:function(){return s.tenThousandSep(l.config.total,!1)},getTotalRate:function(){return l.config.totalRate},getNumberFixed:function(t,i){return s.tenThousandSep(t,i)}},this._renderHeadItems(this.app),t(window).bind("loadDealrecord scroll.dealrecord resize.dealrecord",function(i,a){if(!l.commentLock){var s=t(document).scrollTop()+t(window).height()+d;(a||l.div.length>0&&t(l.div).offset().top<s)&&(l.topLoading.show(),l._refreshPage(null,l.currentPage,!0),l.commentLock=!0)}}),t(window).trigger("loadDealrecord")}},_loadList:function(i,a,s){var n=this._getParams(i,a,s);"undefined"!=typeof this.config.remarkListUrl&&this.config.remarkListUrl&&t.ajax({url:this.config.remarkListUrl,data:n,dataType:"jsonp",success:t.proxy(this._successLoadedList,this),error:t.proxy(this._failureLoadedList,this),timeout:1e4})},_failureLoadedList:function(){this._renderRequestFailed()},_successLoadedList:function(t){this.topLoading.hide(),"undefined"!=typeof t&&t.success===!0&&this.handleListData(t.data)},handleListData:function(i){var s=(this.dynamicBlock,this),n=t("div.tip",this.selectContent.closest("th"));i.defaultShowWithContent&&!this.pageInitFlag&&(this.selectContent.val("2"),n.show()),this.pageInitFlag?(this.pageCount.html(i.totalCount),this.modPaging.render(1*i.currentPage,1*i.totalPage,3)):(i.currentPage&&i.totalPage&&0!==i.totalPage&&1*this.config.total?(this.modPaging=new a(this.paging),this.modPaging.init(1*i.currentPage,1*i.totalPage,3),this.modPaging.customClick=function(i){s.currentPage=i,s._refreshPage(null,i),t("body").scrollTop(t("#pj-listop").offset().top-40)},this.pageCount.html(i.totalCount),this.paging.show()):this.paging.hide(),i.offerSaleRecordStat&&i.identTityStat&&(this._renderSaleSummaryNew(i.offerSaleRecordStat,i.identTityStat,i.rateStat,i.saleRecordStat),this._spliteSaleSummary()),1*this.config.halfYearTotal<=0&&this.paging.hide(),this.pageInitFlag=!0),i.orderDisplayEntryList&&1*this.config.halfYearTotal&&(this.headContent.show(),i.orderDisplayEntryList.length>0?this._renderItems(i.orderDisplayEntryList,this.app):this._renderNoRecord()),1*this.config.halfYearTotal<=0&&1*this.config.totalRate<=0?t(this.commentSatisfaction).hide():1*this.config.halfYearTotal<=0&&1*this.config.totalRate>0&&t(this.commentSatisfaction).addClass("norecord"),this.totalPanel.show()},_refreshPage:function(t,i,a){var s=this.selectContent.val()||"";i||(i=1),a||(a=!1),this.pageInitFlag||"0"!==s||(s=""),this._loadList(s,a,i)},_getParams:function(t,i,a){var s=!1,n=0;return a||(a=1),this.pageInitFlag||(n=1),i&&(s=!0),{currentPage:a,showStat:n,rateContentType:t,memberId:this.faceConfig.memberid,recordStatus:this.recordStatus||0}},_renderHeadItems:function(i){var a=this.headContent,s='<tr id="pj-listop" class="pj-listop clr">\r\n                                <th class="listop <% if(this.isSkuOffer() === "true"){ %> list-buyer-sku <% }else{ %> list-buyer <% } %> ">\r\n                                    <p>\u91c7\u8d2d\u5546</p>\r\n                                </th>\r\n                                <th class="listop <% if(this.isSkuOffer() === "true"){ %> list-trade-sku <% }else{ %> list-trade <%}%>">\r\n                                <% if(this.isSkuOffer() === "true"){ %><p class="list-spec-sku">\u5546\u54c1\u89c4\u683c</p><% } %><p  class="<% if(this.isSkuOffer() === "true"){ %> list-price-sku <% }else{ %> list-price <% } %>" > </p>\r\n                                </th>\r\n                                <th class="listop <% if(this.isSkuOffer() === "true"){ %> list-amount-sku <% }else{ %> list-amount <% } %> "><p>\u6570\u91cf</p></th>\r\n                                <th class="listop <% if(this.isSkuOffer() === "true"){ %> list-content-sku <% }else{ %> list-content <% } %> "><p>\u6210\u4ea4\u65f6\u95f4</p></th>\r\n                            </tr>',n='<tr id="pj-listop" class="pj-listop clr"><th class="listop list-buyer"><p>\u91c7\u8d2d\u5546</p></th><th class="listop list-trade" style="width:200px;"><p>\u52a0\u5de5\u7c7b\u578b</p></th><th class="listop list-amount" style="text-align: center;width:200px;"><p>\u6210\u4ea4\u4ef6\u6570</p></th><th class="listop list-content"><p>\u6210\u4ea4\u65f6\u95f4</p></th></tr>';a.html(FE.util.sweet(this.app.isTgcSKUOffer()?n:s).applyData({},i));var e=t("div.tip",a);t("a",e).click(function(t){t.preventDefault(),e.hide()}),this.selectContent=t("#select-content",this.div),this.selectContent.bind("change",t.proxy(this._refreshPage,this))},_renderItems:function(i,a){var s=this.dynamicBlock,n='<% for ( var i = 0; i < $data.length; i++ ) { %> \r\n                                <tr class="pj-list clr <% if((i+1) % 2 === 0){ %>even<% }else{ %>odd<% } %>" >\r\n                                    <td class="list <% if(this.isSkuOffer() === "true"){ %> list-buyer-sku <% }else{ %> list-buyer <% } %> ">\r\n                                        <p class="member"><%= $data[i].buyerName %>\r\n                                            <% if($data[i].isNym !== true){ %>\r\n                                                <% if($data[i].membericon){ %>\r\n                                                    <a class="member-star" href="<%= $data[i].memberTargetUrl %>" title="<%= $data[i].tips.membertip %>" target="_blank" trace="offer_buyers_rank" rel="nofollow"><img src="<%= $data[i].membericon %>" title="<%= $data[i].tips.membertip %>" alt="<%= $data[i].tips.membertip %>" /></a>\r\n                                                <% } %>\r\n                                            <% } %>\r\n                                        </p>\r\n                                        <ul class="badge">\r\n                                        <% if($data[i].isNym !== true){ %>\r\n                                            <% if($data[i].medalicon){ %>\r\n                                                <li><img src="<%= $data[i].medalicon %>" title="<%= $data[i].tips.medaltip %>" alt="<%= $data[i].medaltip %>" /></li>\r\n                                            <% } %>\r\n                                            <% if($data[i].pnaicon){ %>\r\n                                                <li><img src="<%= $data[i].pnaicon %>" title="<%= $data[i].tips.pnatip %>" alt="<%= $data[i].tips.pnatip %>" /></li>\r\n                                            <% } %>\r\n                                            <% if($data[i].tpicon){ %>\r\n                                                <li><img src="<%= $data[i].tpicon %>" title="<%= $data[i].tips.tptip %>" alt="<%= $data[i].tips.tptip %>" /></li>\r\n                                            <% } %>\r\n                                            <% if($data[i].tmicon){ %>\r\n                                                <li><img src="<%= $data[i].tmicon %>" title="<%= $data[i].tips.tbtip %>" alt="<%= $data[i].tips.tbtip %>" /></li>\r\n                                            <% } %>\r\n                                            <% if($data[i].tbicon){ %>\r\n                                                <li><img src="<%= $data[i].tbicon %>" title="<%= $data[i].tips.tbtip %>" alt="<%= $data[i].tips.tbtip %>" /></li>\r\n                                            <% } %>\r\n                                            <% if($data[i].cnaicon){ %>\r\n                                                <li><img src="<%= $data[i].cnaicon %>" title="<%= $data[i].tips.cnatip %>" alt="<%= $data[i].tips.cnatip %>" /></li>\r\n                                            <% } %>\r\n                                        <% } %>\r\n                                        </ul>\r\n                                    </td>\r\n                                    <td class="list <% if(this.isSkuOffer() === "true"){ %> list-trade-sku <% }else{ %> list-trade <%}%> ">\r\n                                        <% if($data[i].specInfo.length > 1){ %>\r\n                                            <% for ( var j = 0; j < $data[i].specInfo.length; j++ ) { %>\r\n                                            <div class="item <% (j === $data[i].specInfo.length-1)?%> last <%:%> <%;%>" ><span class=" list-spec-sku "><%= $data[i].specInfo[j] %></span><span class="list-price-sku"> <% if($data[i].salePromotion !== ""){ %><span class="tag" title=""><%= $data[i].salePromotion %></span><% } %></span><div class="fd-clr"></div></div>\r\n                                            <% } %>\r\n                                        <% }else{ %>\r\n                                            <% if(this.isSkuOffer() === "true"){ %><div class=" item-single"><span class="list-spec-sku" ><%= $data[i].specInfo[0] %>&nbsp;</span><%}%><span class="<% if(this.isSkuOffer() === "true"){ %> list-price-sku  <% }else{ %> list-price <% } %>  "> \r\n                                            <% if($data[i].bizType === "yf" || $data[i].bizType === "yp"){ %><span class="tag" title="\u62ff\u6837\u4ef7">[\u6837]</span><% } %><% if($data[i].salePromotion !== ""){ %><span class="tag" title=""><%= $data[i].salePromotion %></span><% } %></span><div class="fd-clr"></div></div>\r\n                                        <% } %>\r\n                                    </td>\r\n                                    <td class="list <% if(this.isSkuOffer() === "true"){ %> list-amount-sku <% }else{ %> list-amount <% } %>">\r\n                                        <p class="amount"><%= $data[i].quantity %> <%= this.getTradeUnit($data[i].unit) %> <% if($data[i].mix){ %><span class="tag" title="\u6df7\u6279">[\u6df7\u6279]</span><% } %></p>\r\n                                        <p class="note">\r\n                                        <!--<% if($data[i].countBuyerOrder){ %>\r\n                                            \u7d2f\u8ba1\u91c7\u8d2d<%= $data[i].countBuyerOrder %>\u6b21,\r\n                                        <% } %>-->\r\n                                        <% if( $data[i].countBuyerQuantity === -1){ %>\r\n                                            \u4e0d\u8ba1\u5165\u6210\u4ea4\u6570\r\n                                        <% } else if($data[i].countBuyerQuantity){ %>\r\n                                            \u7d2f\u8ba1\u91c7\u8d2d<%= $data[i].countBuyerQuantity %><%= this.getUnit() %>\r\n                                        <% } %>\r\n                                        </p>\r\n                                    </td>\r\n                                    <td class="list <% if(this.isSkuOffer() === "true"){ %> list-time-sku <% }else{ %> list-time <% } %>">\r\n                                        <p class="time"><%= $data[i].buyerPayTime %></p>\r\n                                    </td>\r\n                                </tr>\r\n                            <% } %>',e='<% for ( var i = 0; i < $data.length; i++ ) { %> \r\n                                <tr class="pj-list clr <% if((i+1) % 2 === 0){ %>even<% }else{ %>odd<% } %>" >\r\n                                    <td class="list list-buyer">\r\n                                        <p class="member"><%= $data[i].buyerName %>\r\n                                            <% if($data[i].isNym !== true){ %>\r\n                                                <% if($data[i].membericon){ %>\r\n                                                    <a class="member-star" href="<%= $data[i].memberTargetUrl %>" title="<%= $data[i].tips.membertip %>" target="_blank" trace="offer_buyers_rank" rel="nofollow"><img src="<%= $data[i].membericon %>" title="<%= $data[i].tips.membertip %>" alt="<%= $data[i].tips.membertip %>" /></a>\r\n                                                <% } %>\r\n                                            <% } %>\r\n                                        </p>\r\n                                        <ul class="badge">\r\n                                        <% if($data[i].isNym !== true){ %>\r\n                                            <% if($data[i].medalicon){ %>\r\n                                                <li><img src="<%= $data[i].medalicon %>" title="<%= $data[i].tips.medaltip %>" alt="<%= $data[i].medaltip %>" /></li>\r\n                                            <% } %>\r\n                                            <% if($data[i].pnaicon){ %>\r\n                                                <li><img src="<%= $data[i].pnaicon %>" title="<%= $data[i].tips.pnatip %>" alt="<%= $data[i].tips.pnatip %>" /></li>\r\n                                            <% } %>\r\n                                            <% if($data[i].tpicon){ %>\r\n                                                <li><img src="<%= $data[i].tpicon %>" title="<%= $data[i].tips.tptip %>" alt="<%= $data[i].tips.tptip %>" /></li>\r\n                                            <% } %>\r\n                                            <% if($data[i].tmicon){ %>\r\n                                                <li><img src="<%= $data[i].tmicon %>" title="<%= $data[i].tips.tbtip %>" alt="<%= $data[i].tips.tbtip %>" /></li>\r\n                                            <% } %>\r\n                                            <% if($data[i].tbicon){ %>\r\n                                                <li><img src="<%= $data[i].tbicon %>" title="<%= $data[i].tips.tbtip %>" alt="<%= $data[i].tips.tbtip %>" /></li>\r\n                                            <% } %>\r\n                                            <% if($data[i].cnaicon){ %>\r\n                                                <li><img src="<%= $data[i].cnaicon %>" title="<%= $data[i].tips.cnatip %>" alt="<%= $data[i].tips.cnatip %>" /></li>\r\n                                            <% } %>\r\n                                        <% } %>\r\n                                        </ul>\r\n                                    </td>\r\n                                    <td class="list list-trade" style="width:200px;">\r\n                                        <% if(this.isYP($data[i].bizType)){ %>\r\n                                            <div class="item-single"><span>\u6253\u6837</span></div>\r\n                                        <% }else{ %>\r\n                                        <% if($data[i].specInfo.length > 1){ %>\r\n                                        <% for ( var j = 0; j < $data[i].specInfo.length; j++ ) { %>\r\n                                            <div class="item<% if(j === $data[i].specInfo.length-1){ %> last<% } %>"><span><%= $data[i].specInfo[j] %></span></div>\r\n                                        <% } %>\r\n                                        <% }else{ %>\r\n                                            <div class="item-single"><span><% if($data[i].specInfo && $data[i].specInfo.length){ %><%= $data[i].specInfo[0] %><% } %></span></div>\r\n                                        <% } %>\r\n                                        <% } %>\r\n                                    </td>\r\n                                    <td class="list list-amount" style="width:200px;">\r\n                                        <p class="amount"><%= $data[i].quantity %> <%= this.getTradeUnit($data[i].unit) %> <% if($data[i].mix){ %><span class="tag" title="\u6df7\u6279">[\u6df7\u6279]</span><% } %></p>\r\n                                        <p class="note">\r\n                                        <% if($data[i].countBuyerQuantity === -1){ %>\r\n                                            \u4e0d\u8ba1\u5165\u6210\u4ea4\u6570\r\n                                        <% } else if($data[i].countBuyerQuantity){ %>\r\n                                            \u7d2f\u8ba1\u52a0\u5de5<%= $data[i].countBuyerQuantity %><%= this.getUnit() %>\r\n                                        <% } %>\r\n                                        </p>\r\n                                    </td>\r\n                                    <td class="list list-time">\r\n                                        <p class="time"><%= $data[i].buyerPayTime %></p>\r\n                                    </td>\r\n                                </tr>\r\n                            <% } %>';s.html(FE.util.sweet(this.app.isTgcSKUOffer()?e:n).applyData(i,a));var r=t("p.content-full"),l=t("p.explain-full");t(document).mouseover(function(i){var a=t("p.content-full",t(i.target).closest("td.list")),s=t("p.explain-full",t(i.target).closest("td.list"));return t(i.target).hasClass("content")?void a.show():t(i.target).hasClass("explain")?void s.show():(t(i.target).hasClass("content-full")||r.hide(),void(t(i.target).hasClass("explain-full")||l.hide()))})},_animateBar:function(i){var a=t("ul.col2 p",this.div),s=t("ul.col3 li",this.div);a.each(function(a,n){t(this).animate({width:(.8*i["star"+(5-a)]).toFixed(0)},2e3),s.eq(a).html(i["star"+(5-a)]+"%")})},_renderSaleSummaryNew:function(i,a,s,n){var e=t.extend(i,a,s,n),r='\r\n                    <div class="bargain-statistics">\r\n                    <div class="container first-col">\r\n                        <div class="repetitive-rate">\r\n                            <h4 class="d-title">\u91c7\u8d2d\u91cd\u590d\u7387\uff1a</h4>\r\n                            <div class="d-content"><span class="num"><%= $data.repeatBuyCount %>%</span></div>\r\n                        </div>\r\n                        <div class="purchase-number">\r\n                            <h4 class="d-title">\u4eba\u5747\u91c7\u8d2d\u6570\uff1a</h4>\r\n                            <div class="d-content"><span class="num"><%= this.getNumberFixed($data.avgBuyCount,false) %></span><span class="unit"><%= this.getUnit() %></span></div>\r\n                        </div>\r\n                    </div>\r\n                    <div class="container last-col">\r\n                        <div class="buyer-number">\r\n                            <h4 class="d-title">\u91c7\u8d2d\u4eba\u6570\uff1a</h4>\r\n                            <div class="d-content"><span class="num"><%= this.getNumberFixed($data.buyerTotal,false) %></span></div>\r\n                        </div>\r\n                        <div class="buyer-number-statistics">\r\n                            <i class="icon-arrow"></i>\r\n                            <dl>\r\n                                <dt class="fd-left fd-clear">\u91d1/\u94f6\u724c\u91c7\u8d2d\u5546\uff1a</dt>\r\n                                <dd><span class="proportion" data-percent="<%= $data.percentGS %>"></span><span class="num"><%= $data.percentGS %>%</span></dd>\r\n                                <dt class="fd-left fd-clear">\u8ba4\u8bc1\u4f1a\u5458\uff1a</dt>\r\n                                <dd><span class="proportion" data-percent="<%= $data.percentCER %>"></span><span class="num"><%= $data.percentCER %>%</span></dd>\r\n                                <dt class="fd-left fd-clear">\u6dd8\u5b9d/\u5929\u732b\u4f1a\u5458\uff1a</dt>\r\n                                <dd><span class="proportion" data-percent="<%= $data.percentTBM %>"></span><span class="num"><%= $data.percentTBM %>%</span></dd>\r\n                            </dl>\r\n                        </div>\r\n                    </div>\r\n                    </div>';this.htmlBargainStatistics=FE.util.sweet(r).applyData(e,this.app)},_spliteSaleSummary:function(){var i,a=1*this.config.total,s='<p class="no-record">\u672c\u5546\u54c1\u7d2f\u8ba1\u552e\u51fa<span class="num {class}">{num}</span><span class="unit">{unit}</span>\uff0c30\u5929\u5185\u6ca1\u6709\u6210\u4ea4\u8bb0\u5f55</p>';1*this.config.halfYearTotal?this.totalPanel.after(this.htmlBargainStatistics):(i=t.util.substitute(s,{"class":0>=a?"num-zero":"",num:a,unit:this.faceConfig.unit}),this.totalPanel.html(i).addClass("sale-zero")),this._initbuyerNumberStatistics()},_initbuyerNumberStatistics:function(){var i=t("div.buyer-number-statistics",this.div),a=t("span.proportion",i),s=t("div.record-filter span",this.div),n=this;a.each(function(i){var a=t(this),s=a.data("percent");a.animate({width:s},"1000")}),s.each(function(i,a){var a=t(a);a.data("count")||a.addClass("noresult")}),this.div.on("click","div.record-filter span",function(){t(this).hasClass("noresult")||(n.recordStatus=t(this).data("recordstatus"),n._refreshPage())})},_renderSaleSummary:function(i,a){var s=t("div.record-statistics",this.div),n=t.extend(i,a),e='<p class="record-sale">\u672c\u5546\u54c1\u7d2f\u8ba1\u552e\u51fa<em class="de-num <% if(this.getTotal() * 1 <= 0){ %>de-num-zero <% } %>"><%= this.getTotal() %></em><span class="unit"><%= this.getUnit() %></span>\uff0c\r\n                     <% if(this.getHalfYearTotal() * 1){ %>\r\n                        \u4ee5\u4e0b\u4e3a\u6700\u8fd190\u5929\u6570\u636e</p>\r\n                        <div class="buyer-total"><span class="de-num"><%= $data.buyerTotal %></span>\u4f4d\u91c7\u8d2d\u5546<div class="arrow"></div></div>\r\n                        <ul class="buyer-percentage">\r\n                          <li>\r\n                              \u91d1/\u94f6\u724c\u91c7\u8d2d\u5546:<span class="percentage">&nbsp;<%= $data.percentGS %>%</span>\r\n                          </li>\r\n                          <li>\r\n                              \u8ba4\u8bc1\u4f1a\u5458:<span class="percentage">&nbsp;<%= $data.percentCER %>%</span>\r\n                          </li>\r\n                          <li>\r\n                              \u6dd8\u5b9d/\u5929\u732b\u5e97\u4e3b:<span class="percentage">&nbsp;<%= $data.percentTBM %>%</span>\r\n                          </li>\r\n                          <li class="question" >\r\n                            <a class="open" href="#"></a>\r\n                            <div class="tip"><p>\u76f8\u5173\u540d\u8bcd\u89e3\u91ca<a href="//114.1688.com/kf/detail/28141770.html?tracelog=kf_2012_budian_mjjytao" target="_blank">\u70b9\u51fb\u67e5\u770b</a></p><div class="arrow"></div></div>\r\n                          </li>\r\n                        </ul>\r\n                        <ul class="record-summary">\r\n                          <li>\r\n                            \u6210\u4ea4\u4ef6\u6570: <span class="de-num"><%= $data.saleRecordTotal %></span><%= this.getUnit() %>\r\n                          </li>\r\n                          <li>\r\n                            \u4eba\u5747\u91c7\u8d2d\u6570: <span class="de-num"><%= $data.avgBuyCount %></span><%= this.getUnit() %>\r\n                          </li>\r\n                          <li>\r\n                            \u91c7\u8d2d\u91cd\u590d\u7387: <span class="de-num"><%= $data.repeatBuyCount %></span>%\r\n                          </li>\r\n                        </ul>\r\n                        <p class="comment-note">\uff08\u7edf\u8ba1\u7ed3\u679c\u622a\u6b62\u5230\u6628\u5929\uff09</p>\r\n                    <% }else if(this.getHalfYearTotal() * 1 <= 0 && this.getTotalRate() * 1){ %>\r\n                    \u603b\u4f53\u6ee1\u610f\u5ea6\u5982\u4e0b\r\n                    <% }else if(this.getHalfYearTotal() * 1 <= 0 && this.getTotalRate() * 1 <= 0){ %>\r\n                    90\u5929\u5185\u6ca1\u6709\u6210\u4ea4\u8bb0\u5f55\r\n                 <% } %>';s.html(FE.util.sweet(e).applyData(n,this.app));var r=t("a.open",s),l=t("div.tip",s);r.mouseover(function(){l.show()}),r.click(function(t){t.preventDefault()}),t(document).click(function(i){var a=t(i.target).closest("li.question");a.length||l.hide()})},sortByStarLevel:function(t,i){return t.starLevel===i.starLevel?0:t.starLevel>i.starLevel?-1:1},_renderNoRecord:function(){var t,i=this.dynamicBlock,t="true"===this.faceConfig.isSKUOffer?5:4;i.html('<tr class="nocomment"><td colspan="'+t+'"><p>\u65e0\u4efb\u4f55\u7b26\u5408\u60a8\u7b5b\u9009\u7684\u8bb0\u5f55\u3002</p></td></tr>')},_renderRequestFailed:function(){var t=this.contentWrapper;t.html('<div id="sysbusy1" class="sysbusy" style="display:none;"><p>\u7cfb\u7edf\u7e41\u5fd9\uff0c\u6682\u65f6\u65e0\u6cd5\u8bfb\u53d6\u6570\u636e\uff0c\u8bf7\u7a0d\u540e\u5237\u65b0\u9875\u9762\u518d\u8bd5\uff01</p></div>')}};i.add("mod-detail-dealrecord","area-detail-credit",n)});;define(["jQuery","ModContext"],function(e,i,t,n){var o={currentPage:1,noCommentFlag:!1,init:function(i,t,n,o,r){if(this.div=i,this.faceConfig=r,this.div.length){var a="0.0.4";t&&t.ratePluginVersion&&"string"==typeof t.ratePluginVersion&&(a=t.ratePluginVersion);var f="https://g.alicdn.com/ctf/rate-list4offer/"+a+"/index.js";e.ajax({url:f,dataType:"script",cache:!0}).done(function(e,i){"success"===i?define(["rate-list4offer"],function(e){try{var i=window.iDetailConfig||{},n=t||{},o=i.offerid||"",r=i.memberid||"",a="dsc",f="#J_DetailCommentWrapper";n&&"true"===n.isHxpOffer&&(a="hxp"),e.init({offerId:o,memberId:r,offerScene:a,ele:f})}catch(c){console.log(c)}}):console.log(f,"load fail")})}}};i.add("mod-detail-comment","area-detail-credit",o)});;define(["jQuery","ModContext"],function(t,i){var e={_options:{container:"#J_Box_ExclusiveServiceContainer",slideListMain:"#J_Box_ExclusiveServiceListMain",prevBtn:".prev-btn",nextBtn:".next-btn",slideNum:8,time:300},_cacheStorage:{},_getContainer:function(){return this._cacheStorage&&this._cacheStorage.elem||(this._cacheStorage.elem=t(this._options.container,"body")),this._cacheStorage.elem},_getSingleWidth:function(){if(!this._cacheStorage||!this._cacheStorage.singleWidth){var t=this._getContainer(),i=t.find(this._options.slideListMain+"  li"),e=i.eq(0).outerWidth(!0);this._cacheStorage.singleWidth=e}return this._cacheStorage.singleWidth},_getItemCount:function(){if(!this._cacheStorage||!this._cacheStorage.itemCount){var t=this._getContainer(),i=(this._options.slideNum,t.find("li"));this._cacheStorage.itemCount=i.length}return this._cacheStorage.itemCount},_getSlideWidth:function(){if(!this._cacheStorage||!this._cacheStorage.slideWidth){var t=this._options.slideNum,i=this._getSingleWidth();this._cacheStorage.slideWidth=t*i}return this._cacheStorage.slideWidth},_getListWidth:function(){if(!this._cacheStorage||!this._cacheStorage.listWidth){var t=this._getSlideWidth(),i=this._options.slideNum,e=this._getContainer(),n=e.find(this._options.slideListMain+" li").length;n=Math.ceil(n/i),this._cacheStorage.listWidth=t*n}return this._cacheStorage.listWidth},_initList:function(){var t=this._getItemCount(),i=this._getContainer(),e=this._options.slideNum;if(t>e){i.children(this._options.prevBtn).addClass("slide-btn-disabled").attr("disabled","disabled").show(),i.children(this._options.nextBtn).show();var n=this._getListWidth();i.children(this._options.slideListMain).children("ul").css("width",n+"px"),this._initSlideScreenNum()}else i.children(this._options.prevBtn).hide(),i.children(this._options.nextBtn).hide()},_initSlideScreenNum:function(){var t=this._getItemCount(),i=this._getContainer(),e=this._options.slideNum,n=t%e===0?t-e===0?0:t/e-1:Math.floor(t/e);i.children(this._options.slideListMain).attr("data-screen-count",n).attr("data-screen-current","0")},_slideBtnEvent:function(i,e,n){if("disabled"!==i.attr("disabled")){var s=this._getSingleWidth(),o=this._getContainer(),a=(this._getItemCount(),this._options.slideNum),r=t(this._options.slideListMain+" ul",o),d=s*a,h=("prev"===e?Math.ceil(r.position().left):Math.floor(r.position().left),o.children(this._options.prevBtn)),l=o.children(this._options.nextBtn),c=this._options.time,_=o.children(this._options.slideListMain),v=_.attr("data-screen-count"),u=_.attr("data-screen-current");v=parseInt(v,10),u=parseInt(u,10);var p=0,f=!1;"prev"===e?u>0&&v>=u&&(u-=1,p=0-u*d,f=!0):u>=0&&v>u&&(u+=1,p=0-u*d,f=!0),f&&(h.attr("disabled","disabled"),l.attr("disabled","disabled"),r.animate({left:p+"px"},c,function(){h.removeAttr("disabled","disabled"),l.removeAttr("disabled","disabled"),f=!1,_.attr("data-screen-current",u),0>=u?h.addClass("slide-btn-disabled"):h.removeClass("slide-btn-disabled"),u>=v?l.addClass("slide-btn-disabled"):l.removeClass("slide-btn-disabled"),"function"==typeof n&&n()}))}},_bindBtnEvent:function(i){var e=this._getItemCount(),n=this._options.slideNum;if(!(n>=e)){var s=this,o=s._getContainer(),a=t(this._options.prevBtn,o),r=t(this._options.nextBtn,o);a.on("click",function(i){i.preventDefault(),s._slideBtnEvent(t(this),"prev",function(){s._cleanTip()})}),r.on("click",function(i){i.preventDefault(),s._slideBtnEvent(t(this),"next",function(){s._cleanTip()})})}},_cleanTip:function(){var i=t("#J_Box_ExclusiveServiceTip_Before"),e=t("#J_Box_ExclusiveServiceTip_Text"),n=this._getContainer(),s=n.find(this._options.slideListMain+" li");s.removeClass("exclusive-active"),i.hide(),e.text("")},_hoverTipEvent:function(i,e){e.removeClass("exclusive-active"),i.addClass("exclusive-active");var n=this._getContainer(),s=t("#J_Box_ExclusiveServiceTip_Before"),o=t("#J_Box_ExclusiveServiceTip_Text"),a=i.attr("data-tip-text")?i.attr("data-tip-text"):"",r=this._getSingleWidth(),d=this._options.slideNum,h=i.index(),l=n.children(this._options.slideListMain),c=(n.width()-l.width())/2,_=s.width();h=d>h?h:h%d;var v=c+h*r+r/2-_/2;s.css("left",v+"px").show(),o.text(a)},_bindHoverEvent:function(){var i=this,e=i._getContainer(),n=e.find(this._options.slideListMain+" li");n.on("mouseover",function(){i._hoverTipEvent(t(this),n)})},_initHoverEvent:function(){var t=this._getContainer(),i=t.find(this._options.slideListMain+" li"),e=i.eq(0);this._hoverTipEvent(e,i)},init:function(){t("#J_Mod_ExclusiveServiceContainer")&&t("#J_Mod_ExclusiveServiceContainer").length>0&&(this._initList(),this._initHoverEvent(),this._bindBtnEvent(),this._bindHoverEvent())}},n={_ajaxEvent:function(i){var e=iDetailConfig.memberid,n="//supplier.caigou.1688.com/supplier/slcyqApplyInfo/queryApplyInfo.jsonp";t.ajax({url:n,dataType:"jsonp",type:"get",data:{memberId:e},success:i})},_getData:function(){var t=this;t._ajaxEvent(function(i){if(i&&i.success){var e=t._parserData(i);t._render(e)}})},_parserData:function(t){var i=t.data.substitutingInfo,e=t.data.substitutingInfoMap,n=[];if(i&&e){for(var s in i){var o={name:i[s]?i[s]:"",text:e[s]?e[s]:""};n.push(o)}return n}},_render:function(i){if(i&&!(i.length<=0)){var n=t("#J_Mod_ExclusiveServiceContainer");if(i.length<=0)return void n.html("");n.show();for(var s="",o=t("#J_Box_ExclusiveServiceList"),a=0;a<i.length;a++){var r=i[a].name;4===r.length?r=r.substr(0,2)+"<br/>"+r.substr(2,2):5===r.length&&(r=r.substr(0,2)+"<br/>"+r.substr(2,3)),s=s+'<li data-tip-text="'+i[a].text+'"><a href="javascript:void(0)"><span>'+r+"</span></a></li>"}o.html(s),e.init()}},_initRender:function(){var i=this,e=t("#J_Mod_ExclusiveServiceContainer");e&&e.length>0&&i._getData()},init:function(){this._initRender()}},s={init:function(i){if(this.div=i,this.orderLock=!1,this.div.length){this.lazyContainer=t("div.lazyload-textarea",this.div);var e=this,s=0;t(window).bind("loadOrder resize.orderInfo scroll.orderInfo",function(i,o){if(!e.orderLock){var a=t(document).scrollTop()+t(window).height()+s;if(o||e.div.length>0&&t(e.div).offset().top<a){e._retrieveOrderInfo(),e.orderLock=!0;try{n.init()}catch(i){}}}}),t(window).trigger("loadOrder")}},_retrieveOrderInfo:function(){this.lazyContainer.length&&this.lazyContainer.html(t(".lazyload-context",this.lazyContainer).html())}};i.add("mod-detail-order","area-detail-credit",s)});;define(["jQuery","ModContext","pkg/@alife/refly-mbox/2.0.20/index","sys/logist/1.0","pkg/@alife/lofty-aliuser/1.0.0/index"],function(e,o,t,i,n){function r(o){var i=e.Deferred();return t.getData("createDistributeRelation",o,{csrfToken:!0,transType:"transport"}).then(function(e){return e&&e.content&&e.content.mboxResult?e.content.mboxResult.isSuccess?void i.resolve():void i.reject(e.content.mboxResult):void i.reject({})}),i.promise()}function s(){var o=e.Deferred();return t.getData("isKjMemberService").then(function(e){e&&e.content&&e.content.result?o.resolve(e.content.result.isKjMember):o.reject(e)}),o.promise()}function c(){var o=e.Deferred();return t.getData("kjOfferPicPackageDownload",{offerId:a},{csrfToken:!0,transType:"transport"}).then(function(e){e&&e.content&&e.content.result&&e.content.result.success?o.resolve(e.content.result.data.url):o.reject(e)}),o.promise()}var a=window.iDetailConfig.offerid,d={init:function(){e(".mod-kj-pic-package .download-package").on("click",e.proxy(this.download,this)),this.getPackageInfo()},getPackageInfo:function(){t.getData("kjOfferPicPackageInfo",{offerId:a}).then(function(o){var t=o.content.result;if(!t.success)return void e(".mod-kj-pic-package .fd-clr").hide();var i=t.data;e(".mod-kj-pic-package .resource-size").text((i.size/1024/1024).toFixed(2)+"M"),e(".mod-kj-pic-package .picture-amount").text(i.count);var n=e(".mod-kj-pic-package .sample-picture-list");e.each(i.images,function(e,o){n.append('<li class="sample-picture-container"><img class="sample-picture" src="'+o+'" alt="" /></li>')})})},download:function(){if(!n.isLogin())return void this.showLogin();if(window.goldlog&&window.goldlog.record("/1688kj.kj-fenxiao.dl-pigpkg","CLK","m_id=[$]&offer_id=[$]","H1484266039"),window.iDetailConfig.memberid===window.iDetailConfig.buyerUserID)return void this.doDownload();var o=this,t=window.iDetailConfig.userId;s().done(function(i){return i?void r({supplierUserId:t,source:"kuajing"}).done(function(){o.doDownload()}).fail(function(t){var i="\u5efa\u7acb\u94fa\u8d27\u5173\u7cfb\u5931\u8d25",n=e("input[name=currentDomainUrl]").val()+"/page/merchants.htm?source=kuajing&autoapply=distribute#fx-applydistribute";return"112"===t.resultCode||"164"===t.resultCode?void o.doDownload():"163"===t.resultCode?void o.showAlert('\u5efa\u7acb\u94fa\u8d27\u5173\u7cfb\u5931\u8d25\uff0c\u8bf7\u5148<a href="'+n+'" target="_blank">\u7533\u8bf7\u5206\u9500</a>'):t.resultMsg?void o.showAlert(i+"\uff0c"+t.resultMsg):void o.showAlert(i)}):void o.showNotQualified()})},doDownload:function(){var e=this;c().done(function(e){window.location.href=e}).fail(function(){e.showAlert("\u83b7\u53d6\u4e0b\u8f7d\u94fe\u63a5\u5931\u8d25")})},showLogin:function(){var e=this;i.init({source:"offerDetail_distributeToCrossborder",ssoGateway:"//exodus.1688.com/member/sso/ssoSessionGateWay.do?targetUrl=",onLoginSuccess:function(){i.hide(),setTimeout(function(){e.download()},500)},onRegistSuccess:function(){this.onLoginSuccess()}})},showNotQualified:function(){this.showConfirm({content:"\u56fe\u7247\u5305\u4e0b\u8f7d\u529f\u80fd\u53ea\u63d0\u4f9b\u7ed9\u771f\u5b9e\u7684\u8de8\u5883\u7528\u6237\u4e14\u9886\u53d6\u4e86\u8de8\u5883vip\u7684\u7528\u6237\uff0c\u70b9\u51fb\u53bb\u786e\u8ba4\u60a8\u7684\u8eab\u4efd\u5e76\u9886\u53d6",confirmLink:"https://kj.1688.com/500f98c1.html?tracelog=offerdetail&redirectUrl="+encodeURIComponent(window.location.href.split("#")[0]+"#kj-pic-package-download"),confirmText:"\u786e\u8ba4\u5e76\u9886\u53d6",cancelText:"\u53d6\u6d88"})},showConfirm:function(o){e(".cross-border-dialog-mask").remove();var t=e('<div class="cross-border-dialog-mask"><div class="cross-border-dialog">  <div style="text-align: right; padding: 10px;">    <span class="close close-icon"></span>  </div>  <div style="padding: 0 20px 20px; line-height: 2;">    <h4 style="margin-bottom: 15px; font-size: 14px;">'+o.content+'    </h4>    <div class="btn fd-hide" style="display: block;padding: 10px;">      <a href="'+(o.confirmLink||"javascript:void(0)")+'"         class="dsc-btn-important confirm">'+o.confirmText+'      </a>      <button class="dsc-btn close">'+o.cancelText+"      </button>    </div>  </div></div></div>");t.appendTo(document.body),this.dialog=t,t.on("click",".confirm",o.onConfirm||function(){t.remove()}).on("click",".close",function(){t.remove()})},showAlert:function(e){this.showConfirm({content:e,confirmText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88"}),this.dialog.find("button.close").remove(),this.dialog.find(".dsc-btn-important").removeClass("confirm").addClass("close")}};o.add("mod-kj-pic-package",d)});;define(["jQuery","ModContext"],function(e,i){function t(e,i){var t,o,n;o=!1,t=document.createElement("script"),t.type="text/javascript",t.src=e,t.onload=t.onreadystatechange=function(){o||this.readyState&&"complete"!=this.readyState||(o=!0,i())},n=document.getElementsByTagName("script")[0],n.parentNode.insertBefore(t,n)}var o={scriptResourceLoaded:!1,init:function(i,t,o,n,a){this.div=i,this.faceConfig=a,this.div.length&&e(window).bind("loadKjpicpackage",this.loadModule.bind(this))},loadModule:function(){var i=this.div,o=this.div.data("config");if(!o.pluginCrossBorderAbilityResourceRoot||!o.pluginCrossBorderAbilityModuleName)return!1;var n=o.pluginCrossBorderAbilityResourceRoot+"/js/index.js";t("https://gw.alipayobjects.com/os/antv/pkg/_antv.g2-3.4.1/dist/g2.min.js",function(){e.ajax({url:n,dataType:"script",cache:!0}).done(function(e,t){"success"===t?define([o.pluginCrossBorderAbilityModuleName],function(e){try{var t=window.iDetailConfig||{},n=t.offerid||"",a=t.memberid||"";e.init(i,{offerId:n,memberId:a,extend:o})}catch(d){console.log(d)}}):console.log(commentExtendPlugin,"load fail")})})}};i.add("mod-crossability","mod-kj-pic-package",o)});;"irecomTpp"in FE.sys||function(t,e,a){function n(e,r,i){var c=this;if(!(c instanceof n))return new n(e,r,i);c.container=t(e)||t(a.document),c.config=t.extend(!0,{},o,i);var l={};t.isPlainObject(r)&&(l.appid=r.recid,l.module=r.module,l.item_id=r.offerids,l.count=c.config.filter||10),c.params=l,c._init()}var r=a.dmtrack_pageid="undefined"==typeof a.dmtrack_pageid?new Date-0+""+Math.floor(1e3*Math.random()):a.dmtrack_pageid,i=e.getLastMemberId()||"",c=Object.prototype.hasOwnProperty,o={template:null,filter:null,statScene:"",apiUrl:"//tui.taobao.com/recommend",debug:!1,debugUrl:"//10.20.150.79/fly/irecom.do",datalazyload:!1,ctrQueue:[],onTemplateReady:null,onLazyloadReady:null,onSuccess:null,onFailure:null},l=0===location.protocol.indexOf("https")?"https://":"http://",s=function(t){return"string"==typeof t?t.replace(/^(?:http:)?\/\//i,l):t};t.extend(n.prototype,{_init:function(){var n,i=this,c={},o=(a.location.search.substring(1).toLowerCase(),e.getLastMemberId()),l=e.lastLoginId,s=e.loginId,d=t.util.cookie("cna");c.uid=o||s||l||d||-1,c.pageid=r,i.params=t.extend(!0,{},c,i.params),i.config.debug&&(i.config.apiUrl=i.config.debugUrl),i.config.datalazyload?t.use("web-datalazyload",function(){n=i.datalazyload=e.datalazyload,n.bind(i.container,function(){i._request()}),n.init()}):i._request()},_request:function(){var e=this;t.ajax({url:e.config.apiUrl,data:e.params,dataType:"jsonp",success:function(t){e._isCorrect(t)?e._onCallback(t):e._onFailure()},error:function(){e._onFailure()}})},_isCorrect:function(e){var a=this,n=a.config,r=!1;return e&&e.result&&t.isArray(e.result)&&("number"==typeof n.filter&&n.filter>=1?e.result=e.result.slice(0,n.filter):"function"==typeof n.filter&&(e.result=t.grep(e.result,n.filter)),e.result.length>0&&(r=!0)),r},_onCallback:function(e){var a=this;a.data=a.config&&a.config.dataHandler&&"function"==typeof a.config.dataHandler?a.config.dataHandler(e.result):a.dataHandler(e.result),a._loadTemplate(t.proxy(a,"_renderData"))},dataHandler:function(t){for(var e,a=[],n=0;n<t.length;n++)e={},e.offerId=t[n].itemId,e.subject=t[n].itemTitle,e.offerDetailUrl=t[n].url,e.rmbPrice=t[n].reservePrice+"",e.offerImageUrl=t[n].picUrl?"//cbu01.alicdn.com/"+t[n].picUrl.replace(".jpg",""):"",e.memberId=t[n].memberId,e.sales30Day=t[n].biz30day,e.unit="",e.allData=t[n],a.push(e);return{data:a}},_loadTemplate:function(a){var n,r=this,i=r.data.data,c=r.config,o=r.container;if(c.template){if(n)return a(n);t.use("web-sweet",function(){c.onTemplateReady&&c.onTemplateReady.call(r,i),n=e.sweet(c.template),a(n)})}else o.html("<p>\u6ca1\u6709\u6307\u5b9a\u6e32\u67d3\u6a21\u677f\uff01</p>")},_renderData:function(t){{var e=this,a=e.data.data,n=e.config;e.container}e.tpl=t,e.config.datalazyload?e._datalazyloadHandler():(e._renderHandler(),n.onSuccess&&n.onSuccess.call(e,a))},_datalazyloadHandler:function(){var t=this,e=t.data.data,a=t.config;t._renderHandler(),a.onLazyloadReady&&a.onLazyloadReady.call(t,e),t.datalazyload.register({containers:t.container}),a.onSuccess&&a.onSuccess.call(t,e)},_renderHandler:function(){var e=this,a=e.data.data,n=e.container;tpl=e.tpl,n.html(t(tpl.applyData(a,e))),e._clickstat(),e._ctrstat()},_onFailure:function(){var t=this,e=t.container,a=t.config;null===a.onFailure?e.html('<p>\u6570\u636e\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7<a target="_self" href="javascript:location.reload();">\u5237\u65b0</a>\u91cd\u8bd5\uff01</p>'):a.onFailure.call(e)},_clickstat:function(){var e=this;e.container.delegate("a[data-clickstat]","mousedown",function(a){var n,o={},l=t(this).data("clickstat"),s=[];l=e._parseObj(l),l.objectId&&(o.objectId=l.objectId),l.alg&&(o.alg=l.alg),l.pid&&(o.pid=l.pid),l.objectType&&(o.objectType=l.objectType),l.l_offerid&&(o.l_offerid=l.l_offerid),o.page=e.config.statScene,o.recId=e.params.recid,o.st_page_id=r,o.time=(new Date).getTime(),o.interface_id=e.params.recid,o.ctr_ns=e.config.ctr_ns?e.config.ctr_ns:"",o.uid=i;for(n in o)c.call(o,n)&&s.push(n+"="+o[n]);s=s.join("&"),(new Image).src="//gm.mmstat.com/btob.35?gokey="+encodeURIComponent(s)+"&time="+(new Date).getTime()})},_ctrstat:function(){var e=this,a=e.config.ctrQueue;e.ctrData={},t.each(a,function(a,n){e._isCtrBatch(n)?e._sniffBatch(n,a):e.datalazyload.bind(e.container.find(n.selector),function(a){e._ctrRequest(n.param,e._sniffNode(t(a)))})}),t.each(a,function(t,a){e._isCtrBatch(a)&&e._ctrBatch(a,t)})},_isCtrBatch:function(t){var e=this;return!e.config.datalazyload||"undefined"==typeof t.ctrBatch||t.ctrBatch},_sniffBatch:function(e,a){var n=this,r=n.ctrData;t.isArray(r[a])||(r[a]=[]),r[a]=n._sniffNode(t(e.selector,n.container))},_sniffNode:function(e){var a,n=this,r=[];return n.container.find(e).each(function(){a=n._parseObj(t(this).data("ctr")),t.isPlainObject(a)||(a={objectId:"",alg:""}),r.push((a.objectId||"")+","+(a.alg||""))}),r},_ctrBatch:function(t,e){var a=this,n=a.ctrData,r=t.size||n[e].length,i=t.start||0;a._ctrRequest(t.param,n[e].slice(i,i+r))},_ctrRequest:function(e,a){var n,o=this,l=e||{},s=[];l.object_ids=a.join(";"),l.page_area=o.params.recid,l.ctr_type=o.config.statScene,l.page_id=r,l.interface_id=o.params.recid,l.ctr_ns=o.config.ctr_ns?o.config.ctr_ns:"",l.uid=i;for(n in l)c.call(l,n)&&s.push(n+"="+l[n]);s=s.join("&"),t.getScript("//ctr.1688.com/ctr.html?"+s),(new Image).src="//gm.mmstat.com/ctr.1688.2?gokey="+encodeURIComponent(s)},ctrManual:function(t,e,a,n){var r=this,i=r._sniffNode(t);a=a||i.length,n=n||0,r._ctrRequest(e,i.slice(n,n+a))},_parseObj:function(t){try{return"object"==typeof t?t:new Function("return "+t)()}catch(e){return{}}}}),n.fitLength=function(e,a){return e=t.util.unescapeHTML(e),e.lenB()>a&&(e=e.cut(a-3)+"..."),t.util.escapeHTML(e)},n.getOfferUrl=function(t){var e=t.eURL?t.eURL:t.offerDetailUrl;return e},n.getSearchUrl=function(t){var e="//s.1688.com/search/offer_search.htm?keywords="+t.categoryDesc;return e},n.getCompanyUrl=function(t){var e=t.contact;return e},n.getBizrefUrl=function(t){var e=t.domainID,a=t.memberId,n="";return!e||(n="http://"+e+".cn.1688.com/athena/bizreflist/"+e+".html"),!a||(n="http://"+a+".cn.1688.com/athena/bizreflist/"+a+".html"),n},n.getPrice=function(t,e){var a="",e=e||0;return a=-1===["0.0","0",0,""].indexOf(t.rmbPrice)?'<span class="fd-cny">&yen;</span><em class="value">'+t.rmbPrice+"</em>"+(e?'<span class="unit">/'+t.unit+"</span>":""):'<em class="value">\u4ef7\u683c\u9762\u8bae</em>'},n.getImgUrl=function(t,e){var a=t.offerImageUrl,n=e||100,r="";return r=a?151>n?101>n?a+".summ.jpg":a+".search.jpg":221>n?a+".220x220.jpg":a+".310x310.jpg":151>n?101>n?"//cbu01.alicdn.com/cms/upload/other/nopic-100.png":"//cbu01.alicdn.com/cms/upload/other/nopic-150.png":221>n?"//cbu01.alicdn.com/cms/upload/other/nopic-220.png":"//cbu01.alicdn.com/cms/upload/other/nopic-310.png",s(r)},n.p4pSort=function(t){t.sort(function(t,e){var a=t.eURL?0:1,n=e.eURL?0:1;return a-n})},n.resizeImg=function(t,e,n){t.removeAttribute("width"),t.removeAttribute("height");var r;if(a.ActiveXObject?(r=new Image,r.src=t.src):r=t,r&&r.width&&r.height&&e&&(n||(n=e),r.width>e||r.height>n)){var i=r.width/r.height,c=i>=e/n;t[c?"width":"height"]=c?e:n,a.ActiveXObject&&(t[c?"height":"width"]=(c?e:n)*(c?1/i:i))}},FE.sys.irecomTpp=n,t.add("sys-irecomTpp")}(jQuery,FE.util,window);;define(["jQuery","ModContext","widget.common.plugin.SuggestOffer"],function(e,i,o){var t={init:function(i){var t=this;this.div=i;var n=100;this.suggestLock=!1,e(window).bind("loadIrecom scroll.irecom resize.irecom",function(i,d){if(!t.suggestLock){var r=e(document).scrollTop()+e(window).height()+n;(d||"undefined"!=typeof window.iDetailConfig&&t.div.length>0&&e(t.div).offset().top<r)&&(new o({root:t.div,subLength:174,fitLength:64,dmtrack:{pic:"recommend1pic",title:"recommend1title"},count:8,perItem:5,count:10,isMarquee:"false"}),t.suggestLock=!0)}}),e(window).trigger("loadIrecom")}};i.add("mod-detail-irecom","area-detail-recommend",t)});;define(["jQuery","ModContext"],function(i,o){var e={init:function(o,e){this.div=o,this.config=e,this.p4pLock=!1;var t=0,d=this;i(window).bind("loadP4p scroll.p4p resize.p4p",function(o,e){if(!d.p4pLock){var n=i(document).scrollTop()+i(window).height()+t;(e||"undefined"!=typeof d.config&&d.div.length>0&&i(d.div).offset().top<n)&&(d.loadP4pOffer(),d.p4pLock=!0)}}),i(window).trigger("loadP4p")},loadP4pOffer:function(){if("true"!=this.div.data("lazyLoad")){this.div.data("lazyLoad","true");{var i=this.config;new Post(createP4PURL(i),"p4pOffers",onP4pSuccess,onP4pFailure)}}}};o.add("mod-detail-p4p","area-detail-recommend",e)});;define(["jQuery","AreaContext","page.common.area.slide"],function(t,i,e){var a="SLIDE",s={init:function(i,s){this.mods=t("div.mod",i),this.tabContainer=t("ul.activity-tab",i),this.tabContent=t("div.activity-content",i),this.tabItems=t("li",this.tabContainer),this.hash=window.location.hash,this.targetParam=this.hash.split("-"),this.targetActivity=null,this.targetScroll=null,"#activity"===this.targetParam[0]&&(this.targetActivity=this.targetParam[1],this.targetParam[2]&&"scroll"===this.targetParam[2]&&(this.targetScroll=!0)),this.targetSeq=0;var n=this,o=null;this.targetActivity&&this.targetScroll&&detail.on("detailReady",function(){t(window).scrollTop(n.mods.length>1?n.tabContainer.offset().top:n.tabContent.offset().top)}),"SLIDE"===a?e.init(i,s):this.mods.length>1?(n.mods.sort(function(i,e){var a=1*t(i).data("modConfig").seq,s=1*t(e).data("modConfig").seq;return a>s?!0:!1}),this.targetSeq=n._renderTab(),this.mods.hide(),i.show(),this.tabItems=t("li",this.tabContainer),this.tabContainer.on("click","li a",function(i){i.preventDefault(),n.tabItems.removeClass("de-selected"),t(this).closest("li").addClass("de-selected"),n.mods.hide(),n.mods.eq(n.tabItems.index(t(this).closest("li"))).show()}),o=this.tabItems.eq(n.targetSeq),t("a",o).click()):this.mods.length<=1&&this.mods.length>0?(this.tabContainer.hide(),this.tabContent.css("border-top-width","1px"),i.show()):this.tabContainer.hide()},_renderTab:function(){var i=this,e=0;return this.mods.each(function(a){var s,n=t(this),o=a,h=n.data("modConfig");"undefined"!=typeof h&&(h.title&&(0===o?s="first ":o===i.mods.length-1&&(s="last-col"),i.tabContainer.append(""!==s?'<li class="'+s+'" ><a hidefocus="true" href="#"><span>'+h.title+"</span></a></li>":'<li><a hidefocus="true" href="#"><span>'+h.title+"</span></a></li>")),h.key&&h.key===i.targetActivity&&(e=o))}),e?e:0}};i.add("area-detail-activity",s)});;define("page.common.face.TabGenerator",["jQuery"],function(t){var i={init:function(){this.detailInfo=t("div.mod-detail-bd"),this.detailInfoBlocks=t("div.mod-info",this.detailInfo),this.resultData=[];var i=this;this.detailInfoBlocks.each(function(){var e=t(this).data("modConfig");if(e&&e.tabConfig){var a={};a.title=e.title,a.trace=e.tabConfig.trace,a.showKey=e.tabConfig.showKey,i.resultData.push(a)}});var e={};e.result=this.resultData;var a=window.iDetailConfig;a.biztype&&"fs"===a.biztype?setTimeout(function(){t(window).trigger("generateTab",e)},1e3):t(window).trigger("generateTab",e)}};return i});;define("page.common.face.Survey",["jQuery"],function(i){var e={init:function(){var e=i('<div id="de-survey" class="de-survey"><a href="//ur.taobao.com/survey/view.htm?id=2035" class="link-survey" hidefocus="true" target="_blank">\u95ee\u5377\u8c03\u67e5</a></div>');i("body").append(e),this.div=i("div.de-survey"),this._setPosition(),this._ie6fixed(),this._bindEvent()},_setPosition:function(){var e=document.documentElement.clientWidth,t=952,o=this.div.width(),n=9,s=i("#mod-detail-bd").position().top,d=Math.floor((e-t)/2-o-n);this.div.css({top:s,right:d}).fadeIn()},_ie6fixed:function(){var e=this;i.util.ua.ie6&&(clearTimeout(this.scrollTimer),this.scrollTimer=setTimeout(function(){var i=120+document.documentElement.scrollTop+document.body.scrollTop;e.div.css("top",i)},300))},_bindEvent:function(){var e=this;i(window).on("scroll.survey",function(){e._ie6fixed()}),i(window).on("resize.survey",function(){e._setPosition()})}};return e});;define("page.common.face.Tip",["jQuery"],function(n){var i={init:function(){this.div=n("div.d-tip").parent(),this._bindEvent()},_bindEvent:function(){var i,e;this.div.each(function(t,o){var u=n(this),c=u.children("div.d-tip");u.on("mouseenter",function(){clearTimeout(e),i=setTimeout(function(){c.fadeIn(200)},200)}).on("mouseleave",function(){clearTimeout(i),e=setTimeout(function(){c.fadeOut(100)},200)})})}};return i});;define("page.ditto.face.Recommend",["jQuery","widget.ditto.plugin.SuggestOffer"],function(t,o){var e={init:function(){var o=t("#content"),e=o.length>0&&o.data("userContext")||"",i=e&&e.siteId;"officialsite"!=i&&(this._creatRoot(),this._setPosition(),this._irecom(),this._bindEvent())},_creatRoot:function(){var o;o='<div class="face-detail-recommend" data-mod-config="{&quot;isTopDomain&quot;:&quot;false&quot;,&quot;recid&quot;:&quot;9151&quot;,&quot;statScene&quot;:&quot;3&quot;,&quot;pid&quot;:&quot;819250_1008&quot;}" data-spm="1998411376">',o+='<div class="d-header">\r\n                                <h3 class="ms-yh"><span>\u4e70\u5bb6\u8fd8\u5728\u770b</span></h3>\r\n                            </div>\r\n                            <div class="d-content">\r\n                                <div class="de-irecom">\r\n                            </div>\r\n                        </div>\r\n                    </div>',t("body").append(o),this.root=t("div.face-detail-recommend"),this.irecom=t("div.de-irecom",this.root)},_setPosition:function(){var o=document.documentElement.clientWidth,e=this.root.width(),i=t(t("#mod-detail-bd").length?"#mod-detail-bd":"#mod-detail"),n=i.width(),d=i.offset().top,s=Math.floor((o-n)/2)+n;1190===n&&(s=Math.floor((o-n)/2)+n-e),this.root.css({top:d,left:s})},_irecom:function(){var e,i=this;e=new o({root:this.root,imgSize:120,count:9,subLength:120,ctrQueueCount:3,scrollType:"loop",perItem:1,isNeedDesc:"false",dmtrack:{pic:"recommend-jhd-pic",title:"recommend-jhd-title"},after:function(o){o.itemLength<=3?(t("div.page-trigger").hide(),i.irecom.addClass("no-paging"),i.root.show()):o.itemLength>3&&i.root.show()}})},_bindEvent:function(){var o=this;t(window).on("resize.recommend",function(){o._setPosition()}),t("body").on("context-render-sucess",function(){o._setPosition()})}};return e});;