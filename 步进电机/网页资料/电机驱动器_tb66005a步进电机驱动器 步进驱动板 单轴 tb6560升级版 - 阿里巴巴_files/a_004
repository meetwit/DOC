define("widget.common.plugin.SuggestOffer",["jQuery"],function(e){function i(e){this.init(e)}return window.__filterHTML=function(i){return e("<div/>").text(i).html()},i.prototype={init:function(i){if("undefined"!=typeof i&&i&&"undefined"!=typeof i.root&&i.root.length){this.container=i.root,this.children=this.container.children("div"),this.irecom=e("div.de-irecom",this.container),this.modConfig=this.container.data("modConfig")||{};var t=window.location.hostname;"undefined"==typeof window.iDetailConfig.serverInfo&&(window.iDetailConfig.serverInfo="detail.1688.com",t=window.iDetailConfig.serverInfo),this.topDomainDetailURL="//"+t+"/offer/{offerId}.html",this.recid=this.modConfig.recid,this.module=this.modConfig.module||"",this.statScene=this.modConfig.statScene,this.isOfficial=1==this.modConfig.isOfficial?!0:!1,this.pid=this.modConfig.pid,this.count=i.count||10,this.ctrQueueCount=i.ctrQueueCount||this.count,this.imgSize=i.imgSize||150,this.perItem=i.perItem||4,this.subLength=i.subLength||null,this.fitLength=i.fitLength||32,this.direction=i.direction||"left",this.scrollType=i.scrollType||"fill",this.isNeedDesc=i.isNeedDesc||"true",this.dmtrackPic=i.dmtrack.pic,this.dmtrackTitle=i.dmtrack.title,this.isMarquee=i.isMarquee||"true",this.after=i.after||function(){},"undefined"!=typeof window.iDetailConfig&&this.container.length>0&&this._loadData()}},_loadData:function(){var i=this,t=window.iDetailConfig.offerid,o=window.iDetailConfig.memberid;FE.sys.irecomTpp(this.irecom,this.__createParam(),{template:this.__createTemplate(),filter:this.count,debug:!1,statScene:this.statScene,ctrQueue:[{selector:"li",param:{object_type:"offer",uid:o,l_offerid:t},size:this.ctrQueueCount}],onTemplateReady:function(e){i.__getDetailUrl(e)},onSuccess:function(t){!("true"!==i.isMarquee)&&i._initMarquee(),i.children.show(),i.after({itemLength:e("li",i.irecom).length})},onFailure:function(){i._onFailure()}})},__getDetailUrl:function(i){var t=e.util.substitute,o=this;"undefined"==typeof window.iDetailConfig.serverInfo&&e.each(i,function(e,i){var r=i.offerDetailUrl.split("#")[1];o.topDomainDetailURL&&(i.offerDetailUrl=t(o.topDomainDetailURL,{memberId:i.memberId,postCatId:i.categoryId||1,offerId:i.offerId}),i.offerDetailUrl=r?i.offerDetailUrl+"#"+r:i.offerDetailUrl)})},__createParam:function(){var i=window.iDetailConfig,t=function(t){return e.isPlainObject(i)?i[t]||"":void 0};return{recid:this.recid,module:this.module,catids:t("catid"),offerids:t("offerid"),memberids:t("memberid")}},__createTemplate:function(){var e='<img src="<%= FE.sys.irecomTpp.getImgUrl(item,'+this.imgSize+') %>" alt="<%=__filterHTML(item.subject)%>"/>',i='<img src="//cbu01.alicdn.com/cms/upload/other/lazyload.png" data-lazy-src="<%= FE.sys.irecomTpp.getImgUrl(item,'+this.imgSize+') %>" alt="<%=__filterHTML(item.subject)%>" />',t="",o=window.iDetailConfig.offerid,r=window.iDetailConfig.memberid;return e="true"===this.isMarquee?i:e,t='<div class="de-irecom-container"><ul class="list-product">                            <%foreach ($data as item) { %>                                <li <% if (($index +1) % '+this.perItem+" === 0) { %>class=\"last-col\"<% } %> data-ctr=\"{'objectId':'<%= item.offerId %>','alg':'<%= item.alg %>'}\">                                        <dl class=\"cell-product <% if ("+this.isOfficial+') {%>cell-product-official <%}%>  ">                                            <dt class="vertical-img">                                                <a data-clickstat="{\'uid\':\''+r+"','l_offerid':'"+o+"','objectType':'offer','pid':'"+this.pid+"','objectId':'<%= item.offerId %>','alg':'<%= item.alg %>'}\" class=\"box-img\" trace=\""+this.dmtrackPic+'" href="<%= item.offerDetailUrl %>" title="<%=__filterHTML(item.subject)%>" target="_blank">                                                        '+e+"                                                </a>                                            </dt>                                            <% if ("+this.isNeedDesc+" == true) { %><dd class=\"description\"><a data-clickstat=\"{'objectType':'offer','pid':'"+this.pid+"','objectId':'<%= item.offerId %>','alg':'<%= item.alg %>'}\" trace=\""+this.dmtrackTitle+'" href="<%= item.offerDetailUrl %>" title="<%=__filterHTML(item.subject)%>" target="_blank"><%= FE.sys.irecomTpp.fitLength(__filterHTML(item.subject),'+this.fitLength+') %></a></dd><% } %>                                            <dd class="price"><%= FE.sys.irecomTpp.getPrice(item,0) %></dd>                                            <% if (item.cornerMarkUrl) { %>                                            <dd class="corner"><img src="<%= item.cornerMarkUrl %>" /></dd>                                            <% } %>                                        </dl>                                </li>                            <% } %>                            </ul></div>'},_initMarquee:function(){var i=e("a.paging",this.container),t=i.eq(0),o=i.eq(1),r=[0],n=[],a=this;e.use("ui-tabs-lazyload, ui-tabs-effect",function(){var i=a.irecom.children("div.de-irecom-container").tabs({isAutoPlay:!1,boxSelector:"li",effect:"scroll",scrollType:a.scrollType,subLength:a.subLength,perItem:a.perItem,direction:a.direction,isPreLoad:!0}),s=i.tabs("length");i.on("tabsshow",function(e,i){"loop"!==a.scrollType&&(o.toggleClass("next-g",i.index===s-1),o.toggleClass("next",i.index!==s-1),t.toggleClass("previous-g",0===i.index),t.toggleClass("previous",0!==i.index)),-1===r.indexOf(i.index)&&(n=a._sniffNode(i.box.slice(0,a.statScene)),a._ctrRequest(n),r.push(i.index))}),a.container.on("click","a.paging",function(t){t.preventDefault();var o=e(this);o.hasClass("previous")?i.tabs("prev"):o.hasClass("next")&&i.tabs("next")})})},_onFailure:function(){var i=e("a.paging",this.container);i.hide()},_sniffNode:function(i){var t,o=[],r=this;return e.each(i,function(i,n){t=r._parseObj(e(n).data("ctr")),e.isPlainObject(t)||(t={objectId:"",alg:""}),o.push((t.objectId||"")+","+(t.alg||""))}),o},_ctrRequest:function(e){var i,t={},o=[],r="undefined"==typeof window.unique_pageid?-1:window.unique_pageid,n=Object.prototype.hasOwnProperty;t.object_type="offer",t.object_ids=e.join(";"),t.page_area=this.recid,t.ctr_type=this.statScene,t.page_id=r;for(i in t)n.call(t,i)&&o.push(i+"="+t[i]);o=o.join("&"),(new Image).src="//gm.mmstat.com/ctr.1688.2?gokey="+encodeURIComponent(o)},_parseObj:function(e){try{return"object"==typeof e?e:new Function("return "+e)()}catch(i){return{}}}},i});;define("widget.common.plugin.CartView",["jQuery","widget.common.plugin.SuggestOffer","Util","global.util.everlog","sys/purchaselist/v1/core","sys/logist/1.0"],function(t,i,e,a,o,s){var r=location.href.indexOf("_debugMode_=1")>-1,n=function(i,e){this.config=e,this.dialog=i,this.domTip=t("div.d-cart",this.dialog),this.dialogTitle=t("h3",this.dialog);var a=this;t.getScript("//astyle.alicdn.com/app/tempo/js/box/promotion/dacu/purchase-lottery.js?_t="+(new Date).getTime(),function(){var t=a.isActivityState();t&&jQuery("body").trigger("startLotteryPurchase",{scenes:"power"===t?t:"",activityId:window.iDetailConfig.officialActivityId})})};return t.extend(n.prototype,{activate:function(i){this._onPurchaseLoading(this.dialog);try{detail.trigger("loggerEvent",["addCart","Request"])}catch(e){}var a=this;t.ajax(i,{dataType:"script",scriptCharset:"gb2312",success:function(){var t=window.addToPurchaseListResult;a.onSuccess(t)},error:function(){a.onFailure()},timeout:2e4})},activateBatch:function(i,e){var a=t.guid++,o=Object.prototype.hasOwnProperty,s=t("<div>",{"class":"d-sku-batch-purchase-request"}).appendTo(document.body).html('<form action="'+this.config.purchaseListUrl+'" method="post" target="proxy'+a+'"></form><iframe width="0" height="0" frameborder="0" name="proxy'+a+'" src="about:blank"></iframe>'),r=t("form",s),n=t("iframe",s),c=this;for(var l in i)if(o.call(i,l)){var u=t("<input>",{type:"hidden",name:l,value:i[l]});r.append(u)}this._onPurchaseLoading(this.dialog),n.bind("load",function(i){try{if("about:blank"===this.contentWindow.location.href||this.contentWindow.location.host!==location.host)return;window.addToPurchaseListResult=t.unparam(this.contentWindow.location.href),c.onSuccess(window.addToPurchaseListResult)}catch(e){c.onFailure()}}),r.submit()},activatePurchaselist:function(t){var i=this;this._onPurchaseLoading(this.dialog),o.View.addToPurchase({params:t,success:function(t){i.onSuccess(t)},error:function(t,i){that.onFailure()}})},onSuccess:function(t){if(t){"Alibar"in FE.sys&&FE.sys.Alibar.purchaselistRefresh();try{detail.trigger("loggerEvent",["addCart","Done"])}catch(i){}this._render(t)}else this.onFailure()},onFailure:function(){var t=this.domTip;t&&(t.html('<div class="cart-wrap cart-timeout"><h4>\u62b1\u6b49\uff0c\u7f51\u7edc\u7e41\u5fd9\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01</h4></div>'),this.dialogTitle.text("\u6dfb\u52a0\u5931\u8d25"))},_render:function(i){var e=this.domTip,o="",s=this;if(t.isPlainObject(i)||this.onFailure(),"true"===i.success||i.success===!0)if("orderPurchase"===this.type)FE.util.goTo(this.orderConfig.viewPurchaseListURL,"_self");else{o=this.getPurchaseSuccessTemplate({quantity:i.quantity,total:parseFloat(i.total).toFixed(2),viewPurchaseListURL:this.config.viewPurchaseListURL,dmtViewPurchase:this.config.dmtViewPurchase,dmtGoShopping:this.config.dmtGoShopping,viewCouponURL:i.applyCouponUrl,isNeedShowCoupons:i.isNeedShowCoupons}),e.html(o),this.checkCoupon(),this.dialogTitle.text("\u6dfb\u52a0\u6210\u529f"),e.show(),this._emptyCartView();try{a.info("addOrderSuccess")}catch(r){}}else if("PURCHASE_OVER_FLOW_ERROR"===i.code){e.html(this.getPurchaseFailureOverFlowTemplate({quantity:i.quantity,addQuantity:i.add_quantity,viewPurchaseListURL:this.config.viewPurchaseListURL,msg:i.msg})),this.dialogTitle.text("\u6dfb\u52a0\u5931\u8d25"),e.show();try{a.info("addOrderFailure")}catch(r){}}else if("PLEASE_LOGIN_BEFORE_ADD"===i.code)this.dialogTitle.text("\u6dfb\u52a0\u5931\u8d25"),e.html('<div class="cart-wrap cart-info"><h4>\u767b\u9646\u4fe1\u606f\u5931\u6548\uff0c\u8bf7\u91cd\u65b0\u767b\u9646\u540e\u518d\u6b21\u6dfb\u52a0</h4></div>').show(),setTimeout(function(){s._popup(),s.dialog.dialog("close")},2e3);else{e.html(this.getPurchaseFailureTemplate({msg:i.msg})),this.dialogTitle.text("\u6dfb\u52a0\u5931\u8d25"),e.show();try{a.info("addOrderFailure")}catch(r){}}this._purchaseCloseEvent(this.dialog),this._irecom()},checkCoupon:function(){var t=this.isActivityState();if(t){try{jQuery("body").trigger("startLotteryPurchase",{selector:".activity-opration",detail:!0,scenes:"power"===t?t:"",activityId:window.iDetailConfig.officialActivityId})}catch(i){}try{a.info("isActivityCoupon")}catch(i){}}},isActivityState:function(){return r?(console.debug("[DEBUG] \u5f3a\u5236\u5f00\u542f\u62bd\u5956"),!0):window.iDetailData.isSourcePromotion&&window.iDetailData.hasPurcharseMark},getPurchaseSuccessTemplate:function(t){var i,e=this.config.purchaseType,a="consign_purchase_type"===e?"\u4ee3\u9500\u8fdb\u8d27\u5355":"\u8fdb\u8d27\u5355";return i='<div class="cart-wrap"><h4><em>\u8d27\u54c1\u5df2\u6dfb\u52a0\u5230'+a+"\uff01</em></h4><p>\u5f53\u524d"+a+'\u5171<span class="value">'+t.quantity+'</span>\u79cd\u8d27\u54c1</p><div class="opration"><span><a trace="viewcart1" class="btn btn-orange view-cart" href="'+t.viewPurchaseListURL+'" target="_blank">\u53bb\u7ed3\u7b97</a></span><span><a class="long-buy" trace="goonpurchase1" href="#" target="_self">\u7ee7\u7eed\u8d2d\u7269</a></span></div>',i+='<div class="activity-opration"></div>',i+="</div>"},getPurchaseFailureOverFlowTemplate:function(t){var i='<div class="cart-wrap cart-error"><h4>'+t.msg+'</h4><p>\u60a8\u8fdb\u8d27\u5355\u4e2d\u7684\u8d27\u54c1\u79cd\u7c7b\u4e3a<span class="value">'+parseInt(t.quantity,0)+'</span>\u79cd</p><div class="opration"><span><a trace="viewcart1" class="btn btn-orange view-cart" href="'+t.viewPurchaseListURL+'" target="_blank">\u53bb\u7ed3\u7b97</a></span><span><a trace="goonpurchase1" class="long-buy" href="#" target="_self">\u7ee7\u7eed\u8d2d\u7269</a></span></div></div>';return i},getPurchaseFailureTemplate:function(t){var i='<div class="cart-wrap cart-timeout"><h4>\u52a0\u5165\u8fdb\u8d27\u5355\u5931\u8d25\uff01</h4><p>'+t.msg+"</p></div>";return i},getLotteryTemplate:function(){var t='<div class="lottery-wrap"><a class="btn-lottery" href="#" trace="offer_detail_lottery" rel="nofollow">\u5f00\u59cb\u62bd\u5956</a><p class="lottery-desc">\uff08\u6d77\u91cf\u7ea2\u5305\u7b49\u4f60\u62ff\uff01\uff09</p><p class="lottery-warning">\u672a\u7ed1\u5b9a\u652f\u4ed8\u5b9d\u5c06\u62bd\u4e0d\u5230\u7ea2\u5305\u3002</p></div>';return t},_hasLottery:function(){var t=!1;return t=!0},_bindLotteryEvent:function(){var i=t("a.btn-lottery",this.domTip);this.dialog.addClass("d-has-lottery"),i.on("click",function(i){i.preventDefault(),FE.operation&&FE.operation.promotion?FE.operation.promotion.module.lottery():t.getScript("//static-src.alicdn.com/js/app/operation/dacu/14-321/module/lottery.js",function(){t.loadCSS("//astyle.alicdn.com/sys/css/dpl/dpl-merge.css",function(){FE.operation.promotion.module.lottery()})})})},_purchaseCloseEvent:function(i){t("a.long-buy",i).on("click",function(t){t.preventDefault(),i.dialog("close")}),t("a.view-cart",i).on("click",function(){i.dialog("close")}),t("a.coupon",i).on("click",function(){i.dialog("close")}),t("a.close-btn",i).on("click",function(t){t.preventDefault(),i.dialog("close")}),t("a.btn-lottery",i).on("click",function(t){t.preventDefault(),i.dialog("close")})},_irecom:function(){this.irecom=t("div.mod-detail-purchase-irecom",this.dialog);new i({root:this.irecom,imgSize:100,subLength:111,ctrQueueCount:4,dmtrack:{pic:"recommend-jhd-pic",title:"recommend-jhd-title"}})},_onPurchaseLoading:function(i){var e=this;i.length&&(t("div.d-cart",i).html('<div class="cart-wrap cart-loading"><img src="//cbu01.alicdn.com/images/app/detail/public/loading.gif"/></div>'),t.use("ui-dialog, ui-draggable",function(){i.dialog({fixed:!0,modal:!1,fadeOut:200,draggable:{handle:"div.dialog-tit"},css:{left:(t(window).width()-124)/2,top:(t(window).height()-300)/2}}),e._purchaseCloseEvent(i)}))},_resetPurchaseDialog:function(i){var e=t("div.dialog-tit h3",i),a=t("div.mod-detail-purchase-irecom > div",i),o=t("a.paging",i);e.text("\u6dfb\u52a0\u4e2d..."),o.eq(0).toggleClass("previous",!1).toggleClass("previous-g",!0),o.eq(1).toggleClass("next",!0).toggleClass("next-g",!1),a.hide()},_emptyCartView:function(){t(window).trigger("emptyCartView")},_popup:function(t,i,e,a){s.init({source:"offerDetail_createOrder",onLoginSuccess:function(){s.hide()},onRegistSuccess:function(){this.onLoginSuccess()}})}}),n});;define("widget.ditto.plugin.AmountControl",["jQuery"],function(t){function i(){this.init.apply(this,arguments)}return i.prototype={init:function(i,a,o,e){this.div=t("div.unit-detail-amount-control",i),this.config=a?a:{},this.amountValue=0,this.amountNode=t("input.amount-input",this.div),this.amountUpNode=t("a.amount-up",this.div),this.amountDownNode=t("a.amount-down",this.div),this.validator=o,this.amountInputHandle(),this.amountOffset(),this.reg=/^[0-9]+\d*$/,this.callback=e?e:function(){},this.hoverCallback=function(){},this._hoverEvent()},_hoverEvent:function(){var i=this;this.amountUpNode.hover(function(){var a=t(this);a.hasClass("amount-up-limit")||i.div.addClass("unit-detail-amount-control-hover")},function(){i.div.removeClass("unit-detail-amount-control-hover")}),this.amountDownNode.hover(function(){var a=t(this);a.hasClass("amount-down-limit")||i.div.addClass("unit-detail-amount-control-hover")},function(){i.div.removeClass("unit-detail-amount-control-hover")}),this.amountNode.hover(function(){i.div.addClass("unit-detail-amount-control-hover")},function(){i.div.removeClass("unit-detail-amount-control-hover")})},_limitedTest:function(t,i){var a=0,o=0,e=this.config.wsRuleNum?1*this.config.wsRuleNum:1;t&&(o=t.valid(1*i-1*e,"blur",!0),a=t.valid(1*i+1*e,"blur",!0),40!==o&&20!==o?this.amountDownNode.addClass("amount-down-limit"):this.amountDownNode.removeClass("amount-down-limit"),40!==a&&30!==a?this.amountUpNode.addClass("amount-up-limit"):this.amountUpNode.removeClass("amount-up-limit"))},amountInputHandle:function(){var i=/^[0-9]+\d*$/,a="",o=this.amountNode,e=this;this.validator&&this._limitedTest(this.validator,1*this.amountNode.val()),o.keyup(function(){var o=t(this),n=o.val(),l=e.activateValidator(n);if(n)if(i.test(n))if(20!==l&&1!==l&&2!==l)40===l?(t(window).trigger("updateAmount",n),e.callback.call(e,n,!0)):e.callback.call(e,n,!1),a=n;else if(20===l){var u=1*e.validator.max;o.val(u),t(window).trigger("updateAmount",u),e.callback.call(e,u,!0),e.showOverflowTips(u)}else e.callback.call(e,n,!1);else o.val(a);else a=""}),o.blur(function(){var i,a,o=t(this),n=e.config.wsRuleNum?1*e.config.wsRuleNum:1;i=t.trim(o.val())?parseInt(o.val()):0,e.config.wsRuleNum&&i%e.config.wsRuleNum!==0&&(i=Math.floor(i/e.config.wsRuleNum)*e.config.wsRuleNum,i+=n),o.val(i),a=e.activateValidator(i),40===a?(t(window).trigger("updateAmount",i),e.callback.call(e,i,!0)):e.callback.call(e,i,!1)})},amountOffset:function(){var i=this.amountUpNode,a=this.amountDownNode,o=this.amountNode,e=this.config.wsRuleNum?1*this.config.wsRuleNum:1,n=this;i.click(function(i){i.preventDefault();var a,l=o.val(),u=parseInt(l);t.trim(l)&&n.reg.test(u)&&(n.config.wsRuleNum&&u%n.config.wsRuleNum!==0&&(u=Math.floor(u/n.config.wsRuleNum)*n.config.wsRuleNum),u+=e,a=n.activateValidator(u),40===a?(o.val(u),t(window).trigger("updateAmount",u),n.callback.call(n,u,!0)):30===a?(u=1*n.validator.min,o.val(u),t(window).trigger("updateAmount",u),n.callback.call(n,u,!0)):n.callback.call(n,u,!1))}),a.click(function(i){i.preventDefault();var a,l=o.val(),u=parseInt(l);t.trim(l)&&n.reg.test(u)&&(n.config.wsRuleNum&&u%n.config.wsRuleNum!==0&&(u=(Math.floor(u/n.config.wsRuleNum)+1)*n.config.wsRuleNum),u-=e,0>u&&(u=0),a=n.activateValidator(u),40===a?(o.val(u),t(window).trigger("updateAmount",u),n.callback.call(n,u,!0)):20===a?(u=1*n.validator.max,o.val(u),t(window).trigger("updateAmount",u),n.callback.call(n,u,!0)):n.callback.call(n,u,!1))})},setAmountValue:function(t){this.amountValue=t,this.amountNode.val(t),this._limitedTest(this.validator,t)},getAmountValue:function(){return this.amountNode.length>0?this.amountNode.val():this.amountValue},setPriceValue:function(t){this.priceValue=t},getPriceValue:function(){var i;return i=this.priceValue?this.priceValue:t("div.mod-detail-price").length?"true"===window.iDetailConfig.isLadderGroup?this.getAmountValue()*t("div.mod-detail-price").data("modConfig").currentPrice*1:this.getAmountValue()*this.getCurrentPrice()*1:this.getAmountValue()*window.iDetailConfig.refPrice*1},getCurrentPrice:function(){var i=t("div.mod-detail-price .unit-detail-price-amount tr"),a=1*this.getAmountValue(),o=[],e=window.iDetailConfig.refPrice;if(i.each(function(){var i=t(this),a=i.data("range"),e={begin:a.begin,price:a.price};o.push(e)}),o.length){e=o[0].price;for(var n=o.length;n>0;n--)if(a>=1*o[n-1].begin){e=o[n-1].price;break}}return e},setValidator:function(t){this.validator=t},getValidator:function(){return this.validator},attachValue:function(){this.amountNode.blur()},activateValidator:function(t){var i=40;return null===t&&(t=this.getAmountValue()),this.validator&&(this._limitedTest(this.validator,t),i=this.validator.valid(t,"blur")),i},setCallback:function(t){"function"==typeof t&&(this.callback=t)},setHoverCallback:function(t){"function"==typeof t&&(this.hoverCallback=t)},showOverflowTips:function(t){var i=this,a='<div class="overflow-tips">\u6700\u5927\u8d2d\u4e70\u91cf'+t+window.iDetailConfig.unit+"</div>",o=i.div.parents(".obj-content");o.length>0&&(o.addClass("overflow-inherit"),o.find(".overflow-tips").remove()),0==i.div.find(".overflow-tips").length&&i.div.append(a),i.overflowTimerId&&window.clearTimeout(i.overflowTimerId),i.overflowTimerId=setTimeout(function(){i.div.find(".overflow-tips").fadeOut(function(){this.remove()})},1e3)}},i});;define(["jQuery","ModContext","Log","Util","widget.ditto.plugin.AmountControl","widget.common.plugin.OrderValidator","widget.ditto.plugin.OrderButton","widget.ditto.plugin.CreditBuy","widget.common.plugin.SpecOperator","widget.common.plugin.CartView","widget.ditto.plugin.Qrcode","alicn/aliuser/1.0","global.util.everlog","widget.ditto.purchasing.default.parts.orderCache"],function(t,i,e,a,n,s,o,r,u,c,l,h,d,p){var f={init:function(t,i,e,a,n){this._initDoms(t),this._initVariable(i,n),this._initFlow(),this._bindEvent();try{__WPO&&"function"==typeof __WPO.speed&&__WPO.speed(iDetailConfig.offerid&&"5"===iDetailConfig.offerid.slice(-1)?2:1)}catch(s){}},_initDoms:function(i){this.div=i,this.objLeading=t("div.obj-leading",this.div),this.objSku=t("div.obj-sku",this.div),this.objList=t("div.obj-list",this.div),this.objOrder=t("div.obj-order",this.div),this.tip=t("div.tip",this.div),this.purchaseBtn=t("a.do-purchase",this.objOrder),this.cartBtn=t("a.do-cart",this.objOrder),this.cartDialog=t("div.purchase-dialog",this.objOrder),this.rows=t("tbody tr",this.objSku),this.tableList=t("table.table-list",this.objList)},_initVariable:function(i,e){this.config=i,this.faceConfig=e,this.config.unit=e.unit,this.config.offerId=e.offerid,this.config.memberId=e.memberid,this.config.isTopDomain=e.isTopDomain,this.skuRawData=window.iDetailData.sku,this.skuRawMap=this.skuRawData?this.skuRawData.skuMap:{},this.promotionDiscountRange=this.skuRawData?this.skuRawData.promotionDiscountRange:{},this.skuRawProp=this.skuRawData?this.skuRawData.skuProps:[],this.listOperators={},this.specOperators={},this.specSelectionStack=[],this.listSelectionStack=[],this.currentSpec={},this.skuSubmitData=[];var n=this;this.app={getSkuSubName:function(i){return t.util.escapeHTML(i)},getSkuSubTotal:function(t){var i=n.specSelectionStack[t].obj.getData(),e=0;for(var s in i)i[s].amount&&1*i[s].amount>0&&(e+=1*i[s].amount);return n.specSelectionStack[t].total=e,a.roundingSep(e)},getUnit:function(){return n.faceConfig.unit}},"daixiao"==window.iDetailConfig.pageType&&(this.skuRawData.priceRange&&(this.skuRawData.priceRange.length=1),this.skuRawData.priceRangeOriginal&&(this.skuRawData.priceRangeOriginal.length=1))},_initFlow:function(){var t={};t.purchaseBtn=this.purchaseBtn,t.cartBtn=this.cartBtn,this.validator=new s(this.config,this.tip),this.creditBuy=new r(this.div,this.config,this),this.amountControl=new n(this.objOrder,this.config,this.validator),this.orderButton=new o(t,this.amountControl,this.validator,this.config),this.orderButton.goPurchase(this.processPurchase,this),this.orderButton.goCart(this.processCart,this),this.cartView=new c(this.cartDialog,this.config),2===this.skuRawProp.length?this._initSpec():1===this.skuRawProp.length&&(this._initEmptySpec(),this._initSwitchPreview())},_bindEvent:function(){var i=this,e=t("div.list-selected",this.div),a=this.config.externalEvent;t("a.link-list",this.objList).on("click",function(e){e.preventDefault();var a=t(this).parent();a.toggleClass("list-selected-expand").css("z-index","108"),i.tableList.height()>330&&t("div.list-info",i.objList).addClass("scroll-y")}),t("body").on("mouseup",function(i){var a=t(i.target);0===a.closest("div.list-selected").length&&e.removeClass("list-selected-expand").css("z-index","1")}),this._bindExpandEvent(),a&&t(window).on(a+"done",function(){i._processPurchase()}),t(window).on("emptyCartView",function(){i.emptyCartView()}),this.div.on("click",".dis-to-taobao",function(i){i.preventDefault(),t(window).trigger("distributeTotaobaoEvent")})},_initSpec:function(){var i=t("div.unit-detail-spec-operator",this.div),e=!1,a=this;i.each(function(i){var n={},s=t(this).data("unitConfig").name;n=new u(a._fetchSkuData,t(this),function(t,i){a.chooseSpec(t,a.rows,this,i)}),n.setOutStock(a._testOutStock(n.getData())),n.isOutStock()||e||(n.setSelected(!0),e=!0),a.specOperators[s]=n})},_initEmptySpec:function(){var t=this,i=new u(this._fetchSkuData,null,function(i,e){t.chooseSpec(i,t.rows,this,e)});i.setSelected(!0),this.specOperators[""]=i},chooseSpec:function(i,e,a,n){var s=a.getData(),o=this;e.each(function(i){var r=t(this),u=r.data("skuConfig"),c=t("img",r);setTimeout(function(){o._loadImage(c,t("span.image",r))},200),"undefined"==typeof s[u.skuName]&&(s[u.skuName]={},s[u.skuName].canBookCount=0,s[u.skuName].discountPrice="",s[u.skuName].price=""),o._renderSkuSpec(s,r,i,n),1*s[u.skuName].canBookCount===0?(t("td.amount div.control",r).hide(),t("td.amount span.no-control",r).show()):(t("td.amount div.control",r).show(),t("td.amount span.no-control",r).hide()),r.data("skuConfig").max=1*s[u.skuName].canBookCount,o._initSpecAmountControl(r,e,a,i)}),this.currentSpec=a},_loadImage:function(t,i){var e=t,a=e.attr("data-lazy-src");e.length<=0||a&&e.attr("src")!==a&&e.attr("src",a)},_renderSkuSpec:function(i,e,n,s){var o=80,r=e.data("skuConfig"),u=t("td.price span",e),c=t("td.count span",e),l=this;s||t.util.ua.ie6?(i[r.skuName].discountPrice&&""!==i[r.skuName].discountPrice?t("em.value",u).html(a.roundingPriceSep(i[r.skuName].discountPrice)):"true"!==l.faceConfig.isRangePriceSku&&t("em.value",u).html("--"),t("em.value",c).html(i[r.skuName].canBookCount)):setTimeout(function(){t("td.name span",e).slideUp(o,function(){t(this).slideDown(o),u.slideUp(o,function(){t(this).slideDown(o),i[r.skuName].discountPrice&&""!==i[r.skuName].discountPrice?t("em.value",t(this)).html(a.roundingPriceSep(i[r.skuName].discountPrice)):"true"!==l.faceConfig.isRangePriceSku&&t("em.value",t(this)).html("--"),t("em.value",c).slideUp(o,function(){t(this).slideDown(o),t(this).html(i[r.skuName].canBookCount)})}),window.iDetailConfig&&"weigong"===window.iDetailConfig.pageType&&u&&0===u.length&&t(l.div).parent(".mod-detail-micro-supply-purchasing").length>0&&t("em.value",c).slideUp(o,function(){t(this).slideDown(o),t(this).html(i[r.skuName].canBookCount)})})},o*n)},_fetchSkuData:function(t){var i,e=window.iDetailData.sku,a=e.skuMap,n=e.skuProps,s={},o={};if(n&&a)if(1===n.length)s=a;else if(2===n.length)for(var r=0;r<n[1].value.length;r++)i=t+"&gt;"+n[1].value[r].name,o=a[i],o&&(s[n[1].value[r].name]=o);return s},_initSpecAmountControl:function(i,e,a,o){function r(i,e){var a=h.isLogin();if(a){var n=i._countTotal().price;n>0?t.ajax({url:"//fa.1688.com/commission/simulate/site.jsonp",data:{sceneCode:i.config.sceneCode,offerId:i.config.offerId,price:100*n},dataType:"jsonp",success:function(t){if(!t.hasError){var i=(t.content.rebate/100).toFixed(2);i>0&&e.removeClass("fd-hide").find(".profit-value").text(i+"\u5143")}}}):e.addClass("fd-hide")}}var u=i.data("skuConfig"),c=(t("td",i),t("<div></div>")),l={},d={},p=this;"undefined"==typeof this.listOperators[u.skuName]?(u.unit=this.faceConfig.unit,u.offerId=this.faceConfig.offerid,u.memberId=this.faceConfig.memberid,l=new s(u,c),d=new n(i,u,l),this.listOperators[u.skuName]=d):(this.listOperators[u.skuName].getValidator().setConfig(u),d=this.listOperators[u.skuName]),d.setCallback(function(i,e){if(e){var n=a.getData(),s=0;1*i>0?n[u.skuName].amount=i:delete n[u.skuName].amount;for(var o in n)n[o].amount&&(s+=n[o].amount);s>0?a.addCompleted():a.removeCompleted(),p._updateSkuList(a,u.skuName),p._updateTotal();var c=t("p.profit",".list-total"),l=t(".list-total").data("fanli");l&&(clearTimeout(r.tid),r.tid=setTimeout(function(){r(p,c)},500)),a.node&&t(window).trigger("switchPreview",[a.node,!0])}});var f=a.getData()[u.skuName].amount;d.setAmountValue(f?f:0),d.activateValidator(f?f:0)},_testOutStock:function(t){var i=0;for(var e in t)t[e].canBookCount&&(i+=1*t[e].canBookCount);return 0===i?!0:!1},_updateTotal:function(){var i,e=t("div.list-total",this.objList),n=t("p.amount span.value",e),s=t("p.price span.value",e),o={};this._triggerExpandEvent(),o=this._countTotal(),this._reRenderSkuSpec(),o.amount>0&&(t(window).trigger("updateAmount",[o.amount,o.price]),detail.trigger("updateTabAmount",[o.amount,o.price]),detail.trigger("updateAmountPrice",[o.amount,o.price])),this.amountControl.setAmountValue(o.amount),this.amountControl.setPriceValue(o.price),n.text(a.tenThousandSep(o.amount)),s.text(a.tenThousandSep(o.price,!0)),this.totalAmount=o.amount,this.config.limitCount&&this.validator.valid(this.totalAmount),this.promotionDiscountRange&&this.promotionDiscountRange.length>0&&(i=e.find("p.price").find("span.originPrice"),0===i.length&&e.find("p.price").append('<span class="originPrice"></span>'),e.find("span.originPrice").html("(\u539f\u4ef7\uff1a<del>"+a.tenThousandSep(o.originPrice,!0)+"\u5143</del>)"));try{p.setSkuData(this.skuSubmitData)}catch(r){console.log(r)}},_countTotal:function(){var i=this.skuRawData.priceRange,e=this.skuRawData.priceRangeOriginal,a=0,n=0;this.skuSubmitData=[];for(var s in this.specOperators){var o=this.specOperators[s];if(o instanceof u){var r=o.getData();for(var c in r)r[c].amount&&(a+=1*r[c].amount,this.skuSubmitData.push({specId:r[c].specId,amount:1*r[c].amount}),r[c].discountPrice&&""!==r[c].discountPrice&&(n+=r[c].discountPrice*r[c].amount*1))}}if("true"===this.faceConfig.isRangePriceSku&&"daixiao"!=window.iDetailConfig.pageType||"true"===this.faceConfig.isRangePriceSku&&"daixiao"==window.iDetailConfig.pageType&&"true"!=window.iDetailConfig.hasConsignPrice){n=0;for(var s in this.specOperators){var o=this.specOperators[s];if(o instanceof u){var r=o.getData();for(var c in r)this.specOperators[s].getData()[c].discountPrice=this._determineRangePrice(i,a),this.specOperators[s].getData()[c].price=this._determineRangePrice(e,a),r[c].amount&&r[c].discountPrice&&""!==r[c].discountPrice&&(n+=1*r[c].discountPrice*r[c].amount)}}}if(this.promotionDiscountRange){for(var l,h=this.promotionDiscountRange,d=n,p=0;p<h.length;p++)n>=h[p].amountAt&&(l=h[p]);l.discount?n*=l.discount/10:l.decrease&&(n-=l.decrease*a)}if(i||e){var f=i?i:e;t("#mod-detail-price").find(".highlight-price").removeClass("highlight-price"),a>0&&this._highlightPrice(f,a)}return{amount:a,price:n,originPrice:d}},_determineRangePrice:function(t,i){if(t&&t.length)for(var e=0;e<t.length;e++){if(0===e&&i<t[e][0])return t[e][1];if(e<t.length-1&&i>=t[e][0]&&i<t[e+1][0])return t[e][1];if(e===t.length-1&&i>=t[e][0])return t[e][1]}},_reRenderSkuSpec:function(){var i=this;this.rows.each(function(){{var e=t(this),n=e.data("skuConfig"),s=i.currentSpec.getData()[n.skuName]?i.currentSpec.getData()[n.skuName]:{},o=t("td.price span",e);t("td.count span",e)}s.discountPrice&&""!==s.discountPrice?t("em.value",o).html(a.roundingPriceSep(s.discountPrice)):"true"!==i.faceConfig.isRangePriceSku&&t("em.value",o).html("--")})},_updateSkuList:function(t,i){t.getName();this.tableList.html(""),2===this.skuRawProp.length?(this._getSpecSelectionStack(t),this._renderSpecSelection()):1===this.skuRawProp.length&&(this._getListSelectionStack(t,i),this._renderListSelection())},_getSpecSelectionStack:function(i){var e=i.getName(),a=!1;t.each(this.specSelectionStack,function(t,i){i.name===e&&(a=!0)}),a||this.specSelectionStack.push({name:e,obj:i})},_getListSelectionStack:function(i,e){var a=i.getData(),n=!1;t.each(this.listSelectionStack,function(t,i){i.name===e&&(n=!0)}),n||this.listSelectionStack.push({name:e,obj:a[e]})},_renderSpecSelection:function(){var t='<% for (var i = 0; i < $data.length; i++) { %><% var subData = $data[i].obj.data; %><tr <% if ($data.length-1==i){ %>class="last-row"<% } %> data-name="<%= $data[i].name %>"><td class="prop"><%= $data[i].name %></td><td class="amount"><span class="value"><%= this.getSkuSubTotal(i) %></span><span class="unit"><%= this.getUnit() %></span></td><td class="desc"><ul><% for (var skuSubName in subData){ %><% if (subData[skuSubName].amount && subData[skuSubName].amount * 1 > 0){ %><li data-sku-config=\'{"skuName":"<%= this.getSkuSubName(skuSubName) %>","max":"<%= subData[skuSubName].canBookCount %>","amount":"<%= subData[skuSubName].amount %>"}\'><span class="name"><%= skuSubName %></span><span class="no-control">\uff08<em class="value"><%= subData[skuSubName].amount %></em>\uff09</span><div class="control fd-hide"><div class="unit-detail-amount-control unit-detail-amount-control-small"><a target="_self" href="#" class="amount-down" trace="offerdetail_click_itemlist_quantity" hidefocus="true" rel="nofollow">-</a><input type="text" maxlength="10" name="" class="amount-input" value="0"><a target="_self" href="#" class="amount-up" trace="offerdetail_click_itemlist_quantity" hidefocus="true" rel="nofollow">+</a></div></div></li><% } %><% } %></ul> </td></tr><% } %>',i="";i=FE.util.sweet(t).applyData(this.specSelectionStack,this.app),this.tableList.html(i),this.objList.show(),this._initSkuListControl()},_renderListSelection:function(){var t='<% for (var i = 0; i < $data.length; i++) { %><% var subData = $data[i].obj; %><tr <% if ($data.length-1==i){ %>class="last-row"<% } %> data-name="<%= $data[i].name %>"><td class="prop"><%= $data[i].name %></td><td class="desc"><ul><% if (subData.amount && subData.amount * 1 > 0){ %><li class="simple" data-sku-config=\'{"skuName":"<%= this.getSkuSubName($data[i].name) %>","max":"<%= subData.canBookCount %>","amount":"<%= subData.amount %>"}\'><span class="no-control">\uff08<em class="value"><%= subData.amount %></em>\uff09<span class="unit"><%= this.getUnit() %></span></span><div class="control fd-hide"><div class="unit-detail-amount-control unit-detail-amount-control-small"><a target="_self" href="#" class="amount-down" trace="offerdetail_click_itemlist_quantity" hidefocus="true" rel="nofollow">-</a><input type="text" maxlength="10" name="" class="amount-input" value="0"><a target="_self" href="#" class="amount-up" trace="offerdetail_click_itemlist_quantity" hidefocus="true" rel="nofollow">+</a></div></div></li><% } %></ul></td></tr><% } %>',i="";i=FE.util.sweet(t).applyData(this.listSelectionStack,this.app),this.tableList.html(i),this.objList.show(),this._initSkuListControl()},_initSkuListControl:function(){var i=t("li",this.tableList),e=this;i.each(function(i){var a=t(this),o=t.extend({},e.config,a.data("skuConfig")),r=a.closest("tr"),u=r.data("name"),c=t("td.amount span.value",r),l=t("span.no-control em.value",a),h=e.specOperators[u]||e.specOperators[""],d=1*o.amount,p=new s(o,{}),f=new n(a,o,p);f.setAmountValue(d),f.attachValue(),f.setCallback(function(t,i){if(i){var a=0;1*t>0?h.getData()[o.skuName].amount=1*t:delete h.getData()[o.skuName].amount;for(var n in h.getData())h.getData()[n].amount&&1*h.getData()[n].amount>0&&(a+=1*h.getData()[n].amount);l.text(t),c.text(a),e._updateTotal()}}),e._handleEditBox(a)})},_handleEditBox:function(i){var e,a=(t("span.no-control",i),this);i.hover(function(){var i=t(this);e=setTimeout(function(){t("span.no-control",i).hide(),t("div.control",i).show()},200)},function(){var i=t(this);clearTimeout(e),t("div.control",i).hide(),t("span.no-control",i).show(),a.currentSpec.setSelected(!0)})},processPurchase:function(){var i=this.config.externalEvent;i?t(window).trigger(i):this._processPurchase()},_processPurchase:function(){var i={},e=[],n={sceneCode:this.config.sceneCode||""},s=this;try{detail.trigger("loggerEvent",["purchase","Done"])}catch(o){}"daixiao"==window.iDetailConfig.pageType&&(n.sceneCode=""),"true"===this.config.isUseFlow?(t.each(this.skuSubmitData,function(t,i){e.push({flow:s.config.flow,offerId:s.config.offerId,quantity:i.amount,specId:i.specId,ext:JSON.stringify(n)})}),i={flow:"xxx",id:JSON.stringify(e)}):i={offerId:this.config.offerId,sellerMemberId:this.config.memberId,specData:JSON.stringify(this.skuSubmitData),ext:JSON.stringify(n)},r.handleMergeData&&r.handleMergeData(this.creditBuy,i),a.submit(this.config.orderUrl,i)},processCart:function(){var i={sceneCode:this.config.sceneCode||""},e=this.config._csrf_token;"true"==this.config.isTopDomain&&(e="");var n={type:"offer",cargoIdentity:this.config.offerId,specData:JSON.stringify(this.skuSubmitData),returnType:"url",needTotalPrice:!1,promotionSwitch:a.isPromotionOffer(),_csrf_token:e,t:t.now(),purchaseType:this.config.purchaseType,ext:JSON.stringify(i)};this.cartView.activatePurchaselist(n)},_bindExpandEvent:function(){var i=t("div.obj-content",this.objSku),e=t("div.obj-expand",this.objSku),a=i.height(),n=134;i.height()>n&&(i.height(n),e.show(),e.on("click",function(e){e.preventDefault();var n=t(this);i.animate({height:a},function(){}),n.hide()}))},_skuHoverEvent:function(){var t,i=this;this.objSku.on("mouseenter",function(){t=setTimeout(function(){i._triggerExpandEvent()},1e3)}).on("mouseleave",function(){clearTimeout(t)})},_triggerExpandEvent:function(){var i=this.div.parent();i.hasClass("widget-custom-container")&&t("div.obj-expand",this.objSku).click()},_setContainerSize:function(){var t=this.div.closest("div.widget-custom-container");t.css({width:this.div.width(),height:this.div.height()})},_initSwitchPreview:function(){var i=t("span.image",this.objSku);i.on("mouseenter",function(){var i=t(this);t(window).trigger("switchPreview",[i])})},_activeImageView:function(i,e){var a=t("div.zoom",this.div),n=t("img",a),s=t("img",e),o=s.attr("src"),r="//cbu01.alicdn.com/cms/upload/other/lazyload.png";i?(n.removeAttr("src"),a.fadeIn(200),n.attr("src",r),a.css("top",s.offset().top-this.div.offset().top-60),o=o.replace(".32x32.jpg",".search.jpg"),n.attr("src",o)):a.fadeOut(200)},emptyCartView:function(){var i,e=this.specOperators,a=this.listOperators;t("div.unit-detail-spec-operator a",this.div).removeClass("completed"),this.objList.hide(),this.tableList.html(""),this.amountControl.setAmountValue(0),this.skuSubmitData=[],this.listSelectionStack=[],this.specSelectionStack=[],t.each(e,function(e,a){a.removeCompleted(),i=a.getData(),t.each(i,function(t,i){i.amount=0})}),t.each(a,function(t,i){i.setAmountValue(0)}),this._updateTotal()},_highlightPrice:function(i,e){for(var a,n=i.length,s=n-1;s>0;s--)if(i[s]&&i[s][0]<=e){a=".ladder-"+n+"-"+(s+1),t("#mod-detail-price").find(a).addClass("highlight-price");break}0==s&&(a=".ladder-"+n+"-1",t("#mod-detail-price").find(a).addClass("highlight-price"))}};i.add("mod-detail-purchasing-multiple",f)});;define("widget.common.plugin.OrderValidator",["jQuery"],function(i){function t(){this.init.apply(this,arguments)}return t.prototype={init:function(i,t,s){this.tip=t,this.setConfig(i),this.t=s?s:null,this.callback=null,this.tip&&this.tip.length&&(this.holdHtml=this.tip.html()?this.tip.html():"")},setCallback:function(i){this.callback="function"==typeof i?i:null},valid:function(i,t,s,h){{var n=parseInt(this.min)-.1,e=parseInt(this.max)+.1,r=parseInt(i),l=1*h,u=this.tip,m=this;window.iDetailConfig}if(s||u.length&&(u.hide(),m.callback&&m.callback.call(m,!1),u.html(""),u.show(),m.callback&&m.callback.call(m,!0)),this.t&&clearTimeout(this.t),this.t=setTimeout(function(){u.length&&(u.hide(),m.callback&&m.callback.call(m,!1))},5e3),1>e)return this._tipText(u,"\u6b64\u8d27\u54c1\u5df2\u552e\u5b8c"),1;if(0==r&&"blur"!==t)return this._tipText(u,"\u8ba2\u8d2d\u6570\u91cf\u5fc5\u987b\u4e3a\u5927\u4e8e0\u7684\u6574\u6570"),10;if(0>r)return this._tipText(u,"\u8ba2\u8d2d\u6570\u91cf\u5fc5\u987b\u4e3a\u5927\u4e8e0\u7684\u6574\u6570"),10;if(r>e)return this._tipText(u,"\u6700\u5927\u53ef\u8d2d\u4e70\u91cf\u4e3a"+this.max+this.unit),20;if(n>r&&"true"===this.isMix&&"order"===t)if((this.mixNumber&&r>=this.mixNumber||this.mixAmount&&l>=this.mixAmount)&&(this.mixBegin&&r>=this.mixBegin||!this.mixBegin));else if(!this.satisfyShopMix(r))return this._tipText(u,"\u6570\u91cf\u6216\u91d1\u989d\u4e0d\u6ee1\u8db3\u5546\u5bb6\u6df7\u6279\u89c4\u5219"),50;return!(n>r)||this.mixBegin||"false"!==this.isMix&&this.isMix||"order"!==t?this.wrNum&&r%this.wrNum!==0?(this._tipText(u,"\u672c\u4ea7\u54c1\u6309"+this.wrUnit+"\u6279\u53d1\uff0c\u6570\u91cf\u5fc5\u987b\u662f"+this.wrNum+"\u7684\u500d\u6570"),60):this.personLimitCount>-1&&r>this.personLimitCount&&("order"===t||"blur"===t)&&"true"!=this.canOriginalPriceOrder?(this._tipText(u,"\u672c\u4ea7\u54c1\u9650\u8d2d"+this.personLimitCount+this.unit),70):this.limitCount>0&&r>this.limitCount?(this._tipText(u,"\u8d85\u51fa\u9650\u8d2d\u5c06\u4e0d\u4eab\u53d7\u4f18\u60e0"),40):(u.length&&(u.hide(),m.callback&&m.callback.call(m,!1)),40):(this._tipText(u,"\u6700\u5c0f\u8d77\u8ba2\u91cf\u4e3a"+this.min+this.unit),30)},setMax:function(i){this.max=i},setConfig:function(i){this.min=i.min,this.max=i.max,this.isMix=i.isMix,this.mixAmount=i.mixAmount,this.mixNumber=i.mixNumber,this.mixBegin=i.mixBegin,this.unit=i.unit,this.wrNum=i.wsRuleNum,this.wrUnit=i.wsRuleUnit,this.isSkuOffer=i.isSkuOffer,this.limitCount=i.limitCount,this.personLimitCount=i.personLimitCount,this.canOriginalPriceOrder=i.canOriginalPriceOrder,this.shopMixNumber=parseInt(i.shopMixNumber||0)},_tipText:function(i,t){i.length&&i.html(this.holdHtml+t)},satisfyShopMix:function(i){return this.shopMixNumber<1?!1:i<this.shopMixNumber?!1:!0}},t});;define("widget.ditto.plugin.OrderButton",["jQuery","Tracelog","widget.daixiao.plugin.message","sys/logist/1.0","util/template/2.0"],function(t,e,i,o,a){var r=function(){this.init.apply(this,arguments)};return r.prototype={init:function(t,e,i,o){this.purchaseBtn=t.purchaseBtn,this.validator=i,this.cartBtn=t.cartBtn,this.quotationBtn=t.quotationBtn,this.amountControl=e,this.config=o},goPurchase:function(e,i){var o,a,r,n,s=this.purchaseBtn,c=this;s&&e&&(c.originalPricePurchase(e,i),s.mousedown(function(t){try{detail.trigger("loggerEvent",["purchase","Open"])}catch(t){}}),s.click(function(s){s.preventDefault();var u=t(this).data("type"),l=t(this).parent(".unit-detail-order-action").data("pagetype"),p=t(this).parent(".unit-detail-order-action").data("hasconsignrelation");if("daixiao"===l&&"nonsupport"!==u)return void c.goToDaixiaoProcess(e,i,u,p);if("nonsupport"!==u){o=t.trim(c.amountControl.getAmountValue()),n=c.amountControl.getPriceValue(),a=parseInt(o?o:0,10),r=c.validator.valid(a,"order",!1,n),FE.util.IsLogin()?40===r&&c.voucherOffer(e,i,u):c._popup(e,i,r,u);var d=new Date;document.images&&((new Image).src="//laputa.1688.com/monitor/click.htm?trace=purchase&time="+d.getTime())}}))},voucherOffer:function(t,i,o,a){var o=o||"",a=a||"",r=this;this.config.is94VoucherOffer&&"true"===this.config.is94VoucherOffer&&"order"===o?(FE.operation&&FE.operation.promotion&&FE.operation.promotion.lottery&&FE.operation.promotion.lottery(r.config.offerId,function(e,o,r){t.call(i,a,e,o,r)}),e.dmtrackClick("offerdetail_click_94voucher")):t.call(i,a)},goCart:function(e,i){var o=this.cartBtn,a=o.data("type")||"purchase",r=this;o&&e&&(o.mousedown(function(t){try{detail.trigger("loggerEvent",["addCart","Open"])}catch(t){}}),o.click(function(o){o.preventDefault();var n,s,c=t(this),u=t.trim(r.amountControl.getAmountValue()),l="",p=t(this).data("type"),d=t(this).parent(".unit-detail-order-action").data("pagetype"),m=t(this).parent(".unit-detail-order-action").data("hasconsignrelation");if("daixiao"===d&&"nonsupport"!==p)return void r.goToDaixiaoProcess(e,i,p,m);if(r.skuSpecId&&(l="&specId="+r.skuSpecId),c.hasClass("add-disable"))return void(r.orderCloseMenu&&(r.orderCloseMenu.parent().hide(),r.purchaseCloseMenu.parent().show()));n=parseInt(u?u:0,10),s=r.validator.valid(n,a),FE.util.IsLogin()?(40===s||80===s)&&e.call(i):r._popup(e,i,s);var h=new Date;document.images&&((new Image).src="//laputa.1688.com/monitor/click.htm?trace=cart&time="+h.getTime())}))},goAsk:function(t,e){var i=this.purchaseBtn,o=this,a=40;i.click(function(i){i.preventDefault(),FE.util.IsLogin()?t.call(e):o._popup(t,e,a)})},goQuote:function(e,i){var o=this.quotationBtn,a=o.data("type")||"purchase",r=this;o.click(function(o){o.preventDefault();var n,s,c=(t(this),t.trim(r.amountControl.getAmountValue()));n=parseInt(c?c:0,10),s=r.validator.valid(n,a),FE.util.IsLogin()?40===s&&e.call(i,"normal"):r._popup(e,i,s)})},_popup:function(e,i,a,r){var n=t("#doc").data("docConfig"),r=r||"",s=this;40===a&&o.init({source:"offerDetail_createOrder",ssoGateway:"//exodus.1688.com/member/sso/ssoSessionGateWay.do?targetUrl=",onLoginSuccess:function(){40===a&&("undefined"!=typeof n?(n.isTopDomain?(o.hide(),FE.util.goTo(this.ssoGateway+t(location).attr("href")),s.voucherOffer(e,i,r,"login")):o.hide(),s.voucherOffer(e,i,r,"login")):(o.hide(),s.voucherOffer(e,i,r,"login")))},onRegistSuccess:function(){this.onLoginSuccess()}})},handleLimitedTips:function(e){var i=t("div.limited-promotion-tip");40!==e&&(i.hide(),setTimeout(function(){i.show()},5e3))},goToDaixiaoProcess:function(e,a,r,n){var s,c,u,l,p=this;FE.util.IsLogin()?(s=t.trim(p.amountControl.getAmountValue()),l=p.amountControl.getPriceValue(),c=parseInt(s?s:0,10),u=p.validator.valid(c,r,!1,l),40===u&&(n?p.voucherOffer(e,a,r):i.init())):o.init({source:"offerDetail_createOrder",ssoGateway:"//exodus.1688.com/member/sso/ssoSessionGateWay.do?targetUrl=",onLoginSuccess:function(){setTimeout(function(){window.location.reload()},300)},onRegistSuccess:function(){this.onLoginSuccess()}});var d=new Date;document.images&&((new Image).src="//laputa.1688.com/monitor/click.htm?trace=purchase&time="+d.getTime())},originalPricePurchase:function(e,i){var o,a,r,n,s=this;t(".mod-detail-purchasing .can-original-price-order .original-purchase").on("click",function(){o=t.trim(s.amountControl.getAmountValue()),a=s.amountControl.getPriceValue(),r=parseInt(o?o:0,10),n=s.validator.valid(r,"order",!1,a),FE.util.IsLogin()?40===n&&s.voucherOffer(e,i,"order"):s._popup(e,i,n,"order")})},yunxuanPopup:function(t){o.init({source:"offerDetail_createOrder",ssoGateway:"//exodus.1688.com/member/sso/ssoSessionGateWay.do?targetUrl=",onLoginSuccess:function(){t&&t()}})},handleYouxuanInfo:function(){var t,e='<div class="supply-container">              <div class="supply-rules">                <div class="title"><i class="iconfont icon-prompt"></i>{{title}}</div>                <ol class="rules">                  {{each rules}}                  <li>{{=$value}}</li>                  {{/each}}                </ol>              </div>              <div class="feature-banner">                <img src="{{img}}" alt=""/>              </div>              <div class="sku-table-list">              <table class="sku-table">                <tr>                  {{if label.sku}}<th width="200">{{label.sku}}</th>{{/if}}                  <th width="240" class="price1">{{label.price1}}</th>                  <th width="240" class="price2">{{label.price2}}</th>                  {{if label.rest}}<th>{{label.rest}}</th>{{/if}}                </tr>                {{each skuList}}                <tr>                  {{if $value.label}}<td>{{$value.label}}</td>{{/if}}                  <td class="price1">{{unit.money}}{{$value.price1}}</td>                  <td class="price2">{{unit.money}}{{$value.price2}}</td>                  {{if ($index == 0 && label.rest)}}                  <td class="rest" rowspan="{{skuList.length}}">{{rest}}{{unit.people}}</td>                  {{/if}}                </tr>                {{/each}}                </table></div>            </div>',i=this.handleYouxuanData();return(t=a.compile(e))(i)},handleYouxuanData:function(){var e=t(".dis-to-youxuan"),i="tttj"===e.data("type"),o=e.data("optimizationskumap"),a=e.data("optimizationsupplyprice"),r=e.data("optimizationretailprice"),n=e.data("restdistributeamount"),s=(e.data("maxdistributelimit")||5,{title:"\u7279\u522b\u63d0\u9192:",unit:{money:"\uffe5",people:"\u4eba"},label:{},img:i?"//img.alicdn.com/tfs/TB1NTLWn7yWBuNjy0FpXXassXXa-920-60.png":"//img.alicdn.com/tfs/TB1l8NeerGYBuNjy0FoXXciBFXa-921-60.png",skuList:[],rules:i?["1\u3001\u6dd8\u5b9d<em>\u5929\u5929\u7279\u4ef7\u6d3b\u52a8\u9650\u4ef7</em>\u4e3a\u6dd8\u5356\u62a5\u540d\u53c2\u52a0\u6dd8\u5b9d\u5929\u5929\u7279\u4ef7\u8425\u9500\u5e73\u53f0\u7684\u4e0a\u9650\u4ef7\u683c","2\u3001\u6dd8\u5356\u5728\u62a5\u540d\u5929\u5929\u7279\u4ef7\u65f6\u5546\u54c1\u7684\u6d3b\u52a8\u4ef7<em>\u4e0d\u5f97\u9ad8\u4e8e</em>\u6dd8\u5b9d\u5929\u5929\u7279\u4ef7\u6d3b\u52a8\u9650\u4ef7",'3\u3001\u6dd8\u5356\u9996\u6b21\u4f20\u6dd8\u5b9d\u5e76\u4e14\u6210\u529f\u53c2\u52a0\u6dd8\u5b9d\u5929\u5929\u7279\u4ef7\u6d3b\u52a8\u5f53\u5929\u751f\u6548 "<em>\u5929\u5929\u7279\u4ef7\u4f9b\u8d27\u4ef7</em>"\uff0c\u53ef\u4ee5\u957f\u671f\u4eab\u53d7\u8be5\u4f9b\u8d27\u4ef7\u4e0e\u4f9b\u5e94\u5546\u4ea4\u6613',"4\u3001\u6dd8\u5356\u9996\u6b21\u4f20\u6dd8\u5b9d\u5e76\u4e14\u62a5\u540d\u5929\u5929\u7279\u4ef7\u6210\u529f\u540e\uff0c\u8981\u6c42<em>\u57fa\u7840\u9500\u91cf\u226510\u4e2a</em>\u65b9\u53ef\u5ba1\u6838\u901a\u8fc7"]:["1\u3001\u6dd8\u5b9d\u96f6\u552e\u9650\u4ef7\u662f\u8be5\u5546\u54c1\u5728\u6dd8\u5b9d\u7684\u5305\u90ae\u96f6\u552e\u4ef7\u683c\u7684\u4e0a\u9650;","2\u3001\u5546\u54c1\u5728\u6dd8\u5b9d\u4e0a\u7684\u53d1\u5e03\u4ef7\u683c<em>\u4e0d\u5f97\u9ad8\u4e8e</em>\u6dd8\u5b9d\u96f6\u552e\u9650\u4ef7;","3\u3001\u6bcf\u4e2a\u6dd8\u5b9d\u5356\u5bb6\uff0c\u6700\u591a<em>\u53ea\u53ef\u76f4\u901a5\u6b3e\u5546\u54c1</em>\u8fdb\u5165\u8d85\u503c\u4f18\u9009;","4\u3001\u6bcf\u4e2a\u5546\u54c1\uff0c\u6700\u591a<em>\u53ea\u80fd\u88ab5\u4e2a\u6dd8\u5b9d\u5356\u5bb6\u94fa\u8d27</em>\u4f20\u8d85\u503c\u4f18\u9009\u3002"],rest:n});if(a&&r)s.label={price1:"\u76f4\u4f9b\u4e13\u5c5e\u4ef7",price2:i?"\u5929\u5929\u7279\u4ef7\u6d3b\u52a8\u6700\u9ad8\u9650\u4ef7":"\u6700\u9ad8\u96f6\u552e\u9650\u4ef7",rest:"\u5269\u4f59\u53ef\u94fa\u8d27\u4eba\u6570"},i&&delete s.label.rest,s.skuList=[{price1:a,price2:r}];else{s.label={sku:"SKU\u4fe1\u606f",price1:"\u76f4\u4f9b\u4e13\u5c5e\u4ef7",price2:i?"\u5929\u5929\u7279\u4ef7\u6d3b\u52a8\u6700\u9ad8\u9650\u4ef7":"\u6700\u9ad8\u96f6\u552e\u9650\u4ef7",rest:"\u5269\u4f59\u53ef\u94fa\u8d27\u4eba\u6570"},i&&delete s.label.rest;for(var c in o)s.skuList.push({label:c,price1:o[c].supplyPrice,price2:o[c].retailPrice})}return s}},r});;define(["jQuery","ModContext"],function(i,t){var e={init:function(i,t){this.div=i,this.config=t,this.showup=!1,this._initShowUp(),this._initHover()},_initShowUp:function(){var t=i("ul.guarantee-type",this.div),e=i("i.icon-arrow",this.div);t.height()>25&&(e.show(),this.showup=!0)},_initHover:function(){if(this.showup){{var t;i("div.d-content",this.div)}this.div.on("mouseenter",function(){var e=i(this);t=setTimeout(function(){e.addClass("guarantee-active")},100)}).on("mouseleave",function(){clearTimeout(t),i(this).removeClass("guarantee-active")})}},_initTypeHover:function(){var t=i("li.guarantee-type-consignment",this.li);t.on("mouseenter",function(){var e=i(this);t.index(e)>=3&&i("div.d-tip",e).css("top",44),e.parent().css("overflow","visible"),e.find("div.d-tip").show()}).on("mouseleave",function(){var t=i(this);t.parents(".mod-detail-title-inspection").length||t.parent().css("overflow","hidden"),t.find("div.d-tip").hide()})}};t.add("mod-detail-guarantee",e)});;define(["jQuery","ModContext"],function(i,t){var n={init:function(i,t){this.div=i,this.config=t,this.showup=!1,this._initApplyArea(),this._initSplitLine(),this._bindEvent()},_initShowUp:function(){for(var t,n,a=i("div.d-content",this.div),e=0;e<a.length;e++)t=a.eq(e).find("ul.trade-type"),n=a.eq(e).find("i.icon-arrow"),t.height()>20&&n.show();this._initHover()},_initHover:function(){var t=i("div.d-content",this.div);t.on("mouseenter",function(){i(this).addClass("tradeway-active")}).on("mouseleave",function(){i(this).removeClass("tradeway-active")})},_initSplitLine:function(){var t=i("ul.trade-type li",this.div);t.last().addClass("last-col")},_initApplyArea:function(){{var t=this,n={},a=i("li.apply-account",this.div),e=i("li.zqzf",this.div),o=i("a.apply-btn",this.div),d=o.data("unitConfig").queryApplyUrl,s=o.data("unitConfig").sellerId;i("ul.trade-type",this.div),i("i.icon-arrow",this.div)}n={sellerId:s,needQuotaInfo:!0},0!==e.length?i.ajax(d,{data:n,dataType:"jsonp",success:function(i){i.success&&i.data.canApply&&(a.show(),e.hide(),aliclick(t,"?tracelog=kf_1688zhangqi_01")),t._initShowUp()},error:function(i){t._initShowUp()}}):t._initShowUp()},_bindEvent:function(){var t={},n=i("div.my-dialog-body");i("a.apply-btn").on("click",function(a){var e=i(this).data("unitConfig").applyUrl,o=i(this).data("unitConfig").sellerId;return t={sellerId:o},i.ajax(e,{data:t,dataType:"jsonp",success:function(i){}}),i.use("ui-dialog, ui-draggable",function(){i(n).dialog({fadeIn:500,fadeOut:500,timeout:1e3,center:!0})}),!1})}};t.add("mod-detail-tradetype",n)});;define(["jQuery","ModContext","util/datalazyload/2.0"],function(a,i,t){"use strict";var d={init:function(a){this.div=a;new t({container:this.div,imgSrcName:"data-lazyload-src"})}};i.add("mod-detail-banner",d)});;define(["jQuery","ModContext","fui/tabs/2.0"],function(t,e,i){var o={init:function(t,e){if(this.div=t,this.config=e,this.limit=8,this.div.length){this.hanleContainerSize(),window.goldlog&&window.goldlog.record("/offerDetail.click.clickstat","CLK","key=[hotOfferExposure]","H1484266073");try{}catch(i){console.log(i)}}},hanleContainerSize:function(){var e,i,o=t(".combination-offer"),n=t(".hotsale-offer"),l=o.find("li"),a=n.find("li");i=this.limit-(l.length<4?l.length:4),l.length>4&&(e=l.outerWidth(!0),o.width(4*e-20).addClass("combination-offer-full"),this.initTab(o,4)),a.length>i&&(e=a.outerWidth(!0),n.width(e*i-20),this.initTab(n,i))},initTab:function(t,e){var o,n=t.find(".tab-container"),l=n.find("li"),o=(l.outerWidth(!0),new i({el:t,event:"click",boxSelector:".tab-container li",effect:"leftright",overflowContainer:".tab-container",prev:".hotsale-offer-prev",next:".hotsale-offer-next",isLoop:!1,step:e}));o.on("switch",function(t){var e=t.self,i=e.get("disableCls"),o=e.get("step");e.nextNode.toggleClass(i,t.index+o===e.boxes.length)})}};e.add("mod-detail-hotsale-offer","area-detail-whosaleself",o)});;define(["jQuery","ModContext","Util","Tracelog"],function(t,i,a,e){var o={init:function(){this.div=t("div.mod-detail-tab"),this.tabPurchasing=t("div.d-tab-purchasing",this.div),this.tabStatus="sink",this.tabContent=t("ul",this.div),this.floatLock=!1;var i=this;t(window).bind("updateRateCount",function(a,e){var o=t('a[data-info*="mod-detail-comment"]',i.div);t("em",o).eq(0).html(e)}),t(window).bind("generateTab",function(t,a){if(a.result)for(var e=0;e<a.result.length;e++)i.tabContent.append(i._generateTabItem(a.result[e],e,a.result.length));i._initTabs(),i._initTabFloats(),i._initTabPurchasing()})},_generateTabItem:function(i,a,e){var o=t('<li class="tab-li"><a href="#" trace="'+i.trace+'" data-info="'+i.showKey+'" ><span>'+i.title+"</span></a></li>");return 0===a&&o.addClass("first"),a+1===e&&o.addClass("last-col"),o},_initTabs:function(){var i=this;this.tabArr=t("ul li.tab-li a",this.div),this.tabArr.attr("hideFocus",!0),this.div.delegate("ul li.tab-li a","click",function(a){if(a.preventDefault(),!t(this).closest("li").hasClass("de-selected")){i.tabArr.closest("li").removeClass("de-selected"),t(this).closest("li").addClass("de-selected");var e=t(this).data("info");switch(t(".catalog-pure",i.div).hide(),e){case"mod-detail-description":t(".catalog-pure",i.div).show(),t(".catalog-pure-item",i.div).removeClass("current"),i._toggleWinportCustom(!0);break;case"mod-detail-record":t(window).trigger("loadRecord",!0),i._toggleWinportCustom(!1);break;case"mod-detail-dealrecord":t(window).trigger("loadDealrecord",!0),i._toggleWinportCustom(!1);break;case"mod-detail-comment":t(window).trigger("loadComment",!0),i._toggleWinportCustom(!1);break;case"mod-detail-contact":t(window).trigger("loadContact",!0),i._toggleWinportCustom(!1);break;case"mod-detail-order":t(window).trigger("loadOrder",!0),i._toggleWinportCustom(!1);break;case"mod-detail-attachmentlist":t(window).trigger("loadAttachmentlist",!0),i._toggleWinportCustom(!1);break;case"mod-detail-supcert":t(window).trigger("loadDealrecord",!0),i._toggleWinportCustom(!1);break;case"mod-detail-kjpicpackage":t(window).trigger("loadKjpicpackage",!0),i._toggleWinportCustom(!1);break;default:i._toggleWinportCustom(!0)}t(window).trigger("loadTab",e),t(window).trigger("determineTabVisibility",e),t(window).trigger("checkWPCustom",e),t(window).trigger("resetTab")}}),this.tabArr.first().click(),t(window).bind("summariseComments.tabs",function(i,a,e){t("#tab-tiaoshu",this.div).html(a)})},_toggleWinportCustom:function(i){var a=t("div.mod-offerDetailContext2").nextUntil("div.mod-offerDetailContext3");a.toggle(i)},_initTabFloats:function(){this.tab=t("div.mod-detail-new-otabs",this.div),this.holder=t("div.mod-detail-otabs-holder",this.div),this.tabStatus="sink";var i,a,e=this.tabPurchasing,o=(this.holder.offset().top,this),s=this.tab,d=this.holder;t(window).bind("scroll.tabs resize.tabs",function(){i=t(document).scrollTop(),a=o.holder.offset().top,i>=a?(o._toggleHolder(d,s,"show"),o._toggleAddToCart(e,"show"),o._toggleFloat(s,i,"float"),o.tabStatus="float"):(o._toggleHolder(d,s,"hide"),o._toggleAddToCart(e,"hide"),o._toggleFloat(s,i,"sink"),o.tabStatus="sink")}),t(window).on("resetTab",function(){"float"===o.tabStatus&&t(window).scrollTop(o.holder.offset().top)}),t(window).bind("openTab.tabs",function(i,a,e){/^[\w_-]*$/.test(a)||(a=""),t('ul li a[data-info="'+a+'"]',o.div).click(),t(document).scrollTop(e?t(e).offset().top-o.div.height():o.holder.offset().top),t(window).trigger("checkWPCustom",a)})},_toggleHolder:function(i,a,e){"show"===e?i.css("height",t(a).height()+"px"):"hide"===e&&i.css("height","0px")},_toggleAddToCart:function(i,a){var e=!!t("div.mod-detail-company").length;if(i.length&&!e)if("show"===a)i.show();else if("hide"===a){i.hide(),this.tabPurchasing.hasClass("d-tab-purchasing-expand")&&t("div.purchasing-list",this.tabPurchasing).click(),t("div.offerdetail_ditto_purchasing div.widget-custom-container").append(t("div.mod-detail-purchasing"));var o=t("div.offerdetail_reserveOffer_purchasing div.widget-custom-container");o&&o.length>0&&o.append(t("div.mod-detail-purchasing"));var s=t("div.offerdetail_printing_purchasing div.widget-custom-container");s&&s.length>0&&s.append(t("div.mod-detail-purchasing"))}},_toggleFloat:function(i,a,e){t(i).css("z-index",98),"float"===e?(t.util.ua.ie6&&!t("#content2").length?t(i).css({position:"absolute",top:a}):t.util.ua.ie6||t(i).css({position:"fixed",top:0,left:0}),t(i).addClass("tab-float"),this.floatLock===!1&&t("li a",i).each(function(){t(this).attr("trace_bak",t(this).attr("trace")),t(this).attr("trace",t(this).attr("trace")+"_float")}),this.floatLock=!0):"sink"===e&&(t(i).css({position:"static",top:0}),t(i).removeClass("tab-float"),t("li a",i).each(function(){t(this).attr("trace",t(this).attr("trace_bak"))}),this.floatLock=!1)},_initTabPurchasing:function(){var i=t("div.purchasing-list",this.tabPurchasing),o=t("div.purchasing-container",this.tabPurchasing),s=this;i.on("click",function(i){i.preventDefault();t(this);if(o.find("div.mod-detail-purchasing").length||o.append(t("div.mod-detail-purchasing")),s.tabPurchasing.hasClass("d-tab-purchasing-expand")){var a=t("div.obj-sku div.obj-content",o),d=t("div.obj-expand",o);a.length&&a.height()>=224&&(a.height(224),a.removeClass("scroll-y"),d.show()),s.tabPurchasing.removeClass("d-tab-purchasing-expand")}else{s.tabPurchasing.addClass("d-tab-purchasing-expand");var a=t("div.obj-sku div.obj-content",o),d=t("div.obj-expand",o);a.length&&(a.height()>224||"block"===d.css("display"))&&(a.height(224),a.addClass("scroll-y"),d.hide()),e.dmtrackClick("offerdetail_click_quickpurchase")}}),t("body").on("click",function(i){var a=t(i.target);0===a.closest(s.tabPurchasing).length&&s.tabPurchasing.removeClass("d-tab-purchasing-expand")}),detail.on("updateTabAmount",function(e,o){t("span.amount",i).text(a.tenThousandSep(e)),t("span.price",i).text(a.tenThousandSep(o,!0))})}};i.add("mod-detail-tab","area-detail-feature",o)});;define(["jQuery","ModContext"],function(t,i){var e={init:function(t,i){this.div=t,this.config=i,this._bindExpandEvent()},_bindExpandEvent:function(){var i=t(".attributes-item","div.mod-detail-other-attr"),e=i.find("div.qcode");if(that=this,0===i.length&&(t("div.mod-detail-other-attr div.detail-other-attr-content").hide(),i.hide()),i.length>1){for(var n=0;n<i.length;n++)i.eq(n).height()>50&&i.eq(n).addClass("showmore multi").append('<i class="icon-arrow icon-arrow-down"><em></em><span></span></i>');i.parent().on("click",".attributes-item.multi",function(){t(this).toggleClass("showmore animate")})}i.on("mouseover",".source",function(){e.show()}).on("mouseout",".source",function(){e.hide()})}};i.add(".mod-detail-other-attr",e)});;define("import/page/country/map",function(){var n={countryInfoMap:[[{name:"\u97e9\u56fd",pinyin:"Hanguo",english:"Korea",code:"KR"}],[{name:"\u65e5\u672c",pinyin:"Riben",english:"Japan",code:"JP"}],[{name:"\u9999\u6e2f",pinyin:"Xianggang",english:"Hongkong",code:"HK"}],[{name:"\u6fb3\u95e8",pinyin:"Aomen",english:"Macao",code:"MO"}],[{name:"\u53f0\u6e7e",pinyin:"Taiwan",english:"Taiwan",code:"TW"}],[{name:"\u6cf0\u56fd",pinyin:"Taiguo",english:"Thailand",code:"TH"}],[{name:"\u8d8a\u5357",pinyin:"Yuenan",english:"Vietnam",code:"VN"}],[{name:"\u9a6c\u6765\u897f\u4e9a",pinyin:"Malaixiya",english:"Malaysia",code:"MY"}],[{name:"\u5370\u5ea6\u5c3c\u897f\u4e9a",pinyin:"Yindunixiya",english:"Indonesia",code:"ID"}],[{name:"\u6cd5\u56fd",pinyin:"Faguo",english:"France",code:"FR"}],[{name:"\u897f\u73ed\u7259",pinyin:"Xibanya",english:"Spain",code:"ES"}],[{name:"\u5fb7\u56fd",pinyin:"Deguo",english:"Germany",code:"DE"}],[{name:"\u610f\u5927\u5229",pinyin:"Yidali",english:"Italy",code:"IT"}],[{name:"\u82f1\u56fd",pinyin:"Yingguo",english:"United Kiongdom",code:"GB"}],[{name:"\u745e\u58eb",pinyin:"Ruishi",english:"Switzerland",code:"CH"}],[{name:"\u52a0\u62ff\u5927",pinyin:"Jianada",english:"Canada",code:"CA"}],[{name:"\u7f8e\u56fd",pinyin:"Meiguo",english:"United States of America",code:"US"}],[{name:"\u667a\u5229",pinyin:"Zhili",english:"Chile",code:"CL"}],[{name:"\u6fb3\u5927\u5229\u4e9a",pinyin:"Aodaliya",english:"Australia",code:"AU"}],[{name:"\u5176\u4ed6",pinyin:"Qita",english:"OTHERS",code:"OTHERS"}]]};return n});;define(["jQuery","ModContext","import/page/country/map","lofty/util/cms-vm/2.0/cms-vm-jsonp"],function(t,i,o,a){var n={init:function(i){this.div=i,this.orderLock=!1,this.div.length&&(this.lazyContainer=t("div.lazyload-textarea",this.div),this.getNationalFlag())},getNationalFlag:function(){a.get("caigou_import_country_list_v1.0",function(i){for(var o=i.countryInfoMap,a=t(".mod-caigou-import-otherAttrs"),n=a.find(".origin-country"),r=n.data("code"),e=0,d=o.length;d>e;e++){var c=o[e];c.code==r&&n.text(c.text)}})}};i.add("mod-caigou-import-otherAttrs","area-detail-credit",n)});;define(["jQuery","ModContext"],function(t,i){var o={init:function(){this._bindExpandEvent()},_bindExpandEvent:function(){var i=t("div.obj-content","div.mod-detail-attributes"),o=t("div.obj-expand","div.mod-detail-attributes"),a=i.height(),n=130;i.height()>n&&(i.height(n),o.show(),o.on("click",function(o){o.preventDefault();var e=t(this),d=e.parent(),s=t("i.icon-arrow",e);d.hasClass("attr-open")?(i.animate({height:n}),d.removeClass("attr-open"),s.removeClass("icon-arrow-up-solid"),s.addClass("icon-arrow-down-solid")):(i.animate({height:a}),d.addClass("attr-open"),s.addClass("icon-arrow-up-solid"),s.removeClass("icon-arrow-down-solid")),console.log(n)}))}};i.add("mod-detail-attributes",o)});;define(["jQuery","ModContext"],function(e,t){var i={init:function(t,i){this.div=t,this.config=i,this.div.length&&(this.wrapper=e("div.offer_video_wrap",this.div),this.refKeyNode=e("#offer_video_refKey",this.div),this.videoIdNode=e("#offer_video_id",this.div),this.videoStateNode=e("#offer_video_state",this.div),this.config.detailVideoId&&/[0-9]/.test(this.config.detailVideoId)?this.requestNewVideo():(this.wrapper.html(""),this.div.hide()))},requestNewVideo:function(){var t=this.config.videoServerUrl||"//apps.1688.com/event/app/videoInfo/getVideoById.htm",i={site_id:"winport",videoId:this.config.detailVideoId,memberId:window.iDetailConfig.memberid,_csrf_token:window.iDetailConfig._csrf_token},a=this;t&&e.ajax({url:t,data:i,dataType:"jsonp",timeout:2e4,success:function(e){e&&a.resultNewdata(e)}})},resultNewdata:function(t){if(t)if("online"==t.status){if(!e("#detail-common-video-player").length){new Videox({container:"#offer_video_wrap",from:"ugc_copy",url:t.address.replace("/e/1/","/e/6/").replace(".swf",".mp4"),autoplay:!0,controls:!0,volumeControls:!0,muted:!0})}}else this.wrapper.html(""),this.div.hide();else this.wrapper.html(""),this.div.hide()},resultdata:function(){if(window.resultdata&&"true"==window.resultdata.isSuccess)if("approved"==window.resultdata.data.auditStatus){var t='<!--[if lte IE 9.0]>                            <object id="detail-common-video-player" type="application/x-shockwave-flash" data="<%= $data.data.videoInfo.url %>" height="400" width="480">                        <![endif]-->                        <!--[if lt IE 9.0]>                            <param name="movie" value="<%= $data.data.videoInfo.url %>">                        <![endif]-->                        <!--[if lte IE 9.0]>                            <param name="quality" value="high">                            <param name="allowScriptAccess" value="always">                            <param name="allowFullScreen" value="true">                            <param name="swLiveConnect" value="true">                            <param name="flashvars" value="autoplay=true&amp;auto=0&amp;deflogo=0&amp;adss=0&amp;jump=0&amp;fu=1&amp;recommend=0&amp;pl=0">                            <% if($data.html5){ %>                                <video controls height="400" width="480" src="<%= $data.html5 %>"></video>                            <% } %>                        </object>                        <![endif]-->';if(window.resultdata.data.videoInfo&&(this.wrapper.html(FE.util.sweet(t).applyData(window.resultdata)),!e("#detail-common-video-player").length)){new Videox({container:"#offer_video_wrap",from:"ugc_copy",url:window.resultdata.data.videoInfo.url.replace("/e/1/","/e/6/").replace(".swf",".mp4"),autoplay:!0,controls:!0,volumeControls:!0,muted:!0})}}else"refused"==window.resultdata.data.auditStatus?(this.wrapper.html(""),this.div.hide()):(this.wrapper.html(""),this.div.hide());else this.wrapper.html(""),this.div.hide()}};t.add("mod-detail-video","area-detail-feature",i)});;