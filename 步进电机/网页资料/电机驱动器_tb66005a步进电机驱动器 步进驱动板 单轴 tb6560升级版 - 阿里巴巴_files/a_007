define(["jQuery","ModContext","widget.common.plugin.Timer"],function(i,t,e){var n={init:function(t,n){new e(i("div.hotting-timer div.d-timer",t))}};t.add("mod-detail-hottingbar","area-detail-property",n)});;define(["jQuery","ModContext","Log","widget.common.plugin.Logist","widget.common.plugin.Timer"],function(i,e,t,n,r){var o={init:function(e,t,n,o,a){this.div=e,this.config=t,this.faceConfig=a,this._checkLogin(),this._updateAmount(),new r(this.div);try{i(".mod.mod-ditto-tradetype").length>0&&i("#mod-detail-price").addClass("no-border-top")}catch(c){console.log(c)}},_resetFontSize:function(){var e=i("tr.price td",this.div),t=30;e.each(function(){var e=i(this),n=e.data("range");n&&(n.price>1e7&&(t=24),n.price>1e8&&(t=20))}),30>t&&i("span.value",e).css("fontSize",t)},_checkLogin:function(){var e=i("a.auth-login",this.div);e.click(function(i){i.preventDefault(),new n({source:"offerDetail_private2"})})},_updateAmount:function(){var e=this;i(window).bind("updateAmount.priceRange",function(t,n){n=1*n;var r={};r.amount=n,r.price=e._getCurrentPrice(n),i(window).trigger("freightCalculation",r)})},_getCurrentPrice:function(e){var t=i("tr.price td",this.div),n=[],r=this.faceConfig.refPrice;if(t.each(function(){var e=i(this),t=e.data("range"),r={};t&&(r={begin:t.begin,price:t.price},n.push(r))}),n.length){r=n[0].price;for(var o=n.length;o>0;o--)if(e>=1*n[o-1].begin){r=n[o-1].price;break}}return r}};e.add("mod-detail-price","area-detail-property",o)});;define(["jQuery","ModContext","sys/logist/1.0"],function(i,n,o){var t={init:function(i,n){this.node=i,this._initEvent()},_initEvent:function(){var n=i(".btn-vip-right-login",this.node);n.on("click",function(){o.init({source:"offerDetail_vipLogin",onLoginSuccess:function(){setTimeout(function(){window.location.reload()},300)},onRegistSuccess:function(){this.onLoginSuccess()}})})}};n.add("mod-detail-vip-login",t)});;define(["jQuery","ModContext"],function(e,i){function o(e){return e?e.indexOf("-")>0?parseFloat(e.split("-")[0],10):parseFloat(e,10):void 0}function n(e){return e&&e.length?(e=e[e.length-1],e.convertPrice?parseFloat(e.convertPrice,10):parseFloat(e.price||e.value,10)):void 0}var t,r=location.href.indexOf("_debugMode_=1")>0,c={init:function(i,o){t=i;var n=e(".d-content",t).data("price");n&&this.checkPrice(n)&&(t.show(),this.initQRCode(),this.bindEvent())},checkPrice:function(i){var t=0,c=0;if(r&&console&&console.log(i),i.normalPrice&&i.mobilePrice){c=i.skuMobileSupported?o(i.mobilePrice):n(i.mobilePrice),c||(c=e(".op-price-mobile").data("mobilePrice"));try{if(t=i.skuPCSupported?o(i.normalPrice):n(i.normalPrice),r||t&&c&&t-c>0)return e(".plugin-promoting-title em").html("&yen;"+c),!0}catch(l){}}return r?(console&&console.log("\u8c03\u8bd5\u6a21\u5f0f\uff0c\u5f3a\u5236\u5c55\u5f00\u6837\u5f0f"),!0):void 0},initQRCode:function(){var i=e(".plugin-promoting-qr",t),o=e(".plugin-promoting-title",t),n=iDetailConfig.qrcode;i.before('<img src="'+n+'" class="plugin-promoting-qr" title="\u624b\u673a\u626b\u4e00\u626b\uff0c\u4e0b\u5355\u66f4\u4f18\u60e0" />'),i.remove(),e(".plugin-promoting-dialog",t).css("left",o.width())},bindEvent:function(){e(".icon-qr",t).hover(function(){t.addClass("active")}),e(".d-content",t).mouseleave(function(){t.removeClass("active")})}};i.add("mod-detail-promoting",c)});;define(["jQuery","ModContext","alicn/aliuser/1.0","util/template/2.0"],function(e,i,n,t){var a={init:function(i,n){this.div=i,this.config=n;var t=e(".promotion-content,.coupons-list,.preferential-block",this.div);if(t.length>4){var a=e('<a class="preferential-expand-more">\u66f4\u591a</a>');this.div.append(a),t.slice(4).css("display","none"),a.click(function(){a.hasClass("active")?(t.slice(4).css("display","none"),a.removeClass("active").text("\u66f4\u591a")):(t.slice(4).css("display","inline-block"),a.addClass("active").text("\u6536\u8d77"))})}this._initRebateInfo(),this._initPreferentialApply(),this._bindCouponEvent(),this._bindUserEvent(),this._initBeltProfit()},_initRebateInfo:function(){var i=e(".preferential-block[data-activity-has-rebate]",this.div);if(!i||!i.length)return!1;var n=i.attr("data-activity-rebate-info");try{n=JSON.parse(n)}catch(a){n=""}if(!n)return!1;var o="";o="{{each rebateInfo as value index}}",o+="   <li>",o+='       <div class="preferential-item">',o+='           <span class="preferential-name">\u7d2f\u79ef\u8fd4\u5229</span>',o+='           <span class="preferential-info">{{value.amount}}\u4ee5\u4e0a\u8fd4{{value.rate}}</span>',o+='       </div><div class="dashed-line"></div>',o+="   </li>",o+="{{/each}}";var s=t.compile(o),r=s({rebateInfo:n});i.find(".preferential-list").html(r)},_initPreferentialApply:function(){try{var i=e(".preferential-block",this.div);e.trim(i.text())||(i.siblings(".tickets-list").css("margin-bottom",0),i.hide())}catch(n){}},_bindUserEvent:function(){var i=this,n=e(".preferential-block",this.div);n.each(function(){i._initPreferentialBlock(e(this))}),e(".coupons-list:not(.multiple-coupons)",this.div).each(function(){i._initCouponsBlock(e(this))})},_initCouponsBlock:function(i){var n=e(".all-coupons li:not(.coupons-list-tips)",i);if(n.length>0){var t=e('<div class="coupons-list-handle"></div>');t.html(n.eq(0).html()),i.prepend(t)}},_initPreferentialBlock:function(i){var n=e("li:not(.preferential-list-tips)",i);if(n.length>0){var t=e('<ul class="default-list"></ul>'),a=n.eq(0).clone();a.find(".preferential-item").append('<i class="icon-arrow icon-arrow-down"><em></em><span></span></i>'),i.append(t),a.appendTo(t),this._handleHoverEvent(i,n,t)}},_handleHoverEvent:function(i,n,t){i.hover(function(){i.addClass("active"),1===n.length&&e(n).addClass("with-tip-active")},function(){i.removeClass("active")})},_bindCouponEvent:function(){var i=e(".coupons-list",this.div);e(i).hover(function(){var i=e(".preferential-block",this.div);if(i.length>0){i.removeClass("active");var n=i.find(".icon-arrow");n.length>0&&n.attr("class","icon-arrow icon-arrow-down")}},function(){});var n=this;e("a.coupons-link",i).on("click",function(i){var t=e(i.target),a=t.data(),o=a.couponId,s=a.couponType,r=a.sellerId,l=a.isApply;l||n._getCoupon(o,s,r)})},_getCoupon:function(i,t,a){var o,s=e(".coupons-list",this.div);o=-1==window.location.href.indexOf("-test")?"//marketing.1688.com":"//marketing-test.1688.com",n.isLogin()&&"true"===iDetailConfig.islogin?e.ajax({url:o+"/coupon/ajax/apply_coupon.json",dataType:"jsonp",data:{sellerId:a,couponType:t,couponId:i}}).done(function(n){n=n||{};var t=e('a.coupons-link[data-coupon-id="'+i+'"]',s);n&&n.success||n&&"APPLY_COUPON_PERSON_COUNT_EXCEED"==n.errorCode?(t.addClass("coupons-link-disabled").html("\u5df2\u9886\u53d6"),t.data().isApply=!0,n&&"APPLY_COUPON_PERSON_COUNT_EXCEED"==n.errorCode&&n.errorMessage&&t.parents("li").find(".coupons-warning").html(n.errorMessage)):n&&"APPLY_COUPON_TOTAL_COUNT_EXCEED"==n.errorCode?(t.addClass("coupons-link-disabled").html("\u5df2\u9886\u5b8c"),t.data().isApply=!0,t.parents("li").find(".coupons-warning").text("\u4f18\u60e0\u5238\u5df2\u88ab\u62a2\u5149\uff0c\u4e0b\u6b21\u5feb\u70b9\u54e6")):n&&"APPLY_COUPON_ONLY_FOR_WG_BUYER"==n.errorCode?n.errorMessage&&t.parents("li").find(".coupons-warning").html(n.errorMessage+' <a href="//view.1688.com/cms/promotion/Purchasing-card.html?tracelog=coupon" target="_blank">\u7ba1\u7406\u8eab\u4efd</a>'):n.errorMessage&&t.parents("li").find(".coupons-warning").html(n.errorMessage)}):FE.sys.logist({source:"offerdetail_get_coupon",tab:"login",onLoginSuccess:function(){FE.sys.logist("close"),window.location.reload()},onRegistSuccess:function(){}})},_initBeltProfit:function(){function i(){o.next("li").length?o.hide():a.hide()}var t=n.isLogin()&&"true"===iDetailConfig.islogin,a=e(".mod-detail-preferential"),o=e(".belt-li",a),s=e(".belt-preferential-info",o),r=o.parent().data("fanli");r&&(t?(s.hide(),e.ajax({url:"/subsite/vipcard/getVipInfo.jsonp",dataType:"jsonp",success:function(e){var n,e=e.content;e?(e.siteRebate?n=e.isVIP?e.requiredLevel?"\u60a8\u662f"+e.siteName+'<span class="belt-member-name">'+e.cardName+"</span>\u4f1a\u5458\uff0c\u8054\u7cfb\u7ad9\u957f\u6210\u4e3a\u81f3\u5c0a\u4f1a\u5458\u5361\u4eab\u53d7\u8fd4\u5229":e.userRebate?"\u60a8\u662f"+e.siteName+'<span class="belt-member-name">'+e.cardName+"</span>\u4f1a\u5458\uff0c\u8d2d\u4e70\u5546\u54c1\u53ef\u83b7\u53d6\u8fd4\u5229":"\u60a8\u662f"+e.siteName+e.cardName+"\u4f1a\u5458\uff0c\u518d\u6d88\u8d39"+e.requiredGmv+"\u5143\u63d0\u5347\u4f1a\u5458\u7b49\u7ea7\u4eab\u53d7\u8fd4\u5229":e.requiredLevel?"\u60a8\u8fd8\u4e0d\u662f"+e.siteName+"\u4f1a\u5458\uff0c\u8054\u7cfb\u7ad9\u957f\u6210\u4e3a\u81f3\u5c0a\u4f1a\u5458\u5361\u4eab\u53d7\u8fd4\u5229":"\u60a8\u8fd8\u4e0d\u662f"+e.siteName+"\u4f1a\u5458\uff0c\u6d88\u8d39\u6ee1"+e.requiredGmv+"\u5143\u6210\u4e3a\u4f1a\u5458\u4eab\u53d7\u8fd4\u5229":i(),s.show().html(n)):i()}})):s.html("\u767b\u5f55\u540e\u786e\u8ba4\u662f\u5426\u4eab\u6709\u8be5\u6743\u76ca"))}};i.add("mod-detail-preferential","area-detail-property",a)});;define("widget.ditto.postage.default.parts.FreightCost",["jQuery"],function(i){var t=function(){this.init.apply(this,arguments)};return t.prototype={init:function(t){if(this.div=i("div.unit-detail-freight-cost",t),this.div.length){this.timer=null,this.calLock=null,this.config=this.div.data("unitConfig"),this.costEntries=i("div.cost-entries");var e=this;this.config.price=this.config.refPrice,this.config.weight=this.config.unitWeight*this.config.beginAmount,this.config.amount=this.config.beginAmount,this.areaData=null,""!=this.config.freightTemplateId&&i(window).bind("freightCalculation",function(t,n){var o={};"undefined"==typeof n&&(n={}),e.config.amount=n.amount?n.amount:e.config.amount,e.config.price=n.price?n.price:e.config.price,e.config.price=(100*e.config.price).toFixed(2)/100,e.config.weight=n.amount?n.amount*e.config.unitWeight:e.config.weight,e.config.weight=(1e4*e.config.weight).toFixed(4)/1e4,o.amount=e.config.amount,o.weight=e.config.weight,o.price=e.config.price,o.templateId=e.config.freightTemplateId,o.memberId=window.iDetailConfig.memberid,o.volume=0,o.offerId=window.iDetailConfig.offerid,o.flow=e.config.flow,o.excludeAreaCode4FreePostage=e.config.excludeAreaCode4FreePostage,e.areaData&&(i.extendIf(o,e.areaData),e.calLock&&clearTimeout(e.calLock),e.calLock=setTimeout(function(){i.ajax(e.config.calculationUrl,{data:o,dataType:"jsonp",success:function(i){i.data&&i.data.costs&&e._renderCostEntries(i.data.costs)}})},500))})}},_renderCostEntries:function(i){var t=this.costEntries,e='\r\n                    <% for( var i = 0; i < $data.length; i++){ %>\r\n                        <% if(this.isNotCod($data[i].subTemplate)){ %>\r\n                        <% }else{ %>\r\n                            <div class="cost-entries-type">\r\n                                <p><span class="name"><%= $data[i].subTemplate %></span></p>\r\n                                <p><span class="fd-cny">&yen;</span><em class="value"><%= $data[i].cost %></em></p>\r\n                            </div>\r\n                        <% } %>\r\n                    <% } %>\r\n                    ',n=this;t.html(FE.util.sweet(e).applyData(i,{isNew:function(i){return"\u8d27\u8fd0"===i?!0:!1},isNotCod:function(i){return"\u8d27\u5230\u4ed8\u6b3e"===i&&"true"!==n.config.isCodOffer?!0:!1}}))},setAreaData:function(i){this.areaData=i},sendEvent:function(t){i(window).trigger("freightCalculation",t)}},t});;"ui"in jQuery&&"_defined"in jQuery.ui||function(t,e){function i(t){return t&&t.constructor===Number?t+"px":t}function n(e,i){var n=e.nodeName.toLowerCase();if("area"===n){var s,o=e.parentNode,a=o.name;return e.href&&a&&"map"===o.nodeName.toLowerCase()?(s=t("img[usemap=#"+a+"]")[0],!!s&&r(s)):!1}return(/input|select|textarea|button|object/.test(n)?!e.disabled:"a"==n?e.href||i:i)&&r(e)}function r(e){return!t(e).parents().andSelf().filter(function(){return"hidden"===t.curCSS(this,"visibility")||t.expr.filters.hidden(this)}).length}t.extend(t.ui,{_defined:!0,keyCode:{DOWN:40,ENTER:13,ESCAPE:27,LEFT:37,NUMPAD_ENTER:108,RIGHT:39,SHIFT:16,TAB:9,UP:38}}),t.fn.extend({_focus:t.fn.focus,focus:function(e,i){return"number"==typeof e?this.each(function(){var n=this;setTimeout(function(){t(n).focus(),i&&i.call(n)},e)}):this._focus.apply(this,arguments)},scrollParent:function(){var e;return e=t.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(t.curCSS(this,"position",1))&&/(auto|scroll)/.test(t.curCSS(this,"overflow",1)+t.curCSS(this,"overflow-y",1)+t.curCSS(this,"overflow-x",1))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(t.curCSS(this,"overflow",1)+t.curCSS(this,"overflow-y",1)+t.curCSS(this,"overflow-x",1))}).eq(0),/fixed/.test(this.css("position"))||!e.length?t(document):e},zIndex:function(i){if(i!==e)return this.css("zIndex",i);if(this.length)for(var n,r,s=t(this[0]);s.length&&s[0]!==document;){if(n=s.css("position"),("absolute"===n||"relative"===n||"fixed"===n)&&(r=parseInt(s.css("zIndex"),10),!isNaN(r)&&0!==r))return r;s=s.parent()}return 0},disableSelection:function(){return this.bind((t.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(t){t.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")},bgiframe:function(e){if(t.util.ua.ie6){if("close"===e)return this.each(function(){t(this).children("iframe.bgiframe").remove()});e=t.extend({top:"auto",left:"auto",width:"auto",height:"auto",zIndex:-1,opacity:0,src:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},e);var n=['<iframe class="bgiframe"frameborder="0"tabindex="-1"src="',e.src,'"style="display:block;position:absolute;z-index:',e.zIndex,";",e.opacity?"":"filter:Alpha(Opacity='0');","top:","auto"==e.top?"expression(((parseInt(this.parentNode.currentStyle.borderTopWidth)||0)*-1)+'px')":i(e.top),";left:","auto"==e.left?"expression(((parseInt(this.parentNode.currentStyle.borderLeftWidth)||0)*-1)+'px')":i(e.left),";width:","auto"==e.width?"expression(this.parentNode.offsetWidth+'px')":i(e.width),";height:","auto"==e.height?"expression(this.parentNode.offsetHeight+'px')":i(e.height),';"/>'].join("");return this.each(function(){var e=t(this);0===e.children("iframe.bgiframe").length&&this.insertBefore(document.createElement(n),this.firstChild)})}return"close"===e?this.each(function(){t(this).children("div.bgiframe").remove()}):(e=t.extend({position:"fixed",top:0,left:0,width:"100%",height:"100%",zIndex:-1,backgroundColor:"#FFF",opacity:0},e),e.force?this.each(function(){var i=t(this);0===i.children("div.bgiframe").length&&i.prepend(t("<div>",{"class":"bgiframe",css:e}))}):this)}}),t.extend(t.expr[":"],{data:function(e,i,n){return!!t.data(e,n[3])},focusable:function(e){return n(e,!isNaN(t.attr(e,"tabindex")))},tabbable:function(e){var i=t.attr(e,"tabindex"),r=isNaN(i);return(r||i>=0)&&n(e,!r)}}),t(function(){var e=document.body,i=e.appendChild(i=document.createElement("div"));t.extend(i.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),t.support.minHeight=100===i.offsetHeight,t.support.selectstart="onselectstart"in i,e.removeChild(i).style.display="none"}),t.extend(t.ui,{plugin:{add:function(e,i,n){var r=t.ui[e].prototype;for(var s in n)r.plugins[s]=r.plugins[s]||[],r.plugins[s].push([i,n[s]])},call:function(t,e,i){var n=t.plugins[e];if(n&&t.element[0].parentNode)for(var r=0;r<n.length;r++)t.options[n[r][0]]&&n[r][1].apply(t.element,i)}},isOverAxis:function(t,e,i){return t>e&&e+i>t},isOver:function(e,i,n,r,s,o){return t.ui.isOverAxis(e,n,s)&&t.ui.isOverAxis(i,r,o)}}),t.add("ui-core")}(jQuery),"widget"in jQuery||function(t,e){var i=(Array.prototype.slice,t.cleanData);t.cleanData=function(e){for(var n,r=0;null!=(n=e[r]);r++)t(n).triggerHandler("remove");i(e)},t.widget=function(e,i,n){var r,s=e.split(".")[0];e=e.split(".")[1],r=s+"-"+e,n||(n=i,i=t.Widget),t.expr[":"][r]=function(i){return!!t.data(i,e)},t[s]=t[s]||{},t[s][e]=function(t,e){arguments.length&&this._createWidget(t,e)};var o=new i;o.options=t.extend(!0,{},o.options),t[s][e].prototype=t.extend(!0,o,{namespace:s,widgetName:e,widgetEventPrefix:t[s][e].prototype.widgetEventPrefix||e,widgetBaseClass:r},n),t.widget.bridge(e,t[s][e])},t.widget.bridge=function(i,n){t.fn[i]=function(r){var s="string"==typeof r,o=Array.prototype.slice.call(arguments,1),a=this;return r=!s&&o.length?t.extend.apply(null,[!0,r].concat(o)):r,s&&"_"===r.charAt(0)?a:(this.each(s?function(){var n=t.data(this,i),s=n&&t.isFunction(n[r])?n[r].apply(n,o):n;return s!==n&&s!==e?(a=s,!1):void 0}:function(){var e=t.data(this,i);e?e.option(r||{})._init():t.data(this,i,new n(r,this))}),a)}},t.Widget=function(t,e){arguments.length&&this._createWidget(t,e)},t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:!1},_createWidget:function(e,i){t.data(i,this.widgetName,this),this.element=t(i),this.options=t.extend(!0,{},this.options,this._getCreateOptions(),e);var n=this;this.element.bind("remove."+this.widgetName,function(){n.destroy()}),this.options.classPrefix&&(this.widgetBaseClass=this.options.classPrefix+"-"+this.widgetName),this._create(),this._trigger("create"),this._init()},_getCreateOptions:function(){return t.metadata&&t.metadata.get(this.element[0])[this.widgetName]},_create:t.noop,_init:t.noop,destroy:function(){this._destroy(),this.element.unbind("."+this.widgetName).removeData(this.widgetName),this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled ui-state-disabled")},_destroy:t.noop,widget:function(){return this.element},option:function(i,n){var r=i;if(0===arguments.length)return t.extend({},this.options);if("string"==typeof i){if(n===e)return this.options[i];r={},r[i]=n}return this._setOptions(r),this},_setOptions:function(e){var i=this;return t.each(e,function(t,e){i._setOption(t,e)}),this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&this.widget()[e?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",e),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_trigger:function(e,i,n){var r=this.options[e];if(i=t.Event(i),i.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),n=n||{},i.originalEvent)for(var s,o=t.event.props.length;o;)s=t.event.props[--o],i[s]=i.originalEvent[s];return this.element.trigger(i,n),!(t.isFunction(r)&&r.call(this.element[0],i,n)===!1||i.isDefaultPrevented())}},t.add("ui-core")}(jQuery);;"timer"in jQuery.fn||function(t,e){var n=["year","month","day","hour","minute","second"],i={year:"yyyy",month:"MM",day:"dd",hour:"hh",minute:"mm",second:"ss"};t.widget("ui.timer",{options:{format:"y-M-d hh:mm:ss",to:new Date,step:1,animate:!1,autoStart:!0},_create:function(){this._render()},_render:function(){var e=this,i=e.element,r=e.options,a="<dl><dd></dd></dl>";i.addClass("ui-timer"),t.each(n,function(n,o){var s=t("."+o,i);s.length&&(e["ph"+o]=s,r.animate&&(s.html("year"===o?a:a+a),e["ph"+o]=s.children()))}),r.autoStart&&e.start()},start:function(){var n,i=this,r=i.options;return i.timer||(n=i.aim=new Date(r.to-(r.from||new Date)),i.timer=t.later(1e3*r.step,i,i._interval,e,!0),i._interval()),i},stop:function(){var t=this;t.timer&&(t.timer.cancel(),delete t.timer,t._trigger("stop"))},_interval:function(){var e=this,r=e.aim;if(0>r)return void e.stop();var a=e.options,o=a.format,s={year:r.getFullYear()-1970,month:r.getUTCMonth(),day:r.getUTCDate()-1,hour:r.getUTCHours(),minute:r.getUTCMinutes(),second:r.getUTCSeconds()};a.animate?t.each(n,function(t,n){var i=e[n]||0,r=s[n];e["ph"+n]&&i!==r&&(e._animate(e["ph"+n],i,r),e[n]=r)}):t.each(n,function(t,n){var r=s[n];e["ph"+n]&&e[n]!==r&&(e["ph"+n].html(10>r&&o.indexOf(i[n])>-1?"0"+r:r),e[n]=r)}),e.aim=new Date(e.aim-1e3*a.step)},_animate:function(e,n,i){var r,a,o=this,s=(o.options,e.length),m=0;for(n=o._strFix(n,s),i=o._strFix(i,s);s>m;m++)if(r=n.charAt(m),a=i.charAt(m),r!==a){var h=t(e[m]),d=h.children(),u=t("<dd>").addClass("num"+a);h.append(u),d.animate({marginTop:"-"+d.height()+"px"},800,function(){t(this).remove()})}},_strFix:function(t,e){t+="";for(var n=e-t.length;n;)t="0"+t,n--;return t},_destroy:function(){var t=this;t.stop(),t.element.removeClass("ui-timer")}}),t.add("ui-timer")}(jQuery);;define("widget.common.plugin.Timer",["jQuery","Class","lofty/ui/timer/1.0/timer"],function(i,t,n){var e=new t({init:function(t){this.div=i("span.unit-detail-timer",t),this.div.length&&(this.config=this.div.data("unitConfig"),this._timer(t))},_timer:function(){var t=1*this.config.countdown+(new Date).getTime(),e=this.div,o=i("span.day",this.div);if(t){var a=new n({format:"yy-MM-dd hh:mm:ss",from:new Date(0),to:new Date(t),el:e,maxUnit:"day"});a.on("stop",function(){console.log("\u5012\u8ba1\u65f6\u7ed3\u675f"),location.reload()}),"0"===o.text()&&(o.hide(),o.next().hide()),this.div.parent().fadeIn()}}});return e});;define(["jQuery","ModContext","widget.ditto.plugin.AmountControl","widget.ditto.postage.default.parts.FreightCost","widget.ditto.postage.default.parts.DestinationArea","widget.common.plugin.Timer"],function(t,i,e,o,n,a){var r={init:function(i,r){var d=this;this.div=i,this.config=r,this.div.length&&(this.amountControl=new e(this.div),this.initFreightBox(),this.freightArea=new n(this.div),this.freightCost=new o(this.div),this.freightArea.display(),this.freightArea.setSendCallback(function(t,i){d.freightCost.setAreaData(t),i&&d.freightCost.sendEvent()}),this.amountControl.setCallback(function(){t(window).trigger("freightCalculation",{amount:d.amountControl.amountValue})}),t(window).bind("updateAmount.carriage",function(t,i){d.amountControl.setAmountValue(i),d.amountControl.amountNode.val(i)}),new a(t("div.unit-detail-freight-cost div.d-timer",this.div)))},initFreightBox:function(){var i=this;t(document).click(function(e){{var o=t(e.target).closest("div.unit-detail-destination-area");t(e.target).closest("div.unit-detail-freight-cost")}return o.length<=0?(i.freightArea.hideAreaBox(),void i.freightArea.hideSubAreaBox()):void 0})}};i.add("mod-detail-postage","area-detail-property",r)});;define("widget.ditto.postage.default.parts.DestinationArea",["jQuery"],function(e){var a=function(){this.init.apply(this,arguments)};return a.visitorCode="",a.currentArea=null,a.prototype={specialCities:{"\u4e0a\u6d77_2610":"\u4e0a\u6d77_2611","\u5317\u4eac_1098":"\u5317\u4eac_1099","\u5929\u6d25_3256":"\u5929\u6d25_3257","\u91cd\u5e86_3262":"\u91cd\u5e86_3263"},specialCode:"9999",specialName:"\u76f4\u8f96\u5e02",init:function(a){this.div=e("div.unit-detail-destination-area",a),this.config=this.div.data("unitConfig")?this.div.data("unitConfig"):{},this.areaLocation=e("a.parcel-location",this.div),this.currentAreaTitle=e("span",this.areaLocation),this.currentAreaTitle.text(this.config.visitorIPArea),this.areaBox=e("div.area-panel-content",this.div),this.areaList=e("ul.area-list",this.areaBox),this.areaSubBox=e("div.area-sub-panel",this.div),this.areaSubList=e("div.area-sub-list",this.areaSubBox),this.locationDisplay=e("a.parcel-location span",this.div),this.activeBox=e("span.de-calculation",this.div),this.activeAreaBox=e("div.area-head",this.div),this.selectedProvinceCode=0,this.selectedCountryCode=0,this.selectedCityCode=0,this.selectedProvince=null,this.selectedCountry=null,this.selectedCity=null,this.timer=null,this.calLock=null,this.areaData=null,this.callback=null},defaultLocation:function(){var e=this;if(""!==e.config.visitorCode){if(e.locationDisplay.text(e._objectifyArea(e.config.visitorProvince).name+e._objectifyArea(e.config.visitorCity).name),""!==e.config.visitorProvince){var a=e._objectifyArea(e.config.visitorProvince);e.selectedProvinceCode=a.code,e.selectedProvince=a.name}if(""!==e.config.visitorCity){var i=e._objectifyArea(e.config.visitorCity);e.selectedCity=i.name,e.selectedCityCode=i.code}for(var t in e.specialCities)if(t===e.config.visitorProvince){e.selectedProvinceCode=e.specialCode,e.selectedProvince=e.specialName,e.locationDisplay.text(e._objectifyArea(e.config.visitorCity).name);break}e.send(!1)}else e.locationDisplay.text("\u8bf7\u9009\u62e9")},display:function(){var a=this;null===this.areaData&&(this.locationDisplay.text("\u52a0\u8f7d\u4e2d..."),this.config&&this.config.areaInfoUrl&&e.ajax(this.config.areaInfoUrl,{dataType:"jsonp",success:function(e){e.data&&e.success&&(a.areaData=e.data.areaList,a.defaultLocation(),a.initAreaBox())}}))},initAreaBox:function(){var a=this;this.areaLocation.attr("hideFocus","hidefocus"),this.areaLocation.click(function(i){i.preventDefault();var t=e(this).closest("div.area-panel-hide"),s=e(this).closest("div.area-panel");return t.length>0?void a.showAreaBox():s.length>0?void a.hideAreaBox():void 0}),this.areaBox.on("click","li a.link-province",function(i){i.preventDefault();var t=e(this),s=t.closest("li"),o=(t.closest("div.area-sub-panel"),t.data("area"));s.hasClass("selected")?(s.removeClass("selected"),a.hideSubAreaBox()):(a.areaBox.find("li").removeClass("selected"),s.addClass("selected"),o&&a.showSubAreaBox(o,t,a.areaData))}),""===e.trim(this.areaList.html())&&this._renderArea(this.areaData)},_applyAreaEvent:function(a){var i=this;this.areaBox.off("click","li.area-sub-placeholder a"),this.areaBox.on("click","li.area-sub-placeholder a",function(t){t.preventDefault();var s=e(this);i.locationDisplay.html(a.key+e(this).data("area").key),a.code===i.specialCode&&i.locationDisplay.html(s.data("area").key),i.selectedCity=s.data("area").key,i.selectedCityCode=s.data("area").code,i.selectedProvince=a.key,i.selectedProvinceCode=a.code,i.config.visitorCode=s.data("area").value,i.send(!0),e("a",s.closest("div.area-sub-list")).removeClass("selected"),s.addClass("selected")})},showAreaBox:function(){this.div.parent();if(this.areaBox.length){if(this.areaBox.show(),this.areaBox.addClass("area-panel-content-show"),this.activeAreaBox.addClass("area-panel"),this.activeAreaBox.removeClass("area-panel-hide"),this.selectedProvince&&""!==this.selectedProvince&&0!==this.selectedProvinceCode){var a,i={};i.key=this.selectedProvince,i.code=this.selectedProvinceCode,a=e("a[title="+this.selectedProvince+"].link-province",this.areaList).closest("li"),e("li",this.areaList).removeClass("selected"),a.addClass("selected"),this.showSubAreaBox(i,a,this.areaData)}e(window).trigger("resize")}},hideAreaBox:function(){this.areaBox.length&&(this.areaBox.hide(),this.areaBox.removeClass("area-panel-content-show"),this.activeAreaBox.addClass("area-panel-hide"),this.activeAreaBox.removeClass("area-panel"),this.hideSubAreaBox(),e(window).unbind("resize.areaBox"))},showSubAreaBox:function(e,a,i){this.hideSubAreaBox(),this._renderSubArea(i,e),this.areaSubBoxShowTimer=null,this.areaSubBox.show(),this._applyAreaEvent(e)},hideSubAreaBox:function(){this.areaBox.find("li.area-sub-placeholder").hide()},doCalculation:function(e,a,i,t){},_getAreaCodeByName:function(a){var i=e("a[title="+a+"]",this.areaPanel);return i.addClass("selected"),parseInt(i.data("areaCode"))},_describeFreight:function(){return this.config.visitorIPArea},_renderArea:function(a){var i=a.CN_1001,t='<li {selected} >\r\n                    <a  rel="nofollow" href="#" \r\n                    title="{loc}"\r\n                    data-area=\'{"key":"{loc}","code":"{code}","group":{group}}\' \r\n                    hidefocus="hidefocus" class="dmtrack link-province" dmt="chooseplace"><span>{loc}</span></a></li>',s="";this.selectedCountryCode="1001",this.selectedCountry="CN",this.specialKey=this.specialName+"_"+this.specialCode;var o=i[this.specialKey]={};for(var r in this.specialCities)o[this.specialCities[r]]=i[r][this.specialCities[r]],delete i[r];var l=0,c='<li class="area-sub-placeholder fd-hide"></li>';for(var n in i){var d,h={},u="",v=!1;"string"==typeof n&&(d=n.split("_"),n===this.specialKey&&(v=!0),d[0]===this.selectedProvince&&d[1]===this.selectedProvinceCode&&(u="class='selected'"),h={loc:d[0],code:d[1],content:n,selected:u,group:v}),s+=e.util.substitute(t,h),l++,(l%8===0||31===l)&&(s+=c)}this.areaList.html(s)},_renderSubArea:function(a,i){var t=a.CN_1001[i.key+"_"+i.code],s='<span><a {selected} rel="nofollow" href="#" title="{loc}" data-area=\'{"key":"{loc}","code":"{code}","value":"{value}"}\' hidefocus="hidefocus" class="dmtrack" dmt="chooseplace">{loc}</a></span>',o="",r=!0,l=this.areaBox.find("li.selected").nextAll("li.area-sub-placeholder").first();this.areaBox.find("li.area-sub-placeholder").hide(),o+='<div class="area-sub-list fd-clr">';for(var c in t){var n,a={},d="";"string"==typeof c&&(n=c.split("_"),n[0]===this.selectedCity&&n[1]===this.selectedCityCode&&(d="class='selected'"),a={loc:n[0],code:n[1],value:t[c],selected:d}),o+=e.util.substitute(s,a)}return o+="</div>",l.html(o).show(),r},_objectifyArea:function(e){var a={};if(a.name="",a.code=0,"string"==typeof e){var i=e.split("_");i.length>0&&(a.name=i[0],a.code=i[1])}return a},_analyseAreaValue:function(e){var a={};return e&&"string"==typeof e&&e.split("_").length>=3&&(a.countryCode=e.split("_")[0],a.provinceCode=e.split("_")[1],a.cityCode=e.split("_")[2]),a},setSendCallback:function(e){this.callback=e},send:function(e){var a=this;if(a.config.visitorCode){var i=a._analyseAreaValue(a.config.visitorCode);a.calLock&&clearTimeout(a.calLock),a.calLock=setTimeout(function(){a.callback.call(a,i,e)},500)}}},a});;define(["jQuery","ModContext"],function(e,t){var a={init:function(t,a,i,r){var n=this;this.div=t,this.lineCon=e("div.d-content",this.div),this.div.length&&(this.config=this.div.data("modConfig"),e(window).bind("loadCommentTop",function(t,a){"undefined"!=typeof n.config.remarkUrl&&e.ajax({url:n.config.remarkUrl+"&var=rateAvgStarAndRemStat",dataType:"script",success:e.proxy(n._successLoadedRemark,n),error:e.proxy(n._failureLoadedRemark,n),timeout:1e4})}),1*this.config.status<=-1&&e(window).trigger("loadCommentTop"),this._initOpenTab())},_failureLoadedRemark:function(){e("#top-error",this.div).length&&e("#top-error",this.div).show()},_successLoadedRemark:function(e){"undefined"!=typeof window.rateAvgStarAndRemStat&&window.rateAvgStarAndRemStat&&window.rateAvgStarAndRemStat.success===!0&&this._showRemark(window.rateAvgStarAndRemStat.data)},_showRemark:function(t){if(t.remarkCount&&0!==t.remarkCount&&(t.averageStarLevel||0===t.averageStarLevel)){var a=1*t.averageStarLevel;a!==1*a.toFixed(0)&&(a=Math.floor(a)+.5),e(window).trigger("updateRateCount",t.remarkCount),this.lineCon.html('<p class="star-level"><i class="icon-star sstar'+10*a+'"></i></p>                            <p class="satisfaction-number"><a rel="nofollow" href="#mod-detail-comment" trace="offerdetail_click_comment"><em class="value">'+t.remarkCount+"</em>\u6761\u8bc4\u4ef7</a></p>"),this._initOpenTab()}},_initOpenTab:function(){e("p.satisfaction-number a",this.div).click(function(t){t.preventDefault(),e(window).trigger("openTab","mod-detail-comment")}),e("p.bargain-number a",this.div).click(function(t){t.preventDefault(),e(window).trigger("openTab","mod-detail-dealrecord")})}};t.add("mod-detail-evaluate","area-detail-property",a)});;define(["jQuery","ModContext"],function(t,i){var e={init:function(t,i){this.node=t,this.config=i;try{}catch(e){console.log(e)}},_initEvent:function(){this.$guideTip=t("#J_OfferDetail_Ditto_DataGuide_Tip",this.node),this.$guideTipContent=t("#J_OfferDetail_Ditto_DataGuide_TipContent",this.node),this.$guideTipText=t("#J_OfferDetail_Ditto_DataGuide_TipText",this.node),this._bindEvent()},_initData:function(){var i=t(this.node).attr("data-guide-info-tb-pricerange"),e=t(this.node).attr("data-guide-info-tb-salecount"),n=t(this.node).attr("data-guide-info-tb-goodrate"),a=window.iDetailConfig||{},o=a.unit||"\u4ef6",r=this._parseTbPriceRange(i);if(r!==!1){var s='<span class="important-font">'+r+"</span>";t("#J_OfferDetail_Ditto_DataGuide_TbPriceRange",this.node).html(s)}var d=this._parseSaleCount(e);if(d!==!1){var f='<span class="important-font">'+d+"</span>";f+='<span class="common-font"> '+o+" </span>",t("#J_OfferDetail_Ditto_DataGuide_TbSaleCount",this.node).html(f)}var u=this._parseGoodRate(n);if(u!==!1){var p='<span class="important-font">'+u+"</span>";t("#J_OfferDetail_Ditto_DataGuide_TbGoodRate",this.node).html(p)}},_parseGoodRate:function(t){var i=!1;if(t&&"string"==typeof t&&t.indexOf("%")>0){var e=t.replace("%","");!isNaN(e)&&1*e>0&&(i=t)}return i},_parseSaleCount:function(t){return t?isNaN(t)||0>=1*t?!1:t:!1},_parseTbPriceRange:function(t){if(!(t&&t.length>0))return!1;for(var i=t.split("-"),e=[],n=0;n<i.length;n++){if(isNaN(i[n]))return!1;e.push("\uffe5"+i[n])}var a=e.join(" - ");return a},_bindEvent:function(){var t=this;t.$guideTip.on("mouseover",function(){t.$guideTipContent.show(),t._initTipText()}),t.$guideTip.on("mouseleave",function(){t.$guideTipContent.hide()}),t.$guideTipContent.on("mouseover",function(){t.$guideTipContent.show()}),t.$guideTipContent.on("mouseleave",function(){t.$guideTipContent.hide()})},_initTipText:function(){var t=window.iDetailConfig||{},i=t.offerid,e="https://s.1688.com/lengjing/data.htm?tab=taoRetail&fromOfferId="+i+"&fromTaobao=false";this.$guideTipText.html('\u8be5\u5546\u54c1\u540c\u6b3e\u5728\u6dd8\u5b9d\u7684\u9500\u552e\u60c5\u51b5\uff0c<a href="'+e+'" trace="dataGuideMoreData" target="_blank">\u67e5\u770b\u66f4\u591a</a>')}};i.add("mod-detail-data-guide",e)});;define("widget.ditto.plugin.CreditBuy",["jQuery","Util","util/template/2.0"],function(e,t,n){function i(){this.init.apply(this,arguments)}function a(e,t){var n,i=t||300;return function(){var t=this,a=arguments;clearTimeout(n),n=setTimeout(function(){e.apply(t,a)},i)}}return i.prototype={init:function(t,n){var i=iDetailData.creditInstallment||{},a=e(".obj-credit-buy",t);i.isOpenCreditInstallment&&(this.element=a,this.config=n,this.isSuccessLoaded=!1,this.bindEvent(),this.render())},getCreditBuyKV:function(){var t=this;if(!t.isSuccessLoaded)return null;try{var n=e(".credit-buy-item.current",this.element),i=n.data("code");if(i&&i.length)return{installmentCode:i[0],payChannel:i[1]}}catch(a){}return null},bindEvent:function(){var n=this,i=this.element;i.on("click",".credit-buy-item",function(){n.isSuccessLoaded&&(/disabled/i.test(this.className)||n.handleItemEvent("click",e(this)))}),detail.on("updateAmountPrice",a(function(e,a){if(n.isSuccessLoaded){var r=n.getCreditBuyKV()||{},s=r.payChannel;n.handleRequestData({total:t.tenThousandSep(a,!0),currentCode:s},function(e,t){e?i.html(n.renderer({dataList:t})):n.handleItemEvent("error")})}}))},render:function(){var t=this,a=this.element,r=i.parsePriceMin();"function"!=typeof this.renderer&&(this.renderer=n.compile(e(".credit-buy-template").html())),r&&this.handleRequestData({total:r},function(e,n){e?a.html(t.renderer({dataList:n})):a.hide()})},handleRequestData:function(t,n){var i=this,a=iDetailData.registerRenderData("categoryList")[0]||{},r=function(n){var i=[];return n&&n.length&&e.each(n,function(e,n){if(n.creditInstallmentContent){var a={name:n.creditInstallmentContent,interest:n.actualAmountInterest||null,originInterest:n.originAmountInterest,className:n.avaliable?"":"disabled",promotionName:n.promotionName,promotionDesc:n.promotionDesc,dataCode:JSON.stringify([n.installmentCode,n.payChannel])};n.avaliable&&t.currentCode===n.payChannel&&(a.className=a.className+" current"),i.push(a)}}),i};i.isSuccessLoaded=!1,e.ajax({url:"https://laputa.1688.com/offer/ajax/creditInstallment.do?_input_charset=utf-8",dataType:"jsonp",data:{oa:t.total,lid:iDetailConfig.loginId,cid:a.id},success:function(e){if(e&&e.data){var t=r(e.data);if(t&&t.length)return i.isSuccessLoaded=!0,void n(!0,t)}n(!1)}})},handleItemEvent:function(e,t){var n=this.element,i=n.find(".credit-buy-item");if("click"===e){var a=t.hasClass("current");i.removeClass("current"),t.toggleClass("current",!a)}else"error"===e&&(n.find(".credit-buy-error-wrapper").show(),i.removeClass("current"),i.addClass("disabled"))}},i.parsePriceMin=function(){return iDetailConfig.refPrice?1*window.iDetailConfig.refPrice:null},i.handleMergeData=function(t,n){try{var i=t.getCreditBuyKV();if(n.extId)return;i&&"object"==typeof i&&(n.extId=JSON.stringify({tradeScene:"creditbuying",payChannel:i.payChannel,installmentCode:i.installmentCode||""}))}catch(a){e.log("CreditBuy.handleMergeData error",a)}},i});;window._MboxConfig={urlTpl:"//widget.1688.com/front/getJsonComponent.json?namespace={namespace}&widgetId={widgetId}&methodName={methodName}",csrfUrlTpl:"//widget.1688.com/front/ajax/getJsonComponent.json?namespace={namespace}&widgetId={widgetId}&methodName={methodName}",dataType:"jsonp",transType:"transport",bridgeUrl:"//widget.1688.com/front/ajax/bridge.html?target={target}"},define(["jQuery","sys/logist/1.0","pkg/@alife/lofty-aliuser/1.0.0/index","pkg/@alife/refly-mbox/2.0.18/index"],function(e,t,o,n){function i(t){var o=e.Deferred();return e.getJSON("//dcms.1688.com/open/query.json?app=DCMS&dataId=236&resourceId="+t+"&callback=?").done(function(e){try{var t=JSON.parse(e.content.data[0].versionContent);o.resolve(t)}catch(n){o.reject(n)}}),o.promise()}function r(){i("416226").done(function(e){var t=e.isvList.map(function(e){return e.appkey}).join(",");e.isvList.forEach(function(e){u[e.appkey]=e}),o.isLogin()&&n.getData("checkAppKeyAuth",{appkeys:t},{transType:"jsonp"}).done(function(t){var o=t.content.mboxResult,n=e.isvList.filter(function(e){return o[e.appkey]});f=n.map(function(e){return e.appkey}).join(",")})})}function s(t){var o=e.Deferred();return n.getData("addPublishOffer",t,{csrfToken:!0,transType:"transport"}).done(function(e){if(!e||!e.content)return void o.reject();try{detail.trigger("loggerEvent",["crossBorder","Done"])}catch(t){}return"success"!==e.content.mboxStatus?void o.reject(e.content.mboxResult&&e.content.mboxResult.resultMsg):void o.resolve()}),o.promise()}function c(){var t=e.Deferred(),o=f.split(","),i=0,r=[];return o.forEach(function(e){n.getData("distributionNotify",{appkey:e,offerids:window.iDetailConfig.offerid}).done(function(n){if(i+=1,n&&n.content&&"success"===n.content.mboxStatus||r.push(u[e].name),i===o.length){if(r.length)return void t.reject("\u4ee5\u4e0b\u6e20\u9053\u63a8\u9001\u5931\u8d25\uff1a"+r.join("\uff0c"));t.resolve()}})}),t.promise()}function a(t){var o=e.Deferred();return n.getData("createDistributeRelation",t,{csrfToken:!0,transType:"transport"}).done(function(e){return e&&e.content&&e.content.mboxResult?e.content.mboxResult.isSuccess?void o.resolve():void o.reject(e.content.mboxResult):void o.reject({})}),o.promise()}function d(){var t=e.Deferred();return n.getData("isKjMemberService",{csrfToken:!0,transType:"transport"}).done(function(e){e&&e.content&&e.content.result?t.resolve(e.content.result.isKjMember):t.reject(e)}),t.promise()}function l(t){var o={Obj:t,Offer_id:window.iDetailConfig&&window.iDetailConfig.offerid,t:(new Date).getTime()},n=encodeURIComponent(e.param(o));"undefined"!=typeof window.dmtrack?window.dmtrack.clickstat("//stat.1688.com/detailtrace.html",n):(new Image).src="//gm.mmstat.com/btob.38?gokey="+n+"&time="+(new Date).getTime(),window.goldlog&&window.goldlog.record("/offerDetail.click.clickstat","CLK","key=["+t+"]","H1484266073")}var f="",u={};r();var p={init:function(){this.$btn=e(".distribute-to-cross-border"),this.$btn.length&&l("distributeToCrossborderExposure"),this.initStyle(),this.bindEvents(),location.href.indexOf("auto-cross-border")>0&&this.doDistribute()},initStyle:function(){var e="a.distribute-to-cross-border {  width: 130px;  margin-left: 12px;  background-position: 10px -162px;  background-color: #fff5ec;  color: #ff712b !important;  display: block;  float: left;  height: 38px;  line-height: 38px;  border: 1px solid #f2dcbc;  overflow: hidden;  text-align: center;  font-size: 16px;  cursor: pointer;  font-family: \\5FAE\\8F6F\\96C5\\9ED1;  transition: background-color .3s ease 0s;}a.distribute-to-cross-border:hover {  border-color: #f9d59e;  background-color: #ffecda;  color: #f46200 !important;}a.dsc-btn-important:hover {  color: #fff}.cross-border-dialog-mask { display: block; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(255,255,255,.9); z-index: 100;}.cross-border-dialog { position: absolute; top: 50%; left: 50%; margin-left: -225px; margin-top: -100px; width: 450px; text-align: center; border: 1px solid #e5e5e5; box-shadow: 1px 1px 1px #ccc; background-color: #fff;}.cross-border-dialog-header { font-size: 16px; float: left; margin-left: 20px;}.cross-border-dialog .close-icon { background: url(//cbu01.alicdn.com/cms/upload/2015/792/305/2503297_329576842.png) no-repeat -14px -222px; display: inline-block; width: 30px; height: 30px; text-indent: -9999px; cursor: pointer;}.cross-border-dialog .dsc-btn-important.confirm { margin: 0 10px; min-width: 66px; height: 28px; line-height: 26px; box-sizing: border-box;}.cross-border-dialog .dsc-btn.close { margin: 0 10px; min-width: 66px; height: 28px; line-height: 26px; background: #fff;}",t=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e)),t.appendChild(o),this.$btn.removeClass("fd-hide")},bindEvents:function(){var e=this;this.$btn.on("click",function(t){t.preventDefault();try{detail.trigger("loggerEvent",["crossBorder","Open"])}catch(t){}o.isLogin()?e.showConfirmDistribute():e.showLogin()})},showLogin:function(){var e=this;t.init({source:"offerDetail_distributeToCrossborder",ssoGateway:"//exodus.1688.com/member/sso/ssoSessionGateWay.do?targetUrl=",onLoginSuccess:function(){t.hide(),setTimeout(function(){e.showConfirmDistribute()},500)},onRegistSuccess:function(){this.onLoginSuccess()}})},showConfirm:function(t){this.dialog&&this.dialog.remove();var o=e('<div class="cross-border-dialog-mask"><div class="cross-border-dialog">  <div style="text-align: right; padding: 10px 10px 0 10px; border-bottom: 1px solid #e8e8e8;">    <h3 class="cross-border-dialog-header">\u94fa\u8d27\u63d0\u793a</h3>    <span class="close close-icon"></span>  </div>  <div style="line-height: 2;">    <h4 style="padding: 20px 30px 15px; font-size: 14px; text-align: left">'+t.content+'    </h4>    <div class="btn fd-hide" style="display: block; padding: 10px; text-align: right;">      <a href="'+(t.confirmLink||"javascript:void(0)")+'"'+(t.confirmLinkNewTab?' target="_blank" ':"")+'         class="dsc-btn-important confirm">'+t.confirmText+'      </a>      <button class="dsc-btn close">'+t.cancelText+"      </button>    </div>  </div></div></div>");o.appendTo(document.body),this.dialog=o,o.on("click",".confirm",t.onConfirm||function(){o.remove()}).on("click",".close",function(){o.remove()})},showConfirmDistribute:function(){var e=this;this.showConfirm({content:"\u4e00\u952e\u94fa\u8d27\u540e\uff0c\u8be5\u5546\u54c1\u5c06\u81ea\u52a8\u63a8\u9001\u81f3\u60a8\u6388\u6743\u7684\u6240\u6709\u8de8\u5883\u94fa\u8d27\u670d\u52a1\u5546\uff0c\u60a8\u53ef\u5230\u591a\u6e20\u9053\u94fa\u8d27\u9875\u9762\u67e5\u770b\u94fa\u8d27\u5546\u54c1\u3002",confirmText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onConfirm:function(){e.doDistribute()}})},showAlert:function(e){this.showConfirm({content:e,confirmText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88"}),this.dialog.find("button.close").remove(),this.dialog.find(".dsc-btn-important").removeClass("confirm").addClass("close")},doDistribute:function(){var t=this,o=window.iDetailConfig.userId,n=window.iDetailConfig.offerid;l("distributeToCrossborderConfirm");try{detail.trigger("loggerEvent",["crossBorder","Request"])}catch(i){}d().done(function(i){return i?void a({supplierUserId:o,source:"kuajing"}).done(function(){return f?void s({offerId:n}).done(function(){c().done(function(){t.showConfirm({content:"\u5546\u54c1\u5df2\u6210\u529f\u63a8\u9001",confirmText:"\u7ba1\u7406\u94fa\u8d27",confirmLink:"//multichannel.1688.com/page/offer-list.htm",cancelText:"\u77e5\u9053\u4e86"})}).fail(function(e){t.showConfirm({content:e,confirmText:"\u7ba1\u7406\u94fa\u8d27",confirmLink:"//multichannel.1688.com/page/offer-list.htm",cancelText:"\u77e5\u9053\u4e86"})})}).fail(function(e){t.showAlert("HAS_ALREADY_ADD"===e?'\u8be5\u4ea7\u54c1\u5df2\u52a0\u5165\u5f85\u94fa\u8d27\u5217\u8868\uff0c\u65e0\u9700\u518d\u6b21\u6dfb\u52a0\u3002<a href="//multichannel.1688.com/page/offer-list.htm" target="_blank">\u70b9\u6b64\u67e5\u770b</a>':"\u6dfb\u52a0\u5f85\u94fa\u8d27\u5931\u8d25")}):void t.showConfirm({content:"\u60a8\u76ee\u524d\u6ca1\u6709\u542f\u7528\u4e2d\u7684\u8de8\u5883\u6388\u6743\u670d\u52a1\u5546\uff0c\u6682\u65f6\u65e0\u6cd5\u4e00\u952e\u94fa\u8d27",confirmText:"\u6dfb\u52a0\u6388\u6743\u670d\u52a1\u5546",confirmLink:"//kj.1688.com/listing_help.html",confirmLinkNewTab:!0,cancelText:"\u53d6\u6d88"})}).fail(function(o){var n="\u5efa\u7acb\u94fa\u8d27\u5173\u7cfb\u5931\u8d25",i=e("input[name=currentDomainUrl]").val()+"/page/merchants.htm?source=kuajing&autoapply=distribute#fx-applydistribute";return l("distributeToCrossborderRelationError"),"163"===o.resultCode?void t.showAlert('\u5efa\u7acb\u94fa\u8d27\u5173\u7cfb\u5931\u8d25\uff0c\u8bf7\u5148<a href="'+i+'" target="_blank">\u7533\u8bf7\u5206\u9500</a>'):o.resultMsg?void t.showAlert(n+"\uff0c"+o.resultMsg):void t.showAlert(n)}):void t.showConfirm({content:"\u672c\u529f\u80fd\u76ee\u524d\u4ec5\u5f00\u653e\u7ed9\u8de8\u5883 VIP \u7528\u6237\uff0c\u662f\u5426\u7acb\u5373\u52a0\u5165\uff1f",confirmText:"\u662f",confirmLink:"https://kj.1688.com/500f98c1.html?tracelog=offerdetail&redirectUrl="+encodeURIComponent(location.href.split("#")[0]+"#auto-cross-border"),cancelText:"\u4e0d\uff0c\u518d\u770b\u770b"})}).fail(function(e){e&&e.content&&e.content.errors&&e.content.errors[0]&&"user_not_login"===e.content.errors[0].code?t.showLogin():t.showAlert("\u7cfb\u7edf\u51fa\u9519\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5")})}};p.init()});;"irecom"in FE.sys||function(t,e,a){function n(e,r,c){var i=this;return i instanceof n?(i.container=t(e)||t(a.document),i.config=t.extend(!0,{},o,c),i.params=t.isPlainObject(r)?r:{},void i._init()):new n(e,r,c)}var r=a.dmtrack_pageid="undefined"==typeof a.dmtrack_pageid?new Date-0+""+Math.floor(1e3*Math.random()):a.dmtrack_pageid,c=e.getLastMemberId()||"",i=Object.prototype.hasOwnProperty,o={template:null,filter:null,statScene:"",apiUrl:"//res.1688.com/fly/irecom.do",debug:!1,debugUrl:"//10.20.150.79/fly/irecom.do",datalazyload:!1,ctrQueue:[],onTemplateReady:null,onLazyloadReady:null,onSuccess:null,onFailure:null},l=0===location.protocol.indexOf("https")?"https://":"http://",s=function(t){return"string"==typeof t?t.replace(/^(?:http:)?\/\//i,l):t};t.extend(n.prototype,{_init:function(){var n,c=this,i={},o=(a.location.search.substring(1).toLowerCase(),e.getLastMemberId()),l=e.lastLoginId,s=e.loginId,d=t.util.cookie("cna");i.uid=o||s||l||d||-1,i.pageid=r,c.params=t.extend(!0,{},i,c.params),c.config.debug&&(c.config.apiUrl=c.config.debugUrl),c.config.datalazyload?t.use("web-datalazyload",function(){n=c.datalazyload=e.datalazyload,n.bind(c.container,function(){c._request()}),n.init()}):c._request()},_request:function(){var e=this;t.ajax({url:e.config.apiUrl,data:e.params,dataType:"jsonp",success:function(t){e.config&&"function"==typeof e.config.dataHandler&&(t=e.config.dataHandler(t)),e._isCorrect(t)?e._onCallback(t):e._onFailure()},error:function(){e._onFailure()}})},_isCorrect:function(e){var a=this,n=a.config,r=!1;return e&&e.success&&0===e.data.returnCode&&t.isArray(e.data.data)&&("number"==typeof n.filter&&n.filter>=1?e.data.data=e.data.data.slice(0,n.filter):"function"==typeof n.filter&&(e.data.data=t.grep(e.data.data,n.filter)),e.data.data.length>0&&(r=!0)),r},_onCallback:function(e){{var a=this;a.data=e.data}a._loadTemplate(t.proxy(a,"_renderData"))},_loadTemplate:function(a){var n,r=this,c=r.data.data,i=r.config,o=r.container;if(i.template){if(n)return a(n);t.use("web-sweet",function(){i.onTemplateReady&&i.onTemplateReady.call(r,c),n=e.sweet(i.template),a(n)})}else o.html("<p>\u6ca1\u6709\u6307\u5b9a\u6e32\u67d3\u6a21\u677f\uff01</p>")},_renderData:function(t){{var e=this,a=e.data.data,n=e.config;e.container}e.tpl=t,e.config.datalazyload?e._datalazyloadHandler():(e._renderHandler(),n.onSuccess&&n.onSuccess.call(e,a))},_datalazyloadHandler:function(){var t=this,e=t.data.data,a=t.config;t._renderHandler(),a.onLazyloadReady&&a.onLazyloadReady.call(t,e),t.datalazyload.register({containers:t.container}),a.onSuccess&&a.onSuccess.call(t,e)},_renderHandler:function(){var e=this,a=e.data.data,n=e.container;tpl=e.tpl,n.html(t(tpl.applyData(a,e))),e._clickstat(),e._ctrstat()},_onFailure:function(){var t=this,e=t.container,a=t.config;null===a.onFailure?e.html('<p>\u6570\u636e\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7<a target="_self" href="javascript:location.reload();">\u5237\u65b0</a>\u91cd\u8bd5\uff01</p>'):a.onFailure.call(e)},_clickstat:function(){var e=this;e.container.delegate("a[data-clickstat]","mousedown",function(a){var n,o={},l=t(this).data("clickstat"),s=[];l=e._parseObj(l),l.objectId&&(o.objectId=l.objectId),l.alg&&(o.alg=l.alg),l.pid&&(o.pid=l.pid),l.objectType&&(o.objectType=l.objectType),l.l_offerid&&(o.l_offerid=l.l_offerid),o.page=e.config.statScene,o.recId=e.params.recid,o.st_page_id=r,o.time=(new Date).getTime(),o.interface_id=e.params.recid,o.ctr_ns=e.config.ctr_ns?e.config.ctr_ns:"",o.uid=c;for(n in o)i.call(o,n)&&s.push(n+"="+o[n]);s=s.join("&"),(new Image).src="//gm.mmstat.com/btob.35?gokey="+encodeURIComponent(s)+"&time="+(new Date).getTime()})},_ctrstat:function(){var e=this,a=e.config.ctrQueue;e.ctrData={},t.each(a,function(a,n){e._isCtrBatch(n)?e._sniffBatch(n,a):e.datalazyload.bind(e.container.find(n.selector),function(a){e._ctrRequest(n.param,e._sniffNode(t(a)))})}),t.each(a,function(t,a){e._isCtrBatch(a)&&e._ctrBatch(a,t)})},_isCtrBatch:function(t){var e=this;return!e.config.datalazyload||"undefined"==typeof t.ctrBatch||t.ctrBatch},_sniffBatch:function(e,a){var n=this,r=n.ctrData;t.isArray(r[a])||(r[a]=[]),r[a]=n._sniffNode(t(e.selector,n.container))},_sniffNode:function(e){var a,n=this,r=[];return n.container.find(e).each(function(){a=n._parseObj(t(this).data("ctr")),t.isPlainObject(a)||(a={objectId:"",alg:""}),r.push((a.objectId||"")+","+(a.alg||""))}),r},_ctrBatch:function(t,e){var a=this,n=a.ctrData,r=t.size||n[e].length,c=t.start||0;a._ctrRequest(t.param,n[e].slice(c,c+r))},_ctrRequest:function(e,a){var n,o=this,l=e||{},s=[];l.object_ids=a.join(";"),l.page_area=o.params.recid,l.ctr_type=o.config.statScene,l.page_id=r,l.interface_id=o.params.recid,l.ctr_ns=o.config.ctr_ns?o.config.ctr_ns:"",l.uid=c;for(n in l)i.call(l,n)&&s.push(n+"="+l[n]);s=s.join("&"),t.getScript("//ctr.1688.com/ctr.html?"+s),(new Image).src="//gm.mmstat.com/ctr.1688.2?gokey="+encodeURIComponent(s)},ctrManual:function(t,e,a,n){var r=this,c=r._sniffNode(t);a=a||c.length,n=n||0,r._ctrRequest(e,c.slice(n,n+a))},_parseObj:function(t){try{return"object"==typeof t?t:new Function("return "+t)()}catch(e){return{}}}}),n.fitLength=function(e,a){return e=t.util.unescapeHTML(e),e.lenB()>a&&(e=e.cut(a-3)+"..."),t.util.escapeHTML(e)},n.getOfferUrl=function(t){var e=t.eURL?t.eURL:t.offerDetailUrl;return e},n.getSearchUrl=function(t){var e="//s.1688.com/search/offer_search.htm?keywords="+t.categoryDesc;return e},n.getCompanyUrl=function(t){var e=t.contact;return e},n.getBizrefUrl=function(t){var e=t.domainID,a=t.memberId,n="";return!e||(n="http://"+e+".cn.1688.com/athena/bizreflist/"+e+".html"),!a||(n="http://"+a+".cn.1688.com/athena/bizreflist/"+a+".html"),n},n.getPrice=function(t,e){var a="",e=e||0;return a=-1===[0,""].indexOf(t.rmbPrice)?'<span class="fd-cny">&yen;</span><em class="value">'+t.rmbPrice+"</em>"+(e?'<span class="unit">/'+t.unit+"</span>":""):-1===[0,""].indexOf(t.foreignPrice)?'<em class="value">'+t.foreignPrice+t.foreignCurrency+"</em>"+(e?'<span class="unit">/'+t.unit+"</span>":""):'<em class="value">\u4ef7\u683c\u9762\u8bae</em>'},n.getImgUrl=function(t,e){var a=t.offerImageUrl,n=e||100,r="";return r=a?151>n?101>n?a+".summ.jpg":a+".search.jpg":221>n?a+".220x220.jpg":a+".310x310.jpg":151>n?101>n?"//cbu01.alicdn.com/cms/upload/other/nopic-100.png":"//cbu01.alicdn.com/cms/upload/other/nopic-150.png":221>n?"//cbu01.alicdn.com/cms/upload/other/nopic-220.png":"//cbu01.alicdn.com/cms/upload/other/nopic-310.png",s(r)},n.p4pSort=function(t){t.sort(function(t,e){var a=t.eURL?0:1,n=e.eURL?0:1;return a-n})},n.resizeImg=function(t,e,n){t.removeAttribute("width"),t.removeAttribute("height");var r;if(a.ActiveXObject?(r=new Image,r.src=t.src):r=t,r&&r.width&&r.height&&e&&(n||(n=e),r.width>e||r.height>n)){var c=r.width/r.height,i=c>=e/n;t[i?"width":"height"]=i?e:n,a.ActiveXObject&&(t[i?"height":"width"]=(i?e:n)*(i?1/c:c))}},FE.sys.irecom=n,t.add("sys-irecom")}(jQuery,FE.util,window);;